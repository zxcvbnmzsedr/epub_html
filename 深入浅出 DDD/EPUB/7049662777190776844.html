
        <html lang="en">
        <head>
        <meta charset="UTF-8"/>
        </head>
        <body>
        <div><div class="markdown-body">
    <h1>DDD-Demo &#28436;&#31034;&#65288;&#19977;&#65289;&#65306;&#22686;&#21024;&#25913;&#26597;</h1>

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" href="style/style.css" type="text/css">

<div class="markdown-body">
    <p>
 &#24212;&#29992;&#26381;&#21153;&#26159;&#25972;&#20010;&#31995;&#32479;&#23545;&#22806;&#30340;&#38376;&#38754;&#65292;&#20063;&#26159;DDD&#20845;&#36793;&#24418;&#26550;&#26500;&#23545;&#22806;&#30340;&#32479;&#19968;&#20986;&#20837;&#21475;&#12290;&#22914;&#26524;&#35828;&#39046;&#22495;&#27169;&#22411;&#26159;&#25972;&#20010;&#31995;&#32479;&#19994;&#21153;&#36923;&#36753;&#30340;&#20307;&#29616;&#65292;&#37027;&#20040;&#24212;&#29992;&#26381;&#21153;&#23601;&#26159;&#25972;&#20010;&#31995;&#32479;&#21151;&#33021;&#30340;&#20307;&#29616;&#12290;&#24212;&#29992;&#26381;&#21153;&#36890;&#36807;&#32534;&#25490;&#39046;&#22495;&#36923;&#36753;&#26469;&#23454;&#29616;&#31995;&#32479;&#20013;&#22823;&#22823;&#23567;&#23567;&#30340;&#21151;&#33021;&#12290;
</p>
<p>
 &#26412;&#25991;&#23558;&#20026;&#20320;&#35762;&#35299;&#22312;&#25343;&#21040;&#38656;&#27714;&#21518;&#24314;&#31435;&#23436;&#39046;&#22495;&#27169;&#22411;&#20043;&#21518;&#65292;&#25105;&#20204;&#22914;&#20309;&#20351;&#29992;&#24212;&#29992;&#26381;&#21153;&#26469;&#32534;&#25490;&#21151;&#33021;&#36923;&#36753;&#12290;
</p>
<h2>
 &#19968;&#12289;MVC &#22788;&#29702;&#19994;&#21153;&#36923;&#36753;&#22238;&#39038;
</h2>
<p>
 &#25105;&#20204;&#20197;
 <strong>
  &#29992;&#25143;&#21517;&#34987;&#20462;&#25913;&#20107;&#20214;
 </strong>
 &#20026;&#20363;&#20026;&#20320;&#36880;&#27493;&#20998;&#26512;&#32534;&#20889;&#24605;&#36335;&#12290;
</p>
<p>
 &#32769;&#35268;&#30697;&#65292;&#25105;&#20204;&#20808;&#24819;&#19968;&#19979;&#22914;&#26524;&#25105;&#20204;&#22312;MVC&#30340;&#26550;&#26500;&#20013;&#65292;&#20351;&#29992;Service&#23618;&#22914;&#20309;&#26469;&#32534;&#20889;&#36825;&#20010;&#36923;&#36753;&#65292;&#25105;&#20204;&#26469;&#20889;&#19968;&#19979;&#20266;&#20195;&#30721;&#12290;
</p>
<pre><code>&#160;public void updateUserName(UpdateUserDTO dto){
&#160;  
&#160;  //&#26657;&#39564;&#29992;&#25143;id&#26159;&#21542;&#23384;&#22312;
&#160;  UserPO exist = userMapper.selectById(dto.getId());
&#160;  if(Objects.isNull(exist)){
&#160;    throw new RunnableException("&#29992;&#25143;&#19981;&#23384;&#22312;");
&#160;  }
&#160;  
&#160;  //&#26657;&#39564;&#20462;&#25913;&#30340;&#29992;&#25143;&#21517;&#26159;&#21542;&#23384;&#22312;
&#160;  UserPO existUserName = userMapper.selectByUserName(dto.getUserName());
&#160;  if(Objects.nonNull(existUserName)  &amp;&amp; Objects.equals(existUserName.getId(),dto.getId())){
&#160;    throw new RunnableException("&#29992;&#25143;&#21517;&#24050;&#23384;&#22312;&#65292;&#20462;&#25913;&#22833;&#36133;");
&#160;  }
&#160;  
&#160;  //&#20462;&#25913;&#29992;&#25143;&#21517;
&#160;  exist.setUserName(dto.getUserName());
&#160;  
&#160;  //&#25191;&#34892;&#19968;&#20123;&#36923;&#36753;&#65292;&#30465;&#30053;100&#34892;&#20195;&#30721;
&#160;  
&#160;  userMapper.updateById(exist);
&#160;  
&#160;  //&#35843;&#29992;&#20854;&#20182;&#38656;&#35201;&#24863;&#30693;&#29992;&#25143;&#21517;&#20462;&#25913;&#30340;&#20854;&#20182;Service&#65292;&#21516;&#27493;&#20462;&#25913;
&#160;}
</code></pre>
<p>
 &#20195;&#30721;&#36923;&#36753;&#27604;&#36739;&#31616;&#21333;&#65292;&#36825;&#20040;&#20063;&#27809;&#26377;&#20219;&#20309;&#38382;&#39064;&#12290;&#20294;&#26159;&#22914;&#26524;&#30465;&#30053;&#30340;&#20195;&#30721;&#34987;&#23637;&#24320;&#26469;&#30340;&#35805;&#65292;&#25105;&#20204;&#26159;&#19981;&#26159;&#23601;&#26080;&#27861;&#24863;&#30693;&#21040;&#26680;&#24515;&#30340;&#36923;&#36753;&#20854;&#23454;&#23601;&#26159;&#22312;&#20462;&#25913;&#29992;&#25143;&#21517;&#65292;&#21482;&#19981;&#36807;&#20462;&#25913;&#29992;&#25143;&#21517;&#20043;&#21518;&#21457;&#29983;&#20102;&#19968;&#20123;&#20108;&#27425;&#35302;&#21457;&#19994;&#21153;&#35268;&#21017;&#30340;&#20854;&#20182;&#20107;&#20214;&#12290;&#20294;&#26159;&#36825;&#37096;&#20998;&#30340;&#20195;&#30721;&#20840;&#37096;&#22534;&#22312;&#20102;Service&#20013;&#65292;&#26680;&#24515;&#36923;&#36753;&#19981;&#22815;&#31361;&#20986;&#12290;&#25105;&#20204;&#20877;&#30475;&#19968;&#19979;&#31532;9&#34892;&#21040;&#31532;16&#34892;&#30340;&#20195;&#30721;&#65292;&#21457;&#29616;&#27809;&#26377;&#65292;&#20462;&#25913;&#29992;&#25143;&#21517;&#30340;&#21069;&#32622;&#26465;&#20214;&#26159;&#24517;&#39035;&#31995;&#32479;&#20013;&#19981;&#23384;&#22312;&#24403;&#21069;&#29992;&#25143;&#21517;&#12290;&#20294;&#26159;&#36825;&#20010;&#36923;&#36753;&#21364;&#34987;&#20998;&#25104;&#20102;&#20004;&#27493;&#65292;&#22914;&#26524;&#25105;&#20204;&#21069;&#32622;&#26657;&#39564;&#36923;&#36753;&#20877;&#22797;&#26434;&#19968;&#28857;&#65292;&#25442;&#20010;&#20154;&#26469;&#32500;&#25252;&#36825;&#27573;&#36923;&#36753;&#30340;&#26102;&#20505;&#23601;&#24456;&#23481;&#26131;&#28431;&#25481;&#20854;&#20013;&#19968;&#20010;&#26657;&#39564;&#65292;&#23548;&#33268;&#29992;&#25143;&#21517;&#34987;&#20462;&#25913;&#25104;&#21151;&#12290;
</p>
<p>
 &#36825;&#23601;&#26159;&#25152;&#35859;&#20102;&#39046;&#22495;&#30340;&#19994;&#21153;&#36923;&#36753;&#34987;&#22806;&#27844;&#65292;&#30001;&#35843;&#29992;&#26041;&#26469;&#32500;&#25252;&#20102;&#39046;&#22495;&#27169;&#22411;&#30340;&#23436;&#25972;&#24615;&#19982;&#19968;&#33268;&#24615;&#65292;&#26174;&#28982;&#36825;&#26159;&#19981;&#21512;&#29702;&#30340;&#12290;
</p>
<h2>
 &#20108;&#12289;&#24212;&#29992;&#26381;&#21153;&#32534;&#25490;&#36923;&#36753;
</h2>
<p>
 <strong>
  &#37027;&#20040;&#25105;&#20204;&#26469;&#30475;&#30475;DDD&#20013;&#20351;&#29992;&#24212;&#29992;&#26381;&#21153;&#22914;&#20309;&#26469;&#23454;&#29616;&#19978;&#36848;&#30340;&#21151;&#33021;&#21602;&#65311;
 </strong>
</p>
<pre><code>&#160;public void updateUserName(UpdateUserCommand command){
&#160; &#160;  //&#12304;&#24212;&#29992;&#26381;&#21153;&#20165;&#20801;&#35768;&#27492;&#31181;&#21028;&#26029;&#65292;&#25243;&#20986;&#38169;&#35823;&#24773;&#20917;&#65292;&#21363;&#20026;&#21442;&#25968;&#26657;&#39564;&#65292;&#19981;&#20801;&#35768;&#23454;&#38469;&#19994;&#21153;&#36923;&#36753;&#22788;&#29702;&#12305;
&#160; &#160;  // &#21069;&#32622;&#26657;&#39564;&#36923;&#36753;&#24456;&#38271;&#25110;&#32773;&#36890;&#29992;&#29575;&#39640;&#30340;&#24773;&#20917;&#65292;&#21487;&#20197;&#32771;&#34385;&#25277;&#21462;&#19968;&#20010;UserValidationUtil&#32479;&#19968;&#31649;&#29702;&#21069;&#32622;&#30340;&#19994;&#21153;&#26657;&#39564;
&#160;&#8203;
&#160; &#160;  //&#20808;&#26657;&#39564;&#29992;&#25143;&#26159;&#21542;&#23384;&#22312;
&#160; &#160;  User user = userRepository.byId(command.getUserId());
&#160; &#160;  ValidationUtil.isTrue(Objects.nonNull(user),"user.is.not.exist");
&#160;&#8203;
&#160; &#160;  //&#20462;&#25913;&#29992;&#25143;&#21517;
&#160; &#160;  User existUser = userRepository.byUserName(command.getUserName());
&#160; &#160;  user.bindUserName(command.getUserName(),existUser);
&#160;&#8203;
&#160; &#160;  //&#25191;&#34892;&#29992;&#25143;&#20462;&#25913;&#30456;&#20851;&#19994;&#21153;&#36923;&#36753;
&#160; &#160;  user.printUpdate();
&#160;&#8203;
&#160; &#160;  //&#23384;&#20648;&#29992;&#25143;
&#160; &#160;  User save = userRepository.save(user);
&#160;&#8203;
&#160; &#160;  //&#21457;&#24067;&#29992;&#25143;&#20462;&#25913;&#30340;&#39046;&#22495;&#20107;&#20214;
&#160; &#160;  domainEventPublisher.publish(new UserUpdateEvent(save));
&#160;}
</code></pre>
<p>
 &#25105;&#20204;&#20174;&#26041;&#27861;&#20837;&#21442;&#24320;&#22987;&#36827;&#34892;&#35762;&#35299;&#12290;
</p>
<h3>
 1. &#26041;&#27861;&#20837;&#21442;
</h3>
<p>
 MVC&#20013;&#29992;&#25143;&#21517;&#30340;&#20462;&#25913;&#20449;&#24687;&#20351;&#29992;DTO&#21253;&#35013;&#65292;&#32780;DDD&#20013;&#20351;&#29992;CQRS&#27169;&#22411;&#20013;&#30340;Command&#25351;&#20196;&#21442;&#25968;&#65292;&#35821;&#20041;&#21270;&#26356;&#24378;&#12290;&#20005;&#26684;&#24847;&#20041;&#19978;&#26469;&#35828;&#65292;&#24212;&#29992;&#26381;&#21153;&#30340;&#25152;&#26377;&#20837;&#21442;&#37117;&#24212;&#35813;&#26159;Command&#25351;&#20196;&#12290;&#22240;&#20026;&#24212;&#29992;&#26381;&#21153;&#30340;&#25152;&#26377;&#26041;&#27861;&#37117;&#26159;&#38024;&#23545;&#39046;&#22495;&#30340;&#25351;&#20196;&#24615;&#25805;&#20316;&#65292;&#21363;&#20026;&#22686;&#21024;&#25913;&#21160;&#20316;&#25351;&#20196;&#12290;&#20294;&#26159;&#36825;&#20063;&#21482;&#26159;&#24314;&#35758;&#65292;&#25105;&#35273;&#24471;&#36825;&#37324;2&#20010;&#21442;&#25968;&#21450;&#20197;&#19979;&#30340;&#30452;&#25509;&#20837;&#21442;&#23601;&#22909;&#20102;&#65292;&#19981;&#35201;&#21253;&#35013;&#19968;&#20010;Command&#20102;&#65292;&#19981;&#28982;&#19994;&#21153;&#32534;&#30721;&#19978;&#23454;&#22312;&#26377;&#28857;&#32321;&#29712;&#12290;&#27604;&#22914;&#65292;&#25191;&#34892;&#19968;&#20010;&#26681;&#25454;id&#21024;&#38500;&#29992;&#25143;&#30340;&#21160;&#20316;&#65292;&#20837;&#21442;&#26412;&#36523;&#21482;&#38656;&#35201;&#19968;&#20010;id&#65292;&#25105;&#21253;&#35013;&#25104;&#19968;&#20010;UserDeleteCommand&#65292;&#23454;&#22312;&#26159;&#26377;&#28857;&#24418;&#24335;&#20027;&#20041;&#12290;
</p>
<h3>
 2. &#21442;&#25968;&#26657;&#39564;
</h3>
<p>
 Service&#22312;&#36827;&#20837;&#27491;&#24335;&#30340;&#19994;&#21153;&#36923;&#36753;&#20043;&#21069;&#37117;&#20250;&#32463;&#36807;&#24517;&#35201;&#30340;&#21442;&#25968;&#26657;&#39564;&#36923;&#36753;&#65292;&#27604;&#22914;&#65292;&#29992;&#25143;&#21517;&#38271;&#24230;&#12289;&#29992;&#25143;id&#26159;&#21542;&#23384;&#22312;&#12289;&#29992;&#25143;&#21517;&#26159;&#21542;&#24050;&#32463;&#23384;&#22312;&#31561;&#12290;
</p>
<p>
 Service&#32479;&#19968;&#35748;&#20026;&#23427;&#20204;&#37117;&#26159;&#21069;&#32622;&#30340;&#21442;&#25968;&#26657;&#39564;&#65292;&#20294;&#23454;&#38469;&#19978;&#22312;&#19994;&#21153;&#35282;&#24230;&#30475;&#23427;&#20204;&#26159;&#26377;&#21306;&#21035;&#30340;&#12290;
</p>
<p>
 &#27604;&#22914;&#26657;&#39564;&#29992;&#25143;&#21517;&#38271;&#24230;&#12289;&#25163;&#26426;&#21495;&#21512;&#27861;&#24615;&#12289;&#20256;&#20837;&#30340;&#29992;&#25143;id&#26159;&#21542;&#23384;&#22312;&#31561;&#26657;&#39564;&#37117;&#26159;&#23646;&#20110;&#36890;&#29992;&#30340;&#19982;&#19994;&#21153;&#21547;&#20041;&#26080;&#20851;&#30340;&#36890;&#29992;&#21512;&#27861;&#24615;&#21442;&#25968;&#26657;&#39564;&#12290;&#21512;&#27861;&#24615;&#21442;&#25968;&#26657;&#39564;&#20801;&#35768;&#34987;&#30452;&#25509;&#23450;&#20041;&#22312;&#24212;&#29992;&#26381;&#21153;&#20013;&#65292;&#22240;&#20026;&#23427;&#20204;&#20250;&#20915;&#23450;&#24212;&#29992;&#26381;&#21153;&#32534;&#25490;&#30340;&#36208;&#21521;&#65292;&#21442;&#25968;&#26657;&#39564;&#19981;&#36890;&#36807;&#23601;&#19981;&#25191;&#34892;&#21518;&#32493;&#19994;&#21153;&#36923;&#36753;&#20102;&#12290;
</p>
<p>
 &#20294;&#26159;&#20687;&#20462;&#25913;&#29992;&#25143;&#21517;&#31216;&#20043;&#21069;&#65292;&#26657;&#39564;&#20462;&#25913;&#21518;&#30340;&#29992;&#25143;&#21517;&#22312;&#24403;&#21069;&#31995;&#32479;&#20013;&#19981;&#23384;&#22312;&#36825;&#20010;&#36923;&#36753;&#65292;&#23427;&#23601;&#26159;&#23646;&#20110;&#19994;&#21153;&#24615;&#30340;&#36923;&#36753;&#12290;&#22240;&#20026;&#25105;&#20204;&#22312;&#20462;&#25913;&#29992;&#25143;&#21517;&#31216;&#20043;&#21069;&#65292;&#24517;&#39035;&#20445;&#35777;&#29992;&#25143;&#21517;&#22312;&#31995;&#32479;&#26159;&#19981;&#23384;&#22312;&#30340;&#65292;&#24182;&#19981;&#26159;&#21442;&#25968;&#21512;&#27861;&#24615;&#30340;&#26657;&#39564;&#65292;&#32780;&#26159;&#20174;&#19994;&#21153;&#35282;&#24230;&#20986;&#21457;&#30340;&#26657;&#39564;&#36923;&#36753;&#12290;&#20063;&#23601;&#26159;&#35828;&#20462;&#25913;&#29992;&#25143;&#19982;&#26657;&#39564;&#29992;&#25143;&#21517;&#26410;&#37325;&#22797;&#24212;&#35813;&#26159;&#34987;&#20869;&#32858;&#22312;&#39046;&#22495;&#30340;&#36923;&#36753;&#20013;&#30340;&#12290;
</p>
<p>
 &#21363; MVC &#20013; Service &#30340;&#36825;&#27573;&#36923;&#36753;&#65306;
</p>
<pre><code>&#160;//&#26657;&#39564;&#20462;&#25913;&#30340;&#29992;&#25143;&#21517;&#26159;&#21542;&#23384;&#22312;
&#160;UserPO existUserName = userMapper.selectByUserName(dto.getUserName());
&#160;if(Objects.nonNull(existUserName)  &amp;&amp; Objects.equals(existUserName.getId(),dto.getId())){
&#160;  throw new RunnableException("&#29992;&#25143;&#21517;&#24050;&#23384;&#22312;&#65292;&#20462;&#25913;&#22833;&#36133;");
&#160;}
&#160;&#8203;
&#160;//&#20462;&#25913;&#29992;&#25143;&#21517;
&#160;exist.setUserName(dto.getUserName());
</code></pre>
<p>
 &#22312;&#24212;&#29992;&#26381;&#21153;&#20013;&#30340;&#20307;&#29616;&#26159;&#36825;&#26679;&#65306;
</p>
<pre><code>&#160;//&#20462;&#25913;&#29992;&#25143;&#21517;
&#160;User existUser = userRepository.byUserName(command.getUserName());
&#160;user.bindUserName(command.getUserName(),existUser);
</code></pre>
<p>
 &#32780;bindUserName&#36825;&#20010;&#26041;&#27861;&#23454;&#38469;&#30340;&#36923;&#36753;&#34987;&#23450;&#20041;&#22312;User&#30340;&#32858;&#21512;&#26681;&#20869;&#65306;
</p>
<pre><code>&#160;/**
&#160; * &#20462;&#25913;&#29992;&#25143;&#21517;
&#160; *
&#160; * @param userName &#20462;&#25913;&#21518;&#30340;&#29992;&#25143;&#21517;
&#160; * @param existUser &#26681;&#25454;&#20462;&#25913;&#21518;&#30340;&#29992;&#25143;&#21517;&#26597;&#35810;&#20986;&#26469;&#29992;&#25143;
&#160; */
&#160;public void bindUserName(String userName,User existUser){
&#160; &#160;  ValidationUtil.isTrue(Objects.isNull(existUser) || Objects.equals(existUser.getId(),this.id),"user.user.name.is.exist");
&#160; &#160;  this.userName = userName;
&#160;}
</code></pre>
<p>
 &#32780;&#19994;&#21153;&#21442;&#25968;&#30340;&#21512;&#27861;&#24615;&#26657;&#39564;&#22823;&#22810;&#25968;&#24773;&#20917;&#19979;&#37117;&#26159;&#34987;&#23450;&#20041;&#22312;&#20837;&#21442;&#19978;&#65292;&#36890;&#36807;Spring&#25552;&#20379;@Valid&#21442;&#25968;&#26657;&#39564;&#25903;&#25745;&#12290;&#20294;&#26159;&#26377;&#30340;&#26102;&#20505;&#21487;&#33021;&#24517;&#39035;&#35201;&#22312;&#23450;&#20041;&#22312;&#24212;&#29992;&#26381;&#21153;&#20869;&#65292;&#24182;&#19988;&#21069;&#32622;&#30340;&#21512;&#27861;&#24615;&#21442;&#25968;&#26657;&#39564;&#27604;&#36739;&#22810;&#12290;&#36825;&#31181;&#24773;&#20917;&#19979;&#20026;&#20102;&#31361;&#20986;&#19994;&#21153;&#36923;&#36753;&#19982;&#22797;&#29992;&#26657;&#39564;&#36923;&#36753;&#65292;&#21487;&#20197;&#21333;&#29420;&#25277;&#21462;&#19968;&#20010;XXValidationService&#65292;&#29992;&#20110;&#19987;&#38376;&#22788;&#29702;&#26576;&#19968;&#32858;&#21512;&#30340;&#21442;&#25968;&#26657;&#39564;&#36923;&#36753;&#12290;
</p>
<h3>
 3. &#36923;&#36753;&#32534;&#25490;
</h3>
<p>
 &#21482;&#35201;&#28041;&#21450;&#21040;&#19994;&#21153;&#36923;&#36753;&#22788;&#29702;&#25110;&#32773;&#23545;&#39046;&#22495;&#27169;&#22411;&#23646;&#24615;&#36827;&#34892;&#20462;&#25913;&#30340;&#36923;&#36753;&#65292;&#37117;&#19981;&#21487;&#20197;&#30452;&#25509;&#22312;&#24212;&#29992;&#26381;&#21153;&#20869;&#36827;&#34892;&#25805;&#20316;&#12290;&#38656;&#35201;&#23558;&#19994;&#21153;&#36923;&#36753;&#23450;&#20041;&#22312;&#39046;&#22495;&#27169;&#22411;&#20869;&#37096;&#65292;&#24212;&#29992;&#26381;&#21153;&#21482;&#26159;&#26080;&#33041;&#22320;&#35843;&#29992;&#39046;&#22495;&#26381;&#21153;&#30340;&#36923;&#36753;&#65292;&#20687;&#25645;&#31215;&#26408;&#19968;&#26679;&#25340;&#20945;&#20986;&#19968;&#20010;&#21151;&#33021;&#12290;
</p>
<p>
 &#20363;&#22914;&#65292;Service&#20013;&#30340;&#31532;18&#34892;&#30465;&#30053;&#30340;100&#34892;&#20195;&#30721;&#21487;&#33021;&#23601;&#26159;&#22312;&#25191;&#34892;&#26576;&#19968;&#20010;&#19994;&#21153;&#36923;&#36753;&#25805;&#20316;&#65292;&#22312;&#24212;&#29992;&#26381;&#21153;&#20013;&#23427;&#30340;&#21576;&#29616;&#26041;&#24335;&#24212;&#35813;&#26159;&#23558;&#36825;100&#34892;&#20195;&#30721;&#30340;&#19994;&#21153;&#36923;&#36753;&#23450;&#20041;&#33267;&#32858;&#21512;&#20869;&#37096;&#12290;
</p>
<pre><code>&#160;/**
&#160; * &#28436;&#31034;&#20462;&#25913;&#19994;&#21153;&#36923;&#36753;
&#160; */
&#160;public void printUpdate(){
&#160; &#160;  //&#27492;&#22788;&#30465;&#30053;100&#34892;&#20195;&#30721;
&#160; &#160;  log.info(this.userName + "&#21457;&#29983;&#20462;&#25913;");
&#160;}
</code></pre>
<p>
 &#28982;&#21518;&#24212;&#29992;&#26381;&#21153;&#20013;&#35843;&#29992;&#36825;&#27573;&#36923;&#36753;&#65306;
</p>
<pre><code>&#160;//&#25191;&#34892;&#29992;&#25143;&#20462;&#25913;&#30456;&#20851;&#19994;&#21153;&#36923;&#36753;
&#160;user.printUpdate();
</code></pre>
<p>
 <strong>
  &#24403;&#28982;&#36825;&#20165;&#20165;&#26159;&#27604;&#36739;&#31616;&#21333;&#30340;&#22330;&#26223;&#65292;&#26377;&#30340;&#36824;&#20250;&#28041;&#21450;&#21040;&#30452;&#25509;&#27969;&#31243;&#20998;&#25903;&#36208;&#21521;&#65292;&#20307;&#29616;&#21040;&#20195;&#30721;&#20013;&#23601;&#26159;if/else&#19982;switch&#12290;
 </strong>
</p>
<p>
 &#36825;&#37096;&#20998;&#30340;&#21028;&#26029;&#36923;&#36753;&#25105;&#22312;&#8220;DDD&#30340;&#20998;&#23618;&#35814;&#35299;&#8221;&#19968;&#25991;&#20013;&#20063;&#21465;&#36848;&#36807;&#65292;&#19968;&#23450;&#35201;&#21306;&#20998;&#22909;&#24403;&#21069;&#21028;&#26029;&#26159;&#19994;&#21153;&#27969;&#31243;&#36824;&#26159;&#20998;&#25903;&#27969;&#31243;&#36208;&#21521;&#12290;&#28389;&#29992;&#20998;&#25903;&#21028;&#26029;&#26465;&#20214;&#20250;&#23548;&#33268;&#24212;&#29992;&#26381;&#21153;&#36864;&#21270;&#25104;Service&#12290;
</p>
<h3>
 4. &#20179;&#20648;&#35843;&#29992;
</h3>
<p>
 Service&#20013;&#25805;&#20316;&#30340;&#37117;&#26159;&#25968;&#25454;&#27169;&#22411;&#65292;&#20445;&#23384;&#26102;&#35843;&#29992;&#30340;&#26159;Dao&#12290;&#32780;&#22312;&#24212;&#29992;&#26381;&#21153;&#20013;&#65292;&#32534;&#25490;&#23436;&#39046;&#22495;&#27169;&#22411;&#21518;&#65292;&#25105;&#20204;&#35843;&#29992;&#20179;&#20648;&#25805;&#20316;&#39046;&#22495;&#27169;&#22411;&#65292;&#30001;&#20179;&#20648;&#22788;&#29702;&#36716;&#21270;&#25104;&#25968;&#25454;&#27169;&#22411;&#12290;
</p>
<p>
 &#19982;Service&#19981;&#21516;&#30340;&#26159;&#65292;&#24212;&#29992;&#26381;&#21153;&#20445;&#23384;&#39046;&#22495;&#27169;&#22411;&#27809;&#26377;&#21508;&#31181;update&#26041;&#27861;&#65292;&#21482;&#26377;&#19968;&#20010;save&#25805;&#20316;&#65292;&#20840;&#37327;&#26356;&#26032;&#12290;&#36825;&#20040;&#20570;&#20445;&#35777;&#20102;&#65292;&#20445;&#35777;&#20179;&#20648;&#23618;&#26159;&#27809;&#26377;&#20219;&#20309;&#19994;&#21153;&#36923;&#36753;&#30340;&#12290;&#21151;&#33021;&#28857;&#24050;&#32463;&#34987;&#24212;&#29992;&#26381;&#21153;&#35843;&#29992;&#39046;&#22495;&#36923;&#36753;&#32534;&#25490;&#23436;&#25104;&#12290;
</p>
<p>
 <strong>
  &#36825;&#37324;&#38656;&#35201;&#29305;&#21035;&#27880;&#24847;&#30340;&#26159;&#65292;&#19981;&#20801;&#35768;&#22312;&#19968;&#20010;&#24212;&#29992;&#26381;&#21153;&#20869;&#35843;&#29992;&#20004;&#20010;&#19981;&#21516;&#20179;&#20648;&#30340;save&#26041;&#27861;
 </strong>
 &#12290;
</p>
<p>
 &#36825;&#26679;&#20250;&#23548;&#33268;&#39046;&#22495;&#27169;&#22411;&#30340;&#20462;&#25913;&#20837;&#21475;&#19981;&#26159;&#38598;&#20013;&#22312;&#26576;&#19968;&#22359;&#21151;&#33021;&#28857;&#12290;&#22914;&#26524;&#26377;&#21516;&#26102;&#20462;&#25913;&#20004;&#20010;&#39046;&#22495;&#27169;&#22411;&#30340;&#38656;&#27714;&#26102;&#65292;&#25105;&#20204;&#24212;&#35813;&#36890;&#36807;&#20107;&#20214;&#39537;&#21160;&#27169;&#22411;&#25110;&#32773;&#23545;&#24212;&#39046;&#22495;&#30340;&#33021;&#21147;&#23618;&#26469;&#21327;&#20316;&#65292;&#32780;&#19981;&#26159;&#30452;&#25509;&#36890;&#36807;&#35843;&#29992;&#21478;&#19968;&#39046;&#22495;&#30340;&#20179;&#20648;&#20462;&#25913;&#39046;&#22495;&#27169;&#22411;&#12290;
</p>
<p>
 <strong>
  &#37027;&#22914;&#26524;&#25105;&#38656;&#35201;&#35843;&#29992;&#20854;&#20182;&#39046;&#22495;&#30340;&#26597;&#35810;&#33021;&#21147;&#21602;&#65311;
 </strong>
</p>
<p>
 &#26597;&#35810;&#19982;&#22686;&#21024;&#25913;&#19981;&#21516;&#65292;&#23427;&#26412;&#36523;&#23545;&#25968;&#25454;&#19981;&#20855;&#22791;&#20462;&#25913;&#33021;&#21147;&#65292;&#22240;&#27492;&#20801;&#35768;&#22312;&#24212;&#29992;&#26381;&#21153;&#30340;&#26041;&#27861;&#20869;&#25191;&#34892;&#19981;&#21516;&#20179;&#20648;&#30340;byId&#26041;&#27861;&#33719;&#21462;&#19981;&#21516;&#30340;&#20179;&#20648;&#36827;&#34892;&#19994;&#21153;&#36923;&#36753;&#22788;&#29702;&#12290;
</p>
<p>
 &#20294;&#26159;&#36825;&#37324;&#25105;&#20204;&#38656;&#35201;&#27880;&#24847;&#65292;&#23613;&#37327;&#19981;&#35201;&#35843;&#29992;queryApplicationService&#21435;&#33719;&#21462;dto&#25968;&#25454;&#65292;&#28982;&#21518;&#26469;&#25191;&#34892;&#30456;&#24212;&#30340;&#19994;&#21153;&#36923;&#36753;&#12290;&#39318;&#20808;&#36825;&#32943;&#23450;&#36829;&#32972;&#20102;CQRS&#27169;&#22411;&#35774;&#35745;&#30340;&#21021;&#34935;&#65292;&#25226;CQ&#30340;&#36923;&#36753;&#28151;&#28102;&#20102;&#65292;&#39029;&#38754;&#30340;&#25968;&#25454;&#23637;&#31034;&#27169;&#22411;&#28151;&#20837;&#20102;&#39046;&#22495;&#27169;&#22411;&#30340;&#36923;&#36753;&#32534;&#25490;&#20013;&#12290;&#20854;&#27425;&#65292;&#21518;&#32493;&#22914;&#26524;&#26597;&#35810;&#36923;&#36753;&#21464;&#20102;&#65292;&#39046;&#22495;&#36923;&#36753;&#23558;&#34987;&#8220;&#25375;&#25345;&#8221;&#34987;&#36843;&#26356;&#25913;&#65292;&#36825;&#26159;&#24456;&#21361;&#38505;&#30340;&#34892;&#20026;&#12290;&#22914;&#26524;&#19994;&#21153;&#38656;&#27714;&#23454;&#22312;&#27809;&#21150;&#27861;&#24517;&#39035;&#35843;&#29992;&#26597;&#35810;&#24212;&#29992;&#26381;&#21153;&#26469;&#25903;&#25745;&#26597;&#35810;&#36923;&#36753;&#26102;&#65292;&#25105;&#20063;&#24314;&#35758;&#20320;&#19987;&#38376;&#20889;&#19968;&#20010;&#26597;&#35810;&#30340;&#33021;&#21147;&#23618;&#26469;&#38450;&#33104;&#25968;&#25454;&#27169;&#22411;&#36879;&#20837;&#21040;&#39046;&#22495;&#27169;&#22411;&#20013;&#12290;
</p>
<p>
 <strong>
  &#22914;&#26524;&#26159;&#31995;&#32479;&#22806;&#39046;&#22495;&#30340;&#25968;&#25454;&#65292;&#21017;&#36890;&#36807;&#36866;&#37197;&#22120;&#25509;&#21475;&#26469;&#35843;&#29992;&#33719;&#21462;&#12290;
 </strong>
</p>
<h3>
 5. &#21457;&#36865;&#39046;&#22495;&#20107;&#20214;
</h3>
<p>
 &#24212;&#29992;&#26381;&#21153;&#23545;&#20110;Service&#35843;&#29992;&#22806;&#22495;&#26381;&#21153;&#21578;&#30693;&#24403;&#21069;&#39046;&#22495;&#20462;&#25913;&#30340;&#36923;&#36753;&#36890;&#36807;&#20107;&#20214;&#39537;&#21160;&#27169;&#22411;&#26469;&#23454;&#29616;&#12290;&#22312;&#32858;&#21512;&#21253;&#20013;&#23450;&#20041;&#29305;&#39030;&#30340;&#39046;&#22495;&#20107;&#20214;&#65288;&#21363;&#20107;&#20214;&#39118;&#26292;&#35752;&#35770;&#20986;&#26469;&#30340;&#20107;&#20214;&#65289;&#65292;&#28982;&#21518;&#22312;&#20107;&#20214;&#34987;&#35302;&#21457;&#21518;&#21457;&#36865;&#39046;&#22495;&#20107;&#20214;&#65292;&#35753;&#22806;&#22495;&#33258;&#34892;&#20915;&#23450;&#22914;&#20309;&#30417;&#21548;&#22788;&#29702;&#12290;
</p>
<p>
 &#27604;&#22914;&#24212;&#29992;&#26381;&#21153;&#21457;&#36865;&#29992;&#25143;&#21517;&#34987;&#20462;&#25913;&#20107;&#20214;&#65306;
</p>
<pre><code>&#160;//&#21457;&#24067;&#29992;&#25143;&#20462;&#25913;&#30340;&#39046;&#22495;&#20107;&#20214;
&#160;domainEventPublisher.publish(new UserUpdateEvent(save));
</code></pre>
<p>
 &#20854;&#20182;&#39046;&#22495;&#38656;&#35201;&#24863;&#30693;&#27492;&#20107;&#20214;&#30340;&#22686;&#21152;&#23545;&#24212;&#30340;&#30417;&#21548;&#31867;&#65306;
</p>
<pre><code>&#160;@Component
&#160;@Slf4j
&#160;public class UserEventHandler {
&#160;&#8203;
&#160;    @AutoWired
&#160;    XXApplicationService xXApplicationService
&#160;&#8203;
&#160; &#160;  @TransactionalEventListener(fallbackExecution = true)
&#160; &#160;  public Result&lt;Object&gt; handleEvent(UserUpdateEvent event) {
&#160; &#160; &#160; &#160; &#160; &#160; //&#29992;&#25143;&#21517;&#21518;&#65292;&#21518;&#32493;&#25191;&#34892;&#24378;&#30456;&#20851;&#30340;&#38142;&#24335;&#35843;&#29992;&#36923;&#36753;
&#160; &#160; &#160; &#160; &#160; &#160; xXApplicationService.doSomething();
&#160; &#160;  }
&#160;&#8203;
&#160;}
</code></pre>
<p>
 &#30001;&#20110;&#24212;&#29992;&#26381;&#21153;&#26159;&#39046;&#22495;&#27169;&#22411;&#20462;&#25913;&#30340;&#20837;&#21475;&#65292;&#22240;&#27492;&#30417;&#21548;&#20107;&#20214;&#26412;&#36136;&#19978;&#20063;&#38656;&#35201;&#35843;&#29992;&#22806;&#22495;&#30340;&#39046;&#22495;&#26381;&#21153;&#26469;&#23436;&#25104;&#23545;&#22806;&#22495;&#30340;&#22788;&#29702;&#12290;
</p>
<p>
 <strong>
  &#20174;&#23439;&#35266;&#35282;&#24230;&#26469;&#30475;&#65292;&#20107;&#20214;&#30417;&#21548;&#31867;&#20063;&#23646;&#20110;&#29992;&#25143;&#20132;&#20114;&#23618;&#65292;&#23646;&#20110;&#22806;&#37096;&#36755;&#20837;&#12290;
 </strong>
</p>
<h2>
 &#19977;&#12289;&#26597;&#35810;&#24212;&#29992;&#26381;&#21153;
</h2>
<p>
 &#26597;&#35810;&#24212;&#29992;&#26381;&#21153;&#36981;&#20174;CQRS&#27169;&#22411;&#65292;&#23427;&#19981;&#20687;&#24212;&#29992;&#26381;&#21153;&#37027;&#26679;&#37027;&#20040;&#22810;&#30340;&#38480;&#21046;&#12290;&#23427;&#19981;&#38656;&#35201;&#39046;&#22495;&#27169;&#22411;&#20869;&#32858;&#36923;&#36753;&#65292;&#21482;&#38656;&#35201;&#25353;&#29031;&#21069;&#31471;&#24819;&#35201;&#30340;&#25968;&#25454;&#27169;&#22411;&#32452;&#21512;&#20986;&#21518;&#31471;&#30340;&#25968;&#25454;&#21363;&#21487;&#12290;
</p>
<p>
 &#27604;&#22914;&#26597;&#35810;&#29992;&#25143;&#21015;&#34920;&#65306;
</p>
<pre><code>&#160;@Override
&#160;public Page&lt;UserPageDTO&gt; userPage(KeywordQuery query){
&#160; &#160;  Page&lt;UserPO&gt; pos = userMapper.userPage(query);
&#160; &#160;  return pos.convert(po-&gt;{
&#160; &#160; &#160; &#160;  UserPageDTO dto = new UserPageDTO();
&#160; &#160; &#160; &#160;  this.initUserDTO(dto,po);
&#160; &#160; &#160; &#160;  List&lt;Long&gt; roleIds = Arrays.stream(po.getRoleIds().split(",")).map(Long::valueOf).collect(Collectors.toList());
&#160; &#160; &#160; &#160;  List&lt;RoleDTO&gt; roles = roleQueryApplicationService.list(roleIds);
&#160; &#160; &#160; &#160;  dto.setRoles(roles);
&#160; &#160; &#160; &#160;  return dto;
&#160; &#160;  });
&#160;}
</code></pre>
<p>
 &#19981;&#36807;&#23427;&#36824;&#26159;&#26377;&#19968;&#20123;&#22522;&#26412;&#35268;&#32422;&#12290;
</p>
<h3>
 1. &#26041;&#27861;&#20837;&#21442;
</h3>
<p>
 &#25105;&#20204;&#36981;&#20174;CQRS&#27169;&#22411;&#65292;&#20004;&#20010;&#20197;&#19978;&#30340;&#26041;&#27861;&#20837;&#21442;&#21253;&#35013;&#25104;Query&#21442;&#25968;&#65292;&#36923;&#36753;&#35821;&#20041;&#26356;&#24378;&#12290;
</p>
<h3>
 2. &#36923;&#36753;&#22788;&#29702;
</h3>
<p>
 &#26597;&#35810;&#34429;&#28982;&#35828;&#26159;&#32452;&#35013;&#23384;&#20648;&#20171;&#36136;&#20013;&#30340;&#25968;&#25454;&#65292;&#20294;&#26159;&#23427;&#20204;&#20063;&#26159;&#26377;&#19968;&#23450;&#30340;&#36923;&#36753;&#30340;&#12290;&#22240;&#27492;&#65292;&#23613;&#37327;&#36991;&#20813;&#22312;Dao&#23618;&#20570;&#36807;&#20110;&#22797;&#26434;&#30340;sql&#26597;&#35810;&#36923;&#36753;&#65292;&#23558;&#19994;&#21153;&#36923;&#36753;&#22788;&#29702;&#19982;&#25968;&#25454;&#32452;&#21512;&#25918;&#22312;&#26597;&#35810;&#24212;&#29992;&#26381;&#21153;&#20013;&#22788;&#29702;&#12290;
</p>
<h3>
 3. &#36873;&#25321;&#24615;&#24314;&#31435;&#26597;&#35810;&#20179;&#20648;
</h3>
<p>
 &#27491;&#24120;&#24773;&#20917;&#19979;&#65292;&#25105;&#20204;&#37117;&#26159;&#22312;&#21333;&#19968;&#23384;&#20648;&#20171;&#36136;&#20013;&#36827;&#34892;&#25968;&#25454;&#33719;&#21462;&#30340;&#12290;&#19968;&#26086;&#28041;&#21450;&#21040;&#36328;&#23384;&#20648;&#20171;&#36136;&#33719;&#21462;&#25968;&#25454;&#30340;&#36923;&#36753;&#65292;&#25105;&#20204;&#23601;&#38656;&#35201;&#22312;Dao&#23618;&#19982;&#26597;&#35810;&#24212;&#29992;&#26381;&#21153;&#20043;&#38388;&#23233;&#25509;&#19968;&#23618;&#26597;&#35810;&#20179;&#20648;&#26469;&#23631;&#34109;&#22810;&#23384;&#20648;&#20171;&#36136;&#19979;&#30340;&#21462;&#25968;&#36923;&#36753;&#12290;
</p>
<p>
 &#27604;&#22914;&#65292;&#26681;&#25454;&#29992;&#25143;id&#26597;&#35810;&#29992;&#25143;&#35814;&#24773;&#20808;&#20174;&#32531;&#23384;&#26597;&#65292;&#32531;&#23384;&#23384;&#22312;&#23601;&#36820;&#22238;&#65292;&#32531;&#23384;&#19981;&#23384;&#22312;&#21017;&#20174;&#25968;&#25454;&#24211;&#26597;&#65292;&#28982;&#21518;&#20889;&#20837;&#32531;&#23384;&#20877;&#36820;&#22238;&#12290;&#36825;&#20010;&#36923;&#36753;&#26412;&#36523;&#20854;&#23454;&#23601;&#26159;&#20026;&#20102;&#25343;&#21040;&#29992;&#25143;&#20449;&#24687;&#65292;&#25105;&#20204;&#24212;&#35813;&#23450;&#20041;&#19968;&#20010;&#26597;&#35810;&#24212;&#29992;&#20179;&#20648;&#65306;
</p>
<pre><code>&#160;public class UserQueryRepository{
&#160;&#8203;
&#160;  public UserInfoDTO byId(Long userId){
&#160;    UserInfoDTO info = userCache.get(id)
&#160;    if(info!=null){
&#160;      return info;
&#160;    }
&#160;    UserInfoDTO info = userMapper.byId(id);
&#160;    if(info == null){
&#160;      return info;
&#160;    }
&#160;    userCache.set(id,info);
&#160;    return info;
&#160; &#160; }
&#160;}
</code></pre>
<p>
 &#28982;&#21518;&#22312;&#24212;&#29992;&#26381;&#21153;&#20013;&#35843;&#29992;&#26597;&#35810;&#20179;&#20648;&#36923;&#36753;&#65306;
</p>
<pre><code>&#160;UserInfoDTO info = userQueryRepository.byId(id);
</code></pre>
<p>
 &#24403;&#28982;&#22914;&#26524;&#20320;&#21482;&#26159;&#26681;&#25454;id&#30452;&#25509;&#33719;&#21462;&#29992;&#25143;&#20449;&#24687;&#65292;&#20320;&#20063;&#21487;&#20197;&#30452;&#25509;&#22312;&#29992;&#25143;&#20132;&#20114;&#23618;&#30340;&#25509;&#21475;&#20013;&#30452;&#25509;&#35843;&#29992;&#26597;&#35810;&#20179;&#20648;&#65292;&#19981;&#29992;&#20877;&#36716;&#25509;&#19968;&#23618;&#26597;&#35810;&#24212;&#29992;&#26381;&#21153;&#12290;
</p>
<h3>
 4. &#26597;&#35810;&#24212;&#29992;&#26381;&#21153;&#20114;&#26597;
</h3>
<p>
 &#26597;&#35810;&#26159;&#20801;&#35768;&#24212;&#29992;&#26381;&#21153;&#20043;&#38388;&#20114;&#30456;&#35843;&#29992;&#30340;&#65292;&#27605;&#31455;&#21482;&#26159;&#25968;&#25454;&#27169;&#22411;&#30340;&#25968;&#25454;&#32452;&#35013;&#65292;&#26412;&#36136;&#19978;&#23601;&#26159;&#20026;&#20102;&#26041;&#27861;&#30340;&#22797;&#29992;&#22043;&#12290;
</p>
<h2>
 &#22235;&#12289;&#24635;&#32467;
</h2>
<p>
 &#26412;&#25991;&#20174;&#23454;&#38469;&#30340;&#29992;&#25143;&#22686;&#21024;&#25913;&#26597;&#38656;&#27714;&#20986;&#21457;&#65292;&#20171;&#32461;&#20102;&#24212;&#29992;&#26381;&#21153;&#22312;&#22686;&#21024;&#25913;&#39046;&#22495;&#27169;&#22411;&#26102;&#38656;&#35201;&#27880;&#24847;&#30340;&#28857;&#12290;&#25105;&#20204;&#22914;&#26524;&#25442;&#19968;&#31181;&#35282;&#24230;&#26469;&#30475;&#24453;&#24212;&#29992;&#26381;&#21153;&#65292;&#23427;&#23601;&#20687;&#26159;&#27969;&#31243;&#24341;&#25806;&#12290;&#24212;&#29992;&#26381;&#21153;&#26412;&#36523;&#19981;&#23450;&#20041;&#36923;&#36753;&#65292;&#23427;&#21482;&#36127;&#36131;&#26681;&#25454;&#26082;&#23450;&#30340;&#35268;&#21017;&#20018;&#32852;&#23450;&#20041;&#22312;&#39046;&#22495;&#27169;&#22411;&#20013;&#30340;&#19994;&#21153;&#36923;&#36753;&#65292;&#26368;&#32456;&#24418;&#25104;&#19968;&#20010;&#21151;&#33021;&#28857;&#12290;
</p>
<p>
 &#26597;&#35810;&#23601;&#27809;&#26377;&#37027;&#20040;&#22810;&#24367;&#24367;&#32469;&#32469;&#30340;&#65292;&#26681;&#25454;&#26597;&#35810;&#25152;&#38656;&#35201;&#30340;&#25968;&#25454;&#33258;&#30001;&#32452;&#21512;Dao&#23618;&#30340;&#25968;&#25454;&#23601;&#22909;&#20102;&#12290;&#20294;&#26159;&#38656;&#35201;&#27880;&#24847;&#25968;&#25454;&#26469;&#28304;&#20110;&#22810;&#20010;&#23384;&#20648;&#20171;&#36136;&#26102;&#65292;&#25105;&#20204;&#36824;&#26159;&#38656;&#35201;&#21152;&#19968;&#20010;&#26597;&#35810;&#20179;&#20648;&#30340;&#65292;&#36825;&#26679;&#21487;&#20197;&#35753;&#26597;&#35810;&#24212;&#29992;&#26381;&#21153;&#30340;&#19994;&#21153;&#36923;&#36753;&#26356;&#21152;&#31361;&#20986;&#12290;
</p>
<p>
 &#21516;&#26679;&#65292;&#22312;&#36825;&#19968;&#35762;&#30340;&#23398;&#20064;&#36807;&#31243;&#20013;&#65292;&#22914;&#26524;&#20320;&#36935;&#21040;&#20160;&#20040;&#38382;&#39064;&#25110;&#32773;&#26377;&#22909;&#30340;&#32463;&#39564;&#35201;&#20998;&#20139;&#65292;&#27426;&#36814;&#20320;&#22312;&#30041;&#35328;&#21306;&#19982;&#25105;&#20998;&#20139;&#65292;&#25105;&#20204;&#19968;&#36215;&#20132;&#27969;&#65292;&#19968;&#36215;&#36827;&#27493;&#12290;
</p>
</div>

</div>
</div>

        </body>
        
        