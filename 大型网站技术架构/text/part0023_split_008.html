<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-CN" lang="zh-CN">
  <head>
    <title>13　大型网站典型故障案例分析</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="../stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="../page_styles1.css" rel="stylesheet" type="text/css"/>
</head>
  <body class="calibre">
<h2 class="calibre7" id="calibre_pb_8"><a id="sec008" class="calibre8"></a>
 13.8　不规范的流程引发的故障</h2>
<p class="calibre1">
<span class="kindle-cn-bold">故障现象：</span>
 某应用发布后，数据库Load迅速飙升，超过报警值，回滚发布后报警消除。</p>
<p class="calibre1">
<span class="kindle-cn-bold">原因分析：</span>
 发现该应用发布后出现大量数据库读操作，而这些数据本来应该从分布式缓存读取。检查缓存，发现数据已经被缓存了。检查代码，发现访问缓存的那行代码被注释掉了。原来工程师在开发的时候，为了测试方便，特意注释掉读取缓存的代码，结果开发完成后忘记把注释去掉，直接提交到代码库被发布到线上环境。</p>
<p class="kindle-cn-bold1">经验教训：</p>
<ul class="kindle-cn-ul-disc">
<li class="calibre11">代码提交前使用diff命令进行代码比较，确认没有提交不该提交的代码。</li>
<li class="calibre11">加强code review，代码在正式提交前必须被至少一个其他工程师做过code review，并且共同承担因代码引起的故障责任。</li>
</ul>
</body>
</html>
