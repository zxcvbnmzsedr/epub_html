
        <html lang="en">
        <head>
        <meta charset="UTF-8"/>
        </head>
        <body>
        <div><div class="markdown-body">
    

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" href="style/style.css" type="text/css">

<div class="markdown-body">
    <div class="article-con">
 <!-- &#20080;&#36807;&#30340;&#38405;&#35835; -->
 <div class="art-title" style="margin-top: 0px;">
  31 &#20973;&#31080;&#21462;&#39184;&#8212;Future&#27169;&#24335;&#35814;&#35299;
 </div>
 <div class="art-info clearfix">
  <span class="l">
   &#26356;&#26032;&#26102;&#38388;&#65306;2019-12-12 09:40:27
  </span>
 </div>
 <div class="art-top">
  <img alt="" src="EPUB/ca167260-186d-11ed-a978-acde48001122">
  <div class="famous-word-box">
   <img alt="" class="bg1 bg" src="EPUB/ca368f46-186d-11ed-a978-acde48001122">
   <img alt="" class="bg2 bg" src="EPUB/ca4de7b8-186d-11ed-a978-acde48001122">
   <div class="famous-word">
    &#19982;&#26377;&#32925;&#32966;&#20154;&#20849;&#20107;&#65292;&#20174;&#26080;&#23383;&#21477;&#22788;&#35835;&#20070;&#12290;
    <p class="author">
     &#8212;&#8212;&#21608;&#24681;&#26469;
    </p>
   </div>
  </div>
 </div>
 <div class="art-content js-lookimg">
  <div id="article_content">
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     &#20174;&#26412;&#33410;&#24320;&#22987;&#65292;&#25105;&#20204;&#36827;&#20837;&#26032;&#30340;&#19968;&#31456;&#23398;&#20064;&#65292;&#21516;&#26102;&#20063;&#26159;&#26368;&#21518;&#19968;&#31456;&#30340;&#23398;&#20064;&#12290;&#25105;&#20204;&#20174;&#22914;&#20309;&#23454;&#29616;&#19968;&#20010;&#32447;&#31243;&#24320;&#22987;&#23398;&#36215;&#65292;&#23398;&#20064;&#20102;&#24182;&#21457;&#30340;&#38382;&#39064;&#21644;&#35299;&#20915;&#21150;&#27861;&#65292;&#23398;&#20064;&#20102;&#32447;&#31243;&#27744;&#31561;&#24037;&#20855;&#30340;&#20351;&#29992;&#65292;&#23398;&#20064;&#20102;&#21508;&#31181;&#24182;&#21457;&#23481;&#22120;&#12290;&#26412;&#31456;&#23558;&#20250;&#35762;&#35299;&#23454;&#38469;&#24320;&#21457;&#20013;&#32463;&#24120;&#20250;&#29992;&#21040;&#30340;&#22810;&#32447;&#31243;&#35774;&#35745;&#27169;&#24335;&#21450;&#20854;&#22312; JDK &#20013;&#30340;&#23454;&#29616;&#21644;&#24212;&#29992;&#12290;
    </p>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     &#26412;&#33410;&#25105;&#20204;&#35201;&#23398;&#20064;&#30340;&#26159; Future &#27169;&#24335;&#12290;&#25105;&#20204;&#20808;&#26469;&#30475;&#19968;&#20010;&#20363;&#23376;&#65292;&#20551;&#22914;&#20320;&#20013;&#21320;&#35201;&#20986;&#21435;&#20080;&#19968;&#20221;&#21320;&#39184;&#25171;&#21253;&#24102;&#22238;&#23478;&#65292;&#24182;&#19988;&#35201;&#21435;&#36229;&#24066;&#20080;&#19968;&#31649;&#29273;&#33167;&#65292;&#24212;&#35813;&#24590;&#20040;&#20570;&#25165;&#20250;&#26102;&#38388;&#26368;&#30701;&#65311;&#24403;&#28982;&#26159;&#28857;&#22909;&#22806;&#21334;&#65292;&#28982;&#21518;&#21435;&#36229;&#24066;&#20080;&#29273;&#33167;&#65292;&#31561;&#20320;&#22238;&#26469;&#30475;&#22806;&#21334;&#26159;&#21542;&#24050;&#32463;&#20570;&#22909;&#20102;&#65292;&#22914;&#26524;&#20570;&#22909;&#20102;&#65292;&#25343;&#23567;&#31080;&#21462;&#39184;&#12290;&#22914;&#26524;&#36824;&#27809;&#22909;&#65292;&#37027;&#23601;&#32487;&#32493;&#31561;&#24453;&#65292;&#31561;&#20570;&#22909;&#21518;&#21462;&#39184;&#22238;&#23478;&#12290;
    </p>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     &#22914;&#26524;&#31243;&#24207;&#19981;&#20351;&#29992;&#22810;&#32447;&#31243;&#23454;&#29616;&#30340;&#35805;&#65292;&#37027;&#20040;&#20027;&#32447;&#31243;&#23601;&#20250;&#38459;&#22622;&#22312;&#22806;&#21334;&#21152;&#24037;&#36807;&#31243;&#19978;&#65292;&#30452;&#21040;&#21320;&#39184;&#20570;&#22909;&#65292;&#25165;&#33021;&#21435;&#36229;&#24066;&#20080;&#19996;&#35199;&#12290;&#20294;&#22914;&#26524;&#25105;&#20204;&#37319;&#29992;&#22810;&#32447;&#31243;&#65292;&#21487;&#20197;&#28857;&#39184;&#21518;&#39532;&#19978;&#21435;&#36229;&#24066;&#20080;&#29273;&#33167;&#65292;&#21516;&#26102;&#26377;&#26032;&#30340;&#32447;&#31243;&#21152;&#24037;&#20320;&#30340;&#21320;&#39184;&#12290;&#20170;&#22825;&#25105;&#20204;&#26469;&#23398;&#20064;&#19968;&#31181;&#26032;&#30340;&#22810;&#32447;&#31243;&#24212;&#29992;&#27169;&#24335; Future&#65292;&#35299;&#20915;&#36215;&#31867;&#20284;&#38382;&#39064;&#23601;&#23481;&#26131;&#22810;&#20102;&#12290;
    </p>
   </div>
   <div class="cl-preview-section">
    <h2 id="&#12289;future&#27169;&#24335;&#20171;&#32461;" style="font-size: 30px;">
     1&#12289;Future &#27169;&#24335;&#20171;&#32461;
    </h2>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     &#25105;&#20204;&#20808;&#19981;&#30528;&#24613;&#35762;&#35299; Future&#65292;&#20808;&#26469;&#22238;&#39038;&#19979;&#20043;&#21069;&#25105;&#20204;&#35762;&#35299;&#30340; Thread &#21644; runnable&#65292;&#23454;&#29616;&#22810;&#32447;&#31243;&#30340;&#26041;&#24335;&#26159;&#26032;&#36215;&#32447;&#31243;&#36816;&#34892; run &#26041;&#27861;&#65292;&#20294;&#26159; run &#26041;&#27861;&#26377;&#20010;&#32570;&#38519;&#26159;&#27809;&#26377;&#36820;&#22238;&#20540;&#65292;&#24182;&#19988;&#20027;&#32447;&#31243;&#20063;&#24182;&#19981;&#30693;&#36947;&#26032;&#30340;&#32447;&#31243;&#20309;&#26102;&#36816;&#34892;&#23436;&#27605;&#12290;&#19978;&#25991;&#30340;&#20363;&#23376;&#65292;&#25105;&#20204;&#19981;&#20294;&#38656;&#35201;&#20570;&#39277;&#30340;&#32447;&#31243;&#36820;&#22238;&#21320;&#39184;&#65292;&#24182;&#19988;&#20027;&#32447;&#31243;&#38656;&#35201;&#30693;&#36947;&#21320;&#39184;&#24050;&#32463;&#22909;&#20102;&#12290;&#20351;&#29992;&#25105;&#20204;&#20043;&#21069;&#23398;&#20064;&#30693;&#35782;&#65292;&#36890;&#36807; wait&#12289;notify &#21644;&#20849;&#20139;&#36164;&#28304;&#20063;&#21487;&#20197;&#23454;&#29616;&#65292;&#20294;&#20250;&#27604;&#36739;&#22797;&#26434;&#12290;&#20854;&#23454; JDK &#25552;&#20379;&#20102;&#38750;&#24120;&#26041;&#20415;&#30340;&#24037;&#20855;&#23601;&#26159; Future&#12290;Future &#25345;&#26377;&#35201;&#36816;&#34892;&#30340;&#20219;&#21153;&#65292;&#20197;&#21450;&#20219;&#21153;&#30340;&#32467;&#26524;&#12290;&#20027;&#32447;&#31243;&#21482;&#35201;&#22768;&#26126;&#20102; Future &#23545;&#35937;&#65292;&#24182;&#19988;&#21551;&#21160;&#26032;&#30340;&#32447;&#31243;&#36816;&#34892;&#20182;&#12290;&#37027;&#20040;&#38543;&#26102;&#33021;&#36890;&#36807; Future &#23545;&#35937;&#33719;&#21462;&#21478;&#22806;&#32447;&#31243;&#36816;&#34892;&#30340;&#32467;&#26524;&#12290;
    </p>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     &#25509;&#19979;&#26469;&#25105;&#20204;&#30475;&#30475; Future &#22914;&#20309;&#23454;&#29616;&#20363;&#23376;&#20013;&#30340;&#22330;&#26223;&#12290;
    </p>
   </div>
   <div class="cl-preview-section">
    <h2 id="&#12289;future-&#20351;&#29992;" style="font-size: 30px;">
     2&#12289;Future &#20351;&#29992;
    </h2>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     &#19978;&#36848;&#20363;&#23376;&#30340;&#20195;&#30721;&#22914;&#19979;&#65306;
    </p>
   </div>
   <div class="cl-preview-section">
    <pre class="language-java"><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Client</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> ExecutionException<span class="token punctuation">,</span> InterruptedException <span class="token punctuation">{</span>
        
      FutureTask<span class="token operator">&lt;</span>String<span class="token operator">&gt;</span> cookTask <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FutureTask</span><span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Callable</span><span class="token operator">&lt;</span>String<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> String <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>
                Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token string">"5&#26020;&#30340;&#40857;&#34430;"</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        Long startTime <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"&#25105;&#28857;&#20102;5&#26020;&#30340;&#40857;&#34430;&#12290;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>cookTask<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"&#25105;&#21435;&#20080;&#29273;&#33167;&#12290;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        TimeUnit<span class="token punctuation">.</span>SECONDS<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"&#25105;&#20080;&#21040;&#29273;&#33167;&#20102;&#65281;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      
        String lunch <span class="token operator">=</span> cookTask<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"&#25105;&#28857;&#30340;"</span><span class="token operator">+</span>lunch<span class="token operator">+</span><span class="token string">"&#24050;&#32463;OK&#20102;&#65281;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        Long userTime <span class="token operator">=</span> <span class="token punctuation">(</span>System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> startTime<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">1000</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"&#25105;&#19968;&#20849;&#29992;&#20102;"</span><span class="token operator">+</span>userTime<span class="token operator">+</span><span class="token string">"&#31186;&#20080;&#21320;&#39184;&#24182;&#19988;&#20080;&#29273;&#33167;&#12290;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     &#20195;&#30721;&#20013;&#20808;&#20102;&#19968;&#20010; FutureTask &#23545;&#35937;&#65292;&#31216;&#20043;&#20026; cookTask&#12290;&#39038;&#21517;&#24605;&#20041;&#65292;&#36825;&#20010; task &#26159;&#29992;&#26469;&#20570;&#39277;&#30340;&#12290;&#21487;&#20197;&#30475;&#21040;&#26500;&#36896;&#26041;&#27861;&#20013;&#20256;&#20837; Callable &#30340;&#23454;&#29616;&#12290;&#23454;&#29616;&#30340; call &#26041;&#27861;&#20013;&#27169;&#25311;&#20570;&#39277;&#29992;&#20102; 3 &#31186;&#38047;&#12290;
    </p>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     &#20027;&#32447;&#31243;&#36816;&#34892;&#21518;&#65292;&#20808;&#28857;&#20102; 5 &#26020;&#30340;&#40857;&#34430;&#65292;&#28982;&#21518;&#19968;&#20010;&#26032;&#30340;&#32447;&#31243;&#23601;&#24320;&#22987;&#21435;&#25191;&#34892; cookTask &#20102;&#12290;&#31561;&#20250;&#20799;&#65292;&#21040;&#36825;&#37324;&#20320;&#19968;&#23450;&#20250;&#38382;&#65292;Thread &#26500;&#36896;&#26041;&#27861;&#38656;&#35201;&#20256;&#20837; Runnable &#30340;&#23454;&#29616;&#21834;&#65311;&#27809;&#38169;&#65292;FutureTask &#23454;&#29616;&#20102; Runnable &#25509;&#21475;&#12290;FutureTask &#30340; run &#26041;&#27861;&#23454;&#38469;&#25191;&#34892;&#30340;&#26159; Callable &#30340; call &#26041;&#27861;&#12290;&#37027;&#20040;&#26032;&#30340;&#32447;&#31243; start &#21518;&#65292;&#23454;&#38469;&#20570;&#39277;&#30340;&#36923;&#36753;&#20250;&#34987;&#25191;&#34892;&#65306;&#33258;&#32447;&#31243; sleep3 &#31186;&#21518;&#36820;&#22238; &#8220;5 &#26020;&#30340;&#40857;&#34430;&#8221;&#12290;
    </p>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     &#20027;&#32447;&#31243;&#22312;&#21551;&#21160;&#20570;&#39277;&#30340;&#33258;&#32447;&#31243;&#21518;&#32487;&#32493;&#21521;&#19979;&#25191;&#34892;&#65292;&#21435;&#20080;&#29273;&#33167;&#12290;&#36825;&#37324; sleep &#20004;&#31186;&#65292;&#27169;&#25311;&#20080;&#29273;&#33167;&#30340;&#26102;&#38388;&#28040;&#32791;&#12290;
    </p>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     &#20080;&#21040;&#29273;&#33167;&#25509;&#19979;&#26469;&#30340;&#19968;&#34892;&#20195;&#30721; String lobster = cookTask.get (); &#37325;&#28857;&#35828;&#19968;&#19979;&#65292;&#27492;&#26102;&#20998;&#20004;&#31181;&#24773;&#20917;&#65306;
    </p>
   </div>
   <div class="cl-preview-section">
    <ol>
     <li style="font-size: 20px; line-height: 38px;">
      cookTask &#36816;&#34892;&#30340;&#32447;&#31243;&#24050;&#32463;&#32467;&#26463;&#20102;&#65292;&#37027;&#20040;&#21487;&#20197;&#30452;&#25509;&#21462;&#21040;&#36816;&#34892;&#30340;&#32467;&#26524;&#36171;&#20540;&#32473; lunch&#65307;
     </li>
     <li style="font-size: 20px; line-height: 38px;">
      cookTask &#36816;&#34892;&#30340;&#32447;&#31243;&#36824;&#27809;&#26377;&#25191;&#34892;&#32467;&#26463;&#65292;&#27492;&#26102;&#20027;&#32447;&#31243;&#20250;&#38459;&#22622;&#65292;&#30452;&#21040;&#33021;&#21462;&#24471;&#36816;&#34892;&#32467;&#26524;&#12290;
     </li>
    </ol>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     cookTask &#23601;&#26159;&#20320;&#30340;&#36141;&#29289;&#23567;&#31080;&#65292;&#21482;&#35201;&#20320;&#27809;&#24324;&#20002;&#65292;&#38543;&#26102;&#33021;&#21435;&#21462;&#20320;&#30340;&#21320;&#39277;&#12290;
    </p>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     &#31243;&#24207;&#26368;&#21518;&#35745;&#31639;&#20102;&#25972;&#20010;&#36807;&#31243;&#30340;&#25191;&#34892;&#26102;&#38388;&#12290;&#30001;&#20110;&#37319;&#29992;&#20102;&#22810;&#32447;&#31243;&#24182;&#21457;&#65292;&#25152;&#20197;&#25191;&#34892;&#26102;&#38388;&#24212;&#35813;&#31561;&#20110;&#32791;&#26102;&#26368;&#38271;&#30340;&#37027;&#20010;&#20219;&#21153;&#12290;&#36825;&#20010;&#20363;&#23376;&#20013;&#20570;&#40857;&#34430; 3 &#31186; &gt; &#20080;&#29273;&#33167; 2 &#31186;&#65292;&#25152;&#20197;&#24635;&#20849;&#32791;&#26102; 3 &#31186;&#65292;&#36755;&#20986;&#22914;&#19979;&#65306;
    </p>
   </div>
   <div class="cl-preview-section">
    <pre><code>&#25105;&#28857;&#20102;5&#26020;&#30340;&#40857;&#34430;
&#25105;&#21435;&#20080;&#29273;&#33167;
&#25105;&#20080;&#21040;&#29273;&#33167;&#20102;&#65281;
&#25105;&#28857;&#30340;5&#26020;&#30340;&#40857;&#34430;&#24050;&#32463;OK&#20102;
&#25105;&#19968;&#20849;&#29992;&#20102;3&#31186;&#20080;&#21320;&#39184;&#24182;&#19988;&#20080;&#29273;&#33167;
</code></pre>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     &#21152;&#20837;&#25105;&#35843;&#25972;&#20080;&#29273;&#33167;&#38656;&#35201; 10 &#31186;&#65292;&#37027;&#20040;&#36755;&#20986;&#21017;&#22914;&#19979;&#65306;
    </p>
   </div>
   <div class="cl-preview-section">
    <pre><code>&#25105;&#28857;&#20102;5&#26020;&#30340;&#40857;&#34430;
&#25105;&#21435;&#20080;&#29273;&#33167;
&#25105;&#20080;&#21040;&#29273;&#33167;&#20102;&#65281;
&#25105;&#28857;&#30340;5&#26020;&#30340;&#40857;&#34430;&#24050;&#32463;OK&#20102;
&#25105;&#19968;&#20849;&#29992;&#20102;10&#31186;&#20080;&#21320;&#39184;&#24182;&#19988;&#20080;&#29273;&#33167;
</code></pre>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     &#24635;&#20849;&#32791;&#26102; 10 &#31186;&#12290;
    </p>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     &#29616;&#22312;&#25105;&#20204;&#24819;&#19968;&#19979;&#65292;&#20551;&#22914;&#21333;&#32447;&#31243;&#20018;&#34892;&#25191;&#34892;&#65292;&#28857;&#23436;&#21320;&#39184;&#24517;&#39035;&#31561;&#24453;&#21320;&#39184;&#20570;&#22909;&#20102;&#65292;&#25165;&#33021;&#21435;&#20080;&#29273;&#33167;&#12290;&#37027;&#20040;&#27704;&#36828;&#32791;&#26102;&#37117;&#26159; 2 &#32773;&#20043;&#21644;&#12290;&#37319;&#29992;&#24182;&#21457;&#25191;&#34892;&#21518;&#65292;&#20165;&#20026;&#26102;&#38388;&#36739;&#38271;&#30340;&#37027;&#20010;&#20219;&#21153;&#30340;&#26102;&#38388;&#12290;
    </p>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     &#30001;&#20110;&#25105;&#20204;&#35843;&#29992; Future &#30340; get &#26041;&#27861;&#21518;&#20027;&#32447;&#31243;&#23601;&#24320;&#22987;&#38459;&#22622;&#20102;&#65292;&#25152;&#20197;&#25105;&#20204;&#24212;&#35813;&#22312;&#30495;&#27491;&#38656;&#35201;&#20351;&#29992; Future &#23545;&#35937;&#30340;&#36820;&#22238;&#32467;&#26524;&#26102;&#25165;&#21435;&#35843;&#29992;&#65292;&#20805;&#20998;&#21033;&#29992;&#24182;&#21457;&#30340;&#29305;&#24615;&#26469;&#25552;&#21319;&#31243;&#24207;&#24615;&#33021;&#12290;
    </p>
   </div>
   <div class="cl-preview-section">
    <h2 id="&#12289;future&#28304;&#30721;&#35299;&#26512;" style="font-size: 30px;">
     3&#12289;Future &#28304;&#30721;&#35299;&#26512;
    </h2>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     Future &#26159;&#19968;&#20010;&#25509;&#21475;&#65292;&#32780; FutrueTask &#21017;&#26159;&#20182;&#30340;&#23454;&#29616;&#65292;&#25105;&#20204;&#30475;&#19968;&#19979;&#23427;&#20204;&#30340;&#32487;&#25215;&#20851;&#31995;&#65306;
    </p>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     <img alt="&#22270;&#29255;&#25551;&#36848;" class="" data-original="//img.mukewang.com/5def17ec000191fa04410287.jpg" src="EPUB/ca63c164-186d-11ed-a978-acde48001122">
     <br>
     FutureTask &#19981;&#20294;&#23454;&#29616;&#20102; Future &#32780;&#19988;&#23454;&#29616;&#20102; Runnable &#25509;&#21475;&#12290;&#36825;&#20063;&#26159;&#20026;&#20160;&#20040;&#23427;&#33021;&#20316;&#20026;&#21442;&#25968;&#20256;&#20837; Thread &#26500;&#36896;&#26041;&#27861;&#12290;
    </p>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     Runnable &#25509;&#21475;&#25105;&#20204;&#35762;&#36807;&#65292;&#37324;&#38754;&#21482;&#26377;&#19968;&#20010; run &#26041;&#27861;&#65292;&#29992;&#20110;&#34987; Thread &#35843;&#29992;&#12290;&#25105;&#20204;&#30475;&#19968;&#19979; Future &#25509;&#21475;&#26377;&#21738;&#20123;&#26041;&#27861;&#65306;
     <br>
     <img alt="&#22270;&#29255;&#25551;&#36848;" class="" data-original="//img.mukewang.com/5def17e20001e9cf02900141.jpg" src="EPUB/ca787adc-186d-11ed-a978-acde48001122">
    </p>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     cancel &#29992;&#20110;&#23581;&#35797;&#21462;&#28040;&#20219;&#21153;&#12290;
    </p>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     get &#29992;&#20110;&#31561;&#24453;&#24182;&#33719;&#21462;&#20219;&#21153;&#25191;&#34892;&#32467;&#26524;&#12290;&#24102;&#26102;&#38388;&#21442;&#25968;&#30340; get &#26041;&#27861;&#21482;&#20250;&#31561;&#24453;&#25351;&#23450;&#26102;&#38388;&#38271;&#24230;&#12290;
    </p>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     isCancelled &#36820;&#22238;&#20219;&#21153;&#22312;&#23436;&#25104;&#21069;&#26159;&#21542;&#24050;&#32463;&#34987;&#21462;&#28040;&#12290;
    </p>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     isDone &#36820;&#22238;&#20219;&#21153;&#26159;&#21542;&#23436;&#25104;&#12290;
    </p>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     &#25105;&#20204;&#29992;&#21040;&#26368;&#22810;&#30340;&#23601;&#26159; get &#26041;&#27861;&#65292;&#33719;&#21462;&#20219;&#21153;&#30340;&#25191;&#34892;&#32467;&#26524;&#12290;
    </p>
   </div>
   <div class="cl-preview-section">
    <h3 id="futuretask&#26500;&#36896;&#26041;&#27861;">
     3.1 FutureTask &#26500;&#36896;&#26041;&#27861;
    </h3>
   </div>
   <div class="cl-preview-section">
    <pre class="language-java"><code class="prism language-java"><span class="token keyword">public</span> <span class="token function">FutureTask</span><span class="token punctuation">(</span>Callable<span class="token operator">&lt;</span>V<span class="token operator">&gt;</span> callable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>callable <span class="token operator">==</span> null<span class="token punctuation">)</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NullPointerException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>callable <span class="token operator">=</span> callable<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> NEW<span class="token punctuation">;</span>       <span class="token comment">// ensure visibility of callable</span>
<span class="token punctuation">}</span>
</code></pre>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     &#38656;&#35201;&#20256;&#20837; Callable &#30340;&#23454;&#29616;&#65292;Callable &#26159;&#19968;&#20010;&#25509;&#21475;&#65292;&#23450;&#20041;&#20102; call &#26041;&#27861;&#65292;&#36820;&#22238; V &#31867;&#22411;&#12290;
    </p>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     &#28982;&#21518;&#23450;&#20041;&#20102; FutureTask &#30340;&#29366;&#24577;&#20026; NEW&#12290;FutrueTask &#23450;&#20041;&#20102;&#22914;&#19979;&#29366;&#24577;&#65306;
    </p>
   </div>
   <div class="cl-preview-section">
    <pre class="language-java"><code class="prism language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> NEW          <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> COMPLETING   <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> NORMAL       <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> EXCEPTIONAL  <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> CANCELLED    <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> INTERRUPTING <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> INTERRUPTED  <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>
</code></pre>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     &#36890;&#36807;&#23383;&#38754;&#25105;&#20204;&#24456;&#23481;&#26131;&#29702;&#35299;&#20854;&#21547;&#20041;&#12290;
    </p>
   </div>
   <div class="cl-preview-section">
    <h3 id="run&#26041;&#27861;&#35299;&#26512;">
     3.2 run &#26041;&#27861;&#35299;&#26512;
    </h3>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     FutrueTask &#23454;&#29616;&#20102; Runnbale &#25509;&#21475;&#65292;&#25152;&#20197; Thread &#36816;&#34892;&#21518;&#23454;&#38469;&#19978;&#25191;&#34892;&#30340;&#26159; FutrueTask &#30340; run &#26041;&#27861;&#12290;&#25105;&#20204;&#35201;&#24819;&#20102;&#35299; Future &#30340;&#23454;&#29616;&#21407;&#29702;&#65292;&#37027;&#20040;&#23601;&#24212;&#35813;&#20174;&#23427;&#30340; run &#26041;&#27861;&#24320;&#22987;&#20837;&#25163;&#12290;
    </p>
   </div>
   <div class="cl-preview-section">
    <pre class="language-java"><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//&#22914;&#26524;&#27492;&#26102;&#29366;&#24577;&#19981;&#20026;NEW&#30452;&#25509;&#32467;&#26463;</span>
  <span class="token comment">//&#22914;&#26524;&#20026;NEW&#65292;&#20294;&#26159;CAS&#25805;&#20316;&#25226;&#26412;&#32447;&#31243;&#20889;&#20837;&#20026;runner&#26102;&#65292;&#21457;&#29616;runner&#24050;&#32463;&#19981;&#20026;null&#65292;&#37027;&#20040;&#20063;&#30452;&#25509;&#32467;&#26463;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>state <span class="token operator">!=</span> NEW <span class="token operator">||</span>
        <span class="token operator">!</span>UNSAFE<span class="token punctuation">.</span><span class="token function">compareAndSwapObject</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> runnerOffset<span class="token punctuation">,</span>
                                     null<span class="token punctuation">,</span> Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token comment">//&#21462;&#24471;Callable&#23545;&#35937;</span>
        Callable<span class="token operator">&lt;</span>V<span class="token operator">&gt;</span> c <span class="token operator">=</span> callable<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> state <span class="token operator">==</span> NEW<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            V result<span class="token punctuation">;</span>
            <span class="token keyword">boolean</span> ran<span class="token punctuation">;</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
              <span class="token comment">//&#36816;&#34892;Callable&#23545;&#35937;&#30340;call&#26041;&#27861;&#65292;&#24182;&#19988;&#21462;&#24471;&#36820;&#22238;&#20540;&#12290;</span>
                result <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                ran <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                result <span class="token operator">=</span> null<span class="token punctuation">;</span>
                ran <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
                <span class="token function">setException</span><span class="token punctuation">(</span>ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
          <span class="token comment">//&#22914;&#26524;call&#26041;&#27861;&#25104;&#21151;&#25191;&#34892;&#32467;&#26463;&#65292;&#37027;&#20040;&#25226;&#25191;&#34892;&#32467;&#26524;&#35774;&#32622;&#32473;&#25104;&#21592;&#21464;&#37327;outcome;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>ran<span class="token punctuation">)</span>
                <span class="token function">set</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
        <span class="token comment">// runner must be non-null until state is settled to</span>
        <span class="token comment">// prevent concurrent calls to run()</span>
        runner <span class="token operator">=</span> null<span class="token punctuation">;</span>
        <span class="token comment">// state must be re-read after nulling runner to prevent</span>
        <span class="token comment">// leaked interrupts</span>
        <span class="token keyword">int</span> s <span class="token operator">=</span> state<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>s <span class="token operator">&gt;=</span> INTERRUPTING<span class="token punctuation">)</span>
            <span class="token function">handlePossibleCancellationInterrupt</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     &#26680;&#24515;&#36923;&#36753;&#23601;&#26159;&#25191;&#34892;&#36816;&#34892; Callable &#23545;&#35937;&#30340; call &#26041;&#27861;&#65292;&#25226;&#36820;&#22238;&#32467;&#26524;&#20889;&#20837; outcome&#12290;outcome &#29992;&#26469;&#20445;&#23384;&#35745;&#31639;&#32467;&#26524;&#12290;
    </p>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     &#20445;&#23384;&#35745;&#31639;&#32467;&#26524;&#21017;&#26159;&#36890;&#36807; set &#26041;&#27861;&#12290;
    </p>
   </div>
   <div class="cl-preview-section">
    <h3 id="set-&#26041;&#27861;&#35299;&#26512;">
     3.3 set &#26041;&#27861;&#35299;&#26512;
    </h3>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     set &#26041;&#27861;&#20195;&#30721;&#22914;&#19979;&#65306;
    </p>
   </div>
   <div class="cl-preview-section">
    <pre class="language-java"><code class="prism language-java"><span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span>V v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  	<span class="token comment">//&#29366;&#24577;&#36824;&#26159;NEW&#65292;&#20445;&#23384;&#35745;&#31639;&#32467;&#26524;&#32473;outcome</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>UNSAFE<span class="token punctuation">.</span><span class="token function">compareAndSwapInt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> stateOffset<span class="token punctuation">,</span> NEW<span class="token punctuation">,</span> COMPLETING<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        outcome <span class="token operator">=</span> v<span class="token punctuation">;</span>
      <span class="token comment">//&#26356;&#26032;&#29366;&#24577;&#20026;NORMAL</span>
        UNSAFE<span class="token punctuation">.</span><span class="token function">putOrderedInt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> stateOffset<span class="token punctuation">,</span> NORMAL<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// final state</span>
      <span class="token comment">//&#21796;&#37266;&#31561;&#24453;&#30340;&#32447;&#31243;</span>
        <span class="token function">finishCompletion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     &#22914;&#26524;&#27809;&#26377;&#34987;&#21462;&#28040;&#21017;&#20250;&#20445;&#23384;&#35745;&#31639;&#32467;&#26524; v &#21040; outcome&#12290;&#28982;&#21518;&#26356;&#26032;&#26368;&#32456;&#29366;&#24577;&#20026; NORMAL&#12290;&#26368;&#21518;&#35843;&#29992; finishCompletion &#26041;&#27861;&#21796;&#37266;&#38459;&#22622;&#30340;&#32447;&#31243;&#12290;&#20195;&#30721;&#22914;&#19979;&#65306;
    </p>
   </div>
   <div class="cl-preview-section">
    <pre class="language-java"><code class="prism language-java"><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">finishCompletion</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// assert state &gt; COMPLETING;</span>
  <span class="token comment">//&#36941;&#21382;&#31561;&#24453;&#32447;&#31243;&#65292;&#32467;&#26463;&#31561;&#24453;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>WaitNode q<span class="token punctuation">;</span> <span class="token punctuation">(</span>q <span class="token operator">=</span> waiters<span class="token punctuation">)</span> <span class="token operator">!=</span> null<span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>UNSAFE<span class="token punctuation">.</span><span class="token function">compareAndSwapObject</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> waitersOffset<span class="token punctuation">,</span> q<span class="token punctuation">,</span> null<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token comment">//&#32467;&#26463;&#31561;&#24453;&#32447;&#31243;&#30340;&#25346;&#36215;</span>
                Thread t <span class="token operator">=</span> q<span class="token punctuation">.</span>thread<span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>t <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    q<span class="token punctuation">.</span>thread <span class="token operator">=</span> null<span class="token punctuation">;</span>
                    LockSupport<span class="token punctuation">.</span><span class="token function">unpark</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
              <span class="token comment">//&#22914;&#26524;&#27809;&#26377;&#19979;&#19968;&#20010;&#31561;&#24453;&#32447;&#31243;&#65292;&#37027;&#20040;&#32467;&#26463;&#24490;&#29615;</span>
                WaitNode next <span class="token operator">=</span> q<span class="token punctuation">.</span>next<span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>next <span class="token operator">==</span> null<span class="token punctuation">)</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                q<span class="token punctuation">.</span>next <span class="token operator">=</span> null<span class="token punctuation">;</span> <span class="token comment">// unlink to help gc</span>
                q <span class="token operator">=</span> next<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
		<span class="token comment">//&#20840;&#37096;&#23436;&#25104;&#21518;&#22238;&#35843;FutrueTask&#30340;done&#26041;&#27861;&#12290;done&#26041;&#27861;&#20026;&#31354;&#65292;&#21487;&#20197;&#30001;&#23376;&#31867;&#23454;&#29616;&#12290;</span>
    <span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">//&#28165;&#38500;callable</span>
    callable <span class="token operator">=</span> null<span class="token punctuation">;</span>        <span class="token comment">// to reduce footprint</span>
<span class="token punctuation">}</span>
</code></pre>
   </div>
   <div class="cl-preview-section">
    <h3 id="get-&#26041;&#27861;&#35299;&#26512;">
     3.4 get &#26041;&#27861;&#35299;&#26512;
    </h3>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     get &#26041;&#27861;&#29992;&#20110;&#33719;&#21462;&#20219;&#21153;&#30340;&#36820;&#22238;&#20540;&#65292;&#22914;&#26524;&#36824;&#27809;&#26377;&#25191;&#34892;&#23436;&#25104;&#65292;&#21017;&#20250;&#38459;&#22622;&#65292;&#20195;&#30721;&#22914;&#19979;&#65306;
    </p>
   </div>
   <div class="cl-preview-section">
    <pre class="language-java"><code class="prism language-java"><span class="token keyword">public</span> V <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> InterruptedException<span class="token punctuation">,</span> ExecutionException <span class="token punctuation">{</span>
    <span class="token comment">//&#33719;&#21462;&#24403;&#21069;Task&#30340;&#29366;&#24577;</span>
  	<span class="token keyword">int</span> s <span class="token operator">=</span> state<span class="token punctuation">;</span>
    <span class="token comment">//&#22914;&#26524;&#36824;&#27809;&#26377;&#23436;&#25104;&#65292;&#21017;&#38459;&#22622;&#31561;&#24453;&#23436;&#25104;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>s <span class="token operator">&lt;=</span> COMPLETING<span class="token punctuation">)</span>
        s <span class="token operator">=</span> <span class="token function">awaitDone</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> 0L<span class="token punctuation">)</span><span class="token punctuation">;</span>
  	<span class="token comment">//&#33719;&#21462;&#20219;&#21153;&#25191;&#34892;&#30340;&#36820;&#22238;&#32467;&#26524;</span>
    <span class="token keyword">return</span> <span class="token function">report</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     &#25105;&#20204;&#20808;&#26469;&#30475; awaitDone &#30340;&#20195;&#30721;&#65306;
    </p>
   </div>
   <div class="cl-preview-section">
    <pre class="language-java"><code class="prism language-java"><span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token function">awaitDone</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> timed<span class="token punctuation">,</span> <span class="token keyword">long</span> nanos<span class="token punctuation">)</span>
    <span class="token keyword">throws</span> InterruptedException <span class="token punctuation">{</span>
  <span class="token comment">//&#35745;&#31639;&#31561;&#24453;&#25130;&#27490;&#26102;&#38271;</span>
    <span class="token keyword">final</span> <span class="token keyword">long</span> deadline <span class="token operator">=</span> timed <span class="token operator">?</span> System<span class="token punctuation">.</span><span class="token function">nanoTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> nanos <span class="token operator">:</span> 0L<span class="token punctuation">;</span>
    WaitNode q <span class="token operator">=</span> null<span class="token punctuation">;</span>
    <span class="token keyword">boolean</span> queued <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">//&#24403;&#21069;&#32447;&#31243;&#22914;&#26524;&#34987;&#25171;&#26029;&#65292;&#21017;&#19981;&#20877;&#31561;&#24453;&#12290;&#20174;&#31561;&#24453;&#38142;&#34920;&#20013;&#31227;&#38500;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">interrupted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">removeWaiter</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">InterruptedException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
			<span class="token comment">//&#21462;&#24471;&#30446;&#21069;&#30340;&#29366;&#24577;</span>
        <span class="token keyword">int</span> s <span class="token operator">=</span> state<span class="token punctuation">;</span>
      <span class="token comment">//&#22914;&#26524;&#24050;&#32463;&#25191;&#34892;&#23436;&#25104;&#65292;&#28165;&#31354;q&#33410;&#28857;&#20445;&#23384;&#30340;&#32447;&#31243;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>s <span class="token operator">&gt;</span> COMPLETING<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>q <span class="token operator">!=</span> null<span class="token punctuation">)</span>
                q<span class="token punctuation">.</span>thread <span class="token operator">=</span> null<span class="token punctuation">;</span>
            <span class="token keyword">return</span> s<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token comment">//&#22914;&#26524;&#27491;&#22312;&#25191;&#34892;&#65292;&#35753;&#20986;CPU&#25191;&#34892;&#26435;</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>s <span class="token operator">==</span> COMPLETING<span class="token punctuation">)</span> <span class="token comment">// cannot time out yet</span>
            Thread<span class="token punctuation">.</span><span class="token function">yield</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//&#27809;&#26377;&#36827;&#20837;&#20197;&#19978;&#20998;&#25903;&#65292;&#36816;&#34892;&#21040;&#27492;&#20998;&#25903;&#65292;&#36825;&#35828;&#26126;&#27492;&#32447;&#31243;&#30830;&#23454;&#38656;&#35201;&#24320;&#22987;&#31561;&#24453;&#20102;&#65292;</span>
      <span class="token comment">//&#37027;&#20040;&#22914;&#26524;&#36824;&#26410;&#20026;&#27492;&#32447;&#31243;&#24314;&#31435;&#20851;&#32852;&#30340;&#31561;&#24453;&#33410;&#28857;&#65292;&#21017;&#36827;&#34892;&#21019;&#24314;&#12290;</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>q <span class="token operator">==</span> null<span class="token punctuation">)</span>
            q <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WaitNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//&#36890;&#36807;CAS&#25226;&#27492;&#32447;&#31243;&#30340;&#31561;&#24453;node&#21152;&#20837;&#21040;&#36830;&#34920;&#20013;&#12290;&#22833;&#36133;&#30340;&#35805;&#65292;&#19979;&#27425;&#24490;&#29615;&#33509;&#33021;&#36816;&#34892;&#21040;&#27492;&#20998;&#25903;&#65292;&#20250;&#32487;&#32493;&#28155;&#21152;&#12290;</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>queued<span class="token punctuation">)</span>
            queued <span class="token operator">=</span> UNSAFE<span class="token punctuation">.</span><span class="token function">compareAndSwapObject</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> waitersOffset<span class="token punctuation">,</span>
                                                 q<span class="token punctuation">.</span>next <span class="token operator">=</span> waiters<span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//&#22914;&#26524;&#35774;&#32622;&#20102;&#36229;&#26102;&#65292;&#26816;&#26597;&#26159;&#21542;&#36229;&#26102;&#12290;&#36229;&#26102;&#30340;&#35805;&#32467;&#26463;&#31561;&#24453;&#12290; &#21542;&#21017;&#25346;&#36215;&#36229;&#26102;&#26102;&#38271;</span>
      <span class="token comment">//&#22914;&#26524;&#27809;&#26377;&#35774;&#32622;&#36229;&#26102;&#26102;&#38271;&#65292;&#21017;&#27704;&#20037;&#25346;&#36215;</span>
      <span class="token comment">//&#22238;&#21040;&#19978;&#38754;&#30340;finishCompletion&#26041;&#27861;&#65292;&#31561;&#21040;task&#25191;&#34892;&#23436;&#25104;&#21518;&#20250;&#25191;&#34892;LockSupport.unpark(t)&#65292;&#32467;&#26463;&#38459;&#22622;&#12290;</span>
      <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>timed<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            nanos <span class="token operator">=</span> deadline <span class="token operator">-</span> System<span class="token punctuation">.</span><span class="token function">nanoTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>nanos <span class="token operator">&lt;=</span> 0L<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">removeWaiter</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> state<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            LockSupport<span class="token punctuation">.</span><span class="token function">parkNanos</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> nanos<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span>
            LockSupport<span class="token punctuation">.</span><span class="token function">park</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     &#26368;&#21518;&#25105;&#20204;&#30475;&#19968;&#19979; report &#26041;&#27861;&#65306;
    </p>
   </div>
   <div class="cl-preview-section">
    <pre class="language-java"><code class="prism language-java"><span class="token keyword">private</span> V <span class="token function">report</span><span class="token punctuation">(</span><span class="token keyword">int</span> s<span class="token punctuation">)</span> <span class="token keyword">throws</span> ExecutionException <span class="token punctuation">{</span>
  <span class="token comment">//&#33719;&#21462;&#25191;&#34892;&#32467;&#26524;</span>
    Object x <span class="token operator">=</span> outcome<span class="token punctuation">;</span>
  <span class="token comment">//NORMAL&#20026;&#27491;&#24120;&#32467;&#26463;&#65292;&#37027;&#20040;&#30452;&#25509;&#25226;X&#36716;&#22411;&#21518;&#36820;&#22238;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>s <span class="token operator">==</span> NORMAL<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>V<span class="token punctuation">)</span>x<span class="token punctuation">;</span>
  <span class="token comment">//&#22914;&#26524;&#20219;&#21153;&#34987;&#21462;&#28040;&#20102;&#65292;&#21017;&#25243;&#20986;&#24322;&#24120;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>s <span class="token operator">&gt;=</span> CANCELLED<span class="token punctuation">)</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">CancellationException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ExecutionException</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Throwable<span class="token punctuation">)</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     outcome &#20445;&#23384;&#30340;&#23601;&#26159;&#20219;&#21153;&#30340;&#25191;&#34892;&#32467;&#26524;&#12290;&#26681;&#25454;&#27492;&#26102;&#30340;&#29366;&#24577;&#65292;&#36873;&#25321;&#36820;&#22238;&#25191;&#34892;&#32467;&#26524;&#36824;&#26159;&#25243;&#20986;&#21462;&#28040;&#30340;&#24322;&#24120;&#12290;
    </p>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     &#26368;&#21518;&#25105;&#20204;&#24635;&#32467;&#19979; FutureTask &#30340;&#20195;&#30721;&#65306;
    </p>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     1&#12289;FutureTask &#23454;&#29616; Runnable &#21644; Future &#25509;&#21475;&#65307;
    </p>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     2&#12289;&#22312;&#32447;&#31243;&#19978;&#36816;&#34892; FutureTask &#21518;&#65292;run &#26041;&#27861;&#34987;&#35843;&#29992;&#65292;run &#26041;&#27861;&#20250;&#35843;&#29992;&#20256;&#20837;&#30340; Callable &#25509;&#21475;&#30340; call &#26041;&#27861;&#65307;
    </p>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     3&#12289;&#25343;&#21040;&#36820;&#22238;&#20540;&#21518;&#65292;&#36890;&#36807; set &#26041;&#27861;&#20445;&#23384;&#32467;&#26524;&#21040; outcome&#65292;&#24182;&#19988;&#21796;&#37266;&#25152;&#26377;&#31561;&#24453;&#30340;&#32447;&#31243;&#65307;
    </p>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     4&#12289;&#35843;&#29992; get &#26041;&#27861;&#33719;&#21462;&#25191;&#34892;&#32467;&#26524;&#26102;&#65292;&#22914;&#26524;&#27809;&#26377;&#25191;&#34892;&#23436;&#27605;&#65292;&#21017;&#36827;&#20837;&#31561;&#24453;&#65292;&#30452;&#21040; set &#26041;&#27861;&#35843;&#29992;&#21518;&#34987;&#21796;&#37266;&#12290;
    </p>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     &#19979;&#22270;&#31034;&#24847;&#20102;&#20004;&#20010;&#32447;&#31243;&#36816;&#34892; task &#21644; get &#26102;&#30340;&#31243;&#24207;&#36923;&#36753;&#65306;
     <br>
     <img alt="&#22270;&#29255;&#25551;&#36848;" class="" data-original="//img.mukewang.com/5def17cf0001e90b11350434.jpg" src="EPUB/ca8cae62-186d-11ed-a978-acde48001122">
    </p>
   </div>
   <div class="cl-preview-section">
    <h2 id="&#12289;&#24635;&#32467;" style="font-size: 30px;">
     4&#12289;&#24635;&#32467;
    </h2>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     Future &#27169;&#24335;&#22312;&#23454;&#38469;&#24320;&#21457;&#20013;&#26377;&#30528;&#22823;&#37327;&#30340;&#24212;&#29992;&#22330;&#26223;&#12290;&#27604;&#22914;&#35828;&#24494;&#26381;&#21153;&#26550;&#26500;&#20013;&#65292;&#38656;&#35201;&#35843;&#29992;&#19981;&#21516;&#26381;&#21153;&#25509;&#21475;&#33719;&#21462;&#25968;&#25454;&#65292;&#20294;&#26159;&#25509;&#21475;&#35843;&#29992;&#38388;&#24182;&#26080;&#20381;&#36182;&#20851;&#31995;&#65292;&#37027;&#20040;&#21487;&#20197;&#36890;&#36807; FutureTask &#24182;&#21457;&#35843;&#29992;&#65292;&#28982;&#21518;&#20877;&#25191;&#34892;&#21518;&#32493;&#36923;&#36753;&#12290;&#22914;&#26524;&#25105;&#20204;&#37319;&#29992;&#20018;&#34892;&#30340;&#26041;&#24335;&#65292;&#21017;&#38656;&#35201;&#19968;&#20010;&#25509;&#21475;&#36820;&#22238;&#21518;&#65292;&#20877;&#35843;&#29992;&#19979;&#19968;&#20010;&#25509;&#21475;&#12290;FutreTask &#38656;&#35201;&#32467;&#21512; Callable &#25509;&#21475;&#20351;&#29992;&#65292;&#31034;&#20363;&#20195;&#30721;&#20013;&#20026;&#20102;&#35753;&#22823;&#23478;&#26174;&#31034;&#30340;&#30475;&#21040; Callable &#25509;&#21475;&#65292;&#25152;&#20197;&#37319;&#29992;&#21311;&#21517;&#23545;&#35937;&#30340;&#26041;&#24335;&#12290;&#23454;&#38469;&#20351;&#29992;&#20013;&#25105;&#20204;&#21487;&#20197;&#20351;&#29992; lambda &#34920;&#36798;&#24335;&#26469;&#31616;&#21270;&#20195;&#30721;&#65292;&#22914;&#19979;&#65306;
    </p>
   </div>
   <div class="cl-preview-section">
    <pre class="language-java"><code class="prism language-java">FutureTask<span class="token operator">&lt;</span>String<span class="token operator">&gt;</span> cookTask <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FutureTask</span><span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token string">"5&#26020;&#30340;&#40857;&#34430;"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
   </div>
   }
  </div>
 </div>
 <!-- &#20080;&#36807;&#30340;&#38405;&#35835; -->
 <div class="art-next-prev clearfix">
  <!-- &#24050;&#20080;&#19988;&#24320;&#25918; &#25110;&#32773;&#21487;&#20197;&#35797;&#35835; -->
  <a href="/read/49/article/964">
   <div class="prev l clearfix">
    <div class="icon l">
     <i class="imv2-arrow3_l">
     </i>
    </div>
    <p>
     30 &#38480;&#37327;&#20379;&#24212;&#65292;&#19981;&#22909;&#24847;&#24605;&#24744;&#26469;&#26202;&#20102;&#8212;Semaphore&#35814;&#35299;
    </p>
   </div>
  </a>
  <!-- &#24050;&#20080;&#19988;&#24320;&#25918; &#25110;&#32773;&#21487;&#20197;&#35797;&#35835; -->
  <a href="/read/49/article/966">
   <div class="next r clearfix">
    <p>
     32 &#35831;&#25353;&#21040;&#22330;&#39034;&#24207;&#21457;&#35328;&#8212;Completion Service&#35814;&#35299;
    </p>
    <div class="icon r">
     <i class="imv2-arrow3_r">
     </i>
    </div>
   </div>
  </a>
 </div>
</div>

</div>

</div>
</div>

        </body>
        
        