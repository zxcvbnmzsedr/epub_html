
        <html lang="en">
        <head>
        <meta charset="UTF-8"/>
        </head>
        <body>
        <div><div class="markdown-body">
    

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" href="style/style.css" type="text/css">

<div class="markdown-body">
    <div class="article-con">
 <!-- &#20080;&#36807;&#30340;&#38405;&#35835; -->
 <div class="art-title" style="margin-top: 0px;">
  29 &#19968;&#25163;&#20132;&#38065;&#65292;&#19968;&#25163;&#20132;&#36135;&#8212;Exchanger&#35814;&#35299;
 </div>
 <div class="art-info clearfix">
  <span class="l">
   &#26356;&#26032;&#26102;&#38388;&#65306;2019-12-05 09:48:58
  </span>
 </div>
 <div class="art-top">
  <img alt="" src="EPUB/c88dd99c-186d-11ed-a978-acde48001122">
  <div class="famous-word-box">
   <img alt="" class="bg1 bg" src="EPUB/c8af269c-186d-11ed-a978-acde48001122">
   <img alt="" class="bg2 bg" src="EPUB/c8cb07b8-186d-11ed-a978-acde48001122">
   <div class="famous-word">
    &#19990;&#19978;&#26080;&#38590;&#20107;,&#21482;&#35201;&#32943;&#30331;&#25856;&#12290;
    <p class="author">
     &#8212;&#8212;&#27611;&#27901;&#19996;
    </p>
   </div>
  </div>
 </div>
 <div class="art-content js-lookimg">
  <div id="article_content">
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     Exchanger &#20174;&#23383;&#38754;&#26469;&#30475;&#26159;&#19968;&#20010;&#20132;&#25442;&#22120;&#65292;&#23427;&#29992;&#26469;&#22312;&#32447;&#31243;&#38388;&#20132;&#25442;&#25968;&#25454;&#12290;&#22914;&#26524;&#20004;&#20010;&#32447;&#31243;&#24182;&#34892;&#22788;&#29702;&#65292;&#20294;&#22312;&#26576;&#20010;&#26102;&#21051;&#38656;&#35201;&#20114;&#30456;&#20132;&#25442;&#33258;&#24049;&#24050;&#32463;&#22788;&#29702;&#23436;&#30340;&#20013;&#38388;&#25968;&#25454;&#65292;&#28982;&#21518;&#25165;&#33021;&#32487;&#32493;&#24448;&#19979;&#25191;&#34892;&#12290;&#36825;&#20010;&#26102;&#20505;&#23601;&#21487;&#20197;&#20351;&#29992; Exchanger&#12290;
    </p>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     &#20004;&#20010;&#32447;&#31243;&#19981;&#29992;&#35851;&#38754;&#65292;&#20294;&#26159;&#36890;&#36807; Exchanger &#23601;&#33021;&#23454;&#29616;&#25968;&#25454;&#20132;&#25442;&#65292;&#36825;&#26159;&#22914;&#20309;&#20570;&#21040;&#30340;&#21602;&#65311;&#25105;&#20204;&#21487;&#20197;&#35748;&#20026; Exchanger &#26377;&#20004;&#20010;&#27133;&#20301;&#65292;&#32447;&#31243;&#21487;&#20197;&#21521;&#20854;&#20013;&#25918;&#20837;&#33258;&#24049;&#24819;&#35201;&#20132;&#25442;&#30340;&#25968;&#25454;&#65292;&#28982;&#21518;&#38459;&#22622;&#22312;&#27492;&#65292;&#31561;&#24453;&#20854;&#23427;&#32447;&#31243;&#22635;&#20805;&#21478;&#22806;&#30340;&#27133;&#20301;&#12290;&#31561;&#20004;&#20010;&#27133;&#20301;&#37117;&#22635;&#20805;&#25968;&#25454;&#21518;&#65292;Exchanger &#20250;&#25226;&#27133;&#20301;&#35843;&#25442;&#20301;&#32622;&#65292;&#35753;&#32447;&#31243;&#21462;&#21040;&#21478;&#22806;&#32447;&#31243;&#25918;&#20837;&#30340;&#25968;&#25454;&#12290;&#22914;&#19979;&#22270;&#25152;&#31034;&#65306;
    </p>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     <img alt="&#22270;&#29255;&#25551;&#36848;" class="" data-original="//img.mukewang.com/5dd5fb5f00016d5b16000815.jpg" src="EPUB/c8e4a9d4-186d-11ed-a978-acde48001122">
    </p>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     &#21069;&#38754;&#30340;&#25551;&#36848;&#21482;&#26159;&#20026;&#20102;&#24110;&#21161;&#29702;&#35299;&#65292;&#20854;&#23454;Exchanger &#30495;&#23454;&#30340;&#35774;&#35745;&#26356;&#20026;&#22797;&#26434;&#12290;&#19979;&#38754;&#25105;&#20204;&#20808;&#36890;&#36807;&#19968;&#20010;&#31616;&#21333;&#30340;&#20363;&#23376;&#26469;&#30475;&#30475;&#22914;&#20309;&#20351;&#29992; Exchanger&#12290;
    </p>
   </div>
   <div class="cl-preview-section">
    <h2 id="&#12289;exchanger-&#30340;&#20351;&#29992;" style="font-size: 30px;">
     1&#12289;Exchanger &#30340;&#20351;&#29992;
    </h2>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     &#25105;&#20204;&#35774;&#24819;&#22914;&#19979;&#22330;&#26223;&#65306;&#22914;&#26524;&#20170;&#22825;&#19978;&#21320;&#20320;&#38656;&#35201;&#32473;&#20320;&#22899;&#26379;&#21451;&#24555;&#36882;&#19968;&#37096;&#25163;&#26426;&#65292;&#20294;&#26159;&#31361;&#28982;&#20320;&#35201;&#21435;&#19968;&#20010;&#32039;&#24613;&#30340;&#20250;&#35758;&#12290;&#20110;&#26159;&#20320;&#25226;&#24555;&#36882;&#30340;&#19996;&#35199;&#30041;&#32473;&#20320;&#30340;&#21516;&#20107;&#12290;&#24403;&#24555;&#36882;&#21462;&#20214;&#21592;&#19978;&#38376;&#26102;&#65292;&#20182;&#20250;&#25226;&#24555;&#36882;&#24213;&#21333;&#32473;&#20320;&#21516;&#20107;&#65292;&#20320;&#21516;&#20107;&#21017;&#20250;&#25226;&#24555;&#36882;&#32473;&#21462;&#20214;&#21592;&#12290;&#28982;&#21518;&#20320;&#30340;&#21516;&#20107;&#20877;&#25226;&#24555;&#36882;&#24213;&#21333;&#32473;&#20320;&#12290;
    </p>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     &#36825;&#20010;&#22330;&#26223;&#37324;&#65292;&#20320;&#21644;&#24555;&#36882;&#21592;&#23601;&#26159;&#20004;&#20010;&#19981;&#21516;&#30340;&#32447;&#31243;&#12290;&#32780;&#20320;&#30340;&#21516;&#20107;&#26159; Exchanger&#65292;&#36127;&#36131;&#20320;&#21644;&#24555;&#36882;&#21592;&#38388;&#36827;&#34892;&#29289;&#21697;&#20132;&#25442;&#12290;&#25105;&#20204;&#30475;&#30475;&#20195;&#30721;&#24212;&#35813;&#22914;&#20309;&#32534;&#20889;&#65306;
    </p>
   </div>
   <div class="cl-preview-section">
    <pre class="language-java"><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ExchangerClient</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> InterruptedException <span class="token punctuation">{</span>
        Exchanger<span class="token operator">&lt;</span>String<span class="token operator">&gt;</span> workmate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Exchanger</span><span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        Thread michael <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
            String threadName <span class="token operator">=</span> Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>threadName<span class="token operator">+</span><span class="token string">": I'm Michael and want to delivery a phone to my friend"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>threadName<span class="token operator">+</span><span class="token string">": There is an emergency meeting"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>threadName<span class="token operator">+</span><span class="token string">": I give the phone to my workmate."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>threadName<span class="token operator">+</span><span class="token string">": He will help me to delivery the phone and return the express document to me"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                String expressDocument <span class="token operator">=</span> workmate<span class="token punctuation">.</span><span class="token function">exchange</span><span class="token punctuation">(</span><span class="token string">"---phone---"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>threadName<span class="token operator">+</span><span class="token string">": I got the express document"</span><span class="token operator">+</span> expressDocument<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">"Michael"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        Thread deliveryman <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
            String threadName <span class="token operator">=</span> Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>threadName<span class="token operator">+</span><span class="token string">": I'm a deliveryman"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>threadName<span class="token operator">+</span><span class="token string">": I'm going to get Michael's express from his workmate and give the express document to his workmate"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                String expressGoods <span class="token operator">=</span> workmate<span class="token punctuation">.</span><span class="token function">exchange</span><span class="token punctuation">(</span><span class="token string">"---phone express document----"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>threadName<span class="token operator">+</span><span class="token string">": I got the goods of "</span><span class="token operator">+</span>expressGoods<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">"Deliveryman"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        michael<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        TimeUnit<span class="token punctuation">.</span>MILLISECONDS<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        deliveryman<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     Michael &#36890;&#36807; Exchanger &#30340;&#23454;&#20363; workmate&#65292;&#25226; phone &#20132;&#32473;&#20102;&#24555;&#36882;&#21592;&#12290;&#32780;&#24555;&#36882;&#21592;&#20063;&#36890;&#36807; workmate &#25226;&#24555;&#36882;&#21333;&#25454;&#32473;&#20102; Michael&#12290;&#25105;&#20204;&#30475;&#19968;&#19979;&#36755;&#20986;&#65306;
    </p>
   </div>
   <div class="cl-preview-section">
    <pre><code>Michael: I'm Michael and want to delivery a phone to my friend
Michael: There is an emergency meeting
Michael: I give the phone to my workmate.
Michael: He will help me to delivery and return the express document to me
Deliveryman: I'm a deliveryman
Deliveryman: I'm going to get Michael's express from his workmate and give the express document to his workmate
Deliveryman: I got the goods of ---phone---
Michael: I got the express document---phone express document----
</code></pre>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     &#21487;&#20197;&#30475;&#20986; Michael &#22312;&#35843;&#29992; workmate.exchange("&#8212;phone&#8212;") &#21518;&#34987;&#38459;&#22622;&#12290;&#32780;&#24403; deliveryman &#35843;&#29992; workmate.exchange("&#8212;phone express document&#8212;&#8212;") &#21518;&#65292;&#20004;&#20010;&#32447;&#31243;&#25165;&#32487;&#32493;&#24448;&#19979;&#36208;&#65292;&#24182;&#19988;&#36827;&#34892;&#20102;&#25968;&#25454;&#20132;&#25442;&#12290; Michael &#21457;&#20986;&#20102;&#36135;&#29289; &#8220;&#8212;phone&#8212;&#8221;&#65292;&#24471;&#21040;&#20102; &#8220;&#8212;phone express document----&#8221;&#12290;&#32780; deliveryman &#21017;&#24471;&#21040;&#20102; &#8220;&#8212;phone&#8212;&#8221;&#65292;&#21457;&#20986;&#20102; &#8220;&#8212;phone express document&#8212;&#8212;&#8221;&#12290;
    </p>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     &#20004;&#20010;&#32447;&#31243;&#36890;&#36807; Exchanger &#23454;&#29616;&#20102;&#25968;&#25454;&#30340;&#20132;&#25442;&#12290;
    </p>
   </div>
   <div class="cl-preview-section">
    <h2 id="&#12289;&#22810;&#20110;&#20004;&#20010;&#32447;&#31243;&#20351;&#29992;-exchanger" style="font-size: 30px;">
     2&#12289;&#22810;&#20110;&#20004;&#20010;&#32447;&#31243;&#20351;&#29992; Exchanger
    </h2>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     Exchanger &#25903;&#25345;&#20004;&#20010;&#32447;&#31243;&#25968;&#25454;&#20114;&#25442;&#65292;&#37027;&#20040;&#20320;&#26377;&#27809;&#26377;&#24819;&#36807;&#22810;&#20110;&#20004;&#20010;&#32447;&#31243;&#20351;&#29992; Exchanger &#20570;&#25968;&#25454;&#20132;&#25442;&#20250;&#24590;&#20040;&#26679;&#21602;&#65311;&#25105;&#20204;&#25226;&#19978;&#20080;&#21602;&#20363;&#23376;&#25913;&#19968;&#19979;&#65292;&#20551;&#22914;&#21478;&#22806;&#19968;&#20010;&#21516;&#20107; Green &#20063;&#24819;&#36890;&#36807; workmate &#21327;&#21161;&#21457;&#36865;&#24555;&#36882;&#65292;&#37027;&#20040;&#20250;&#24590;&#20040;&#26679;&#65311;
    </p>
   </div>
   <div class="cl-preview-section">
    <pre class="language-java"><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> InterruptedException <span class="token punctuation">{</span>
    Exchanger<span class="token operator">&lt;</span>String<span class="token operator">&gt;</span> workmate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Exchanger</span><span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    Thread michael <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        String threadName <span class="token operator">=</span> Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>threadName<span class="token operator">+</span><span class="token string">": I'm Michael and want to delivery a phone to my friend"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>threadName<span class="token operator">+</span><span class="token string">": There is an emergency meeting"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>threadName<span class="token operator">+</span><span class="token string">": I give the phone to my workmate."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>threadName<span class="token operator">+</span><span class="token string">": He will help me to delivery the phone and return the express document to me"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            String expressDocument <span class="token operator">=</span> workmate<span class="token punctuation">.</span><span class="token function">exchange</span><span class="token punctuation">(</span><span class="token string">"---phone---"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>threadName<span class="token operator">+</span><span class="token string">": I got the express document"</span><span class="token operator">+</span> expressDocument<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">"Michael"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    Thread green <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        String threadName <span class="token operator">=</span> Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>threadName<span class="token operator">+</span><span class="token string">": I'm green and want to delivery a macbook to my friend"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>threadName<span class="token operator">+</span><span class="token string">": There is an emergency meeting"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>threadName<span class="token operator">+</span><span class="token string">": I give the macbook to my workmate."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>threadName<span class="token operator">+</span><span class="token string">": He will help me to delivery the macbook and return the express document to me"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            String expressDocument <span class="token operator">=</span> workmate<span class="token punctuation">.</span><span class="token function">exchange</span><span class="token punctuation">(</span><span class="token string">"---macbook---"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>threadName<span class="token operator">+</span><span class="token string">": I got the express document"</span><span class="token operator">+</span> expressDocument<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">"Green"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Thread deliveryman <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        String threadName <span class="token operator">=</span> Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>threadName<span class="token operator">+</span><span class="token string">": I'm a deliveryman"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>threadName<span class="token operator">+</span><span class="token string">": I'm going to get Michael's express from his workmate and give the express document to his workmate"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            String expressGoods <span class="token operator">=</span> workmate<span class="token punctuation">.</span><span class="token function">exchange</span><span class="token punctuation">(</span><span class="token string">"---phone express document----"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>threadName<span class="token operator">+</span><span class="token string">": I got the goods of "</span><span class="token operator">+</span>expressGoods<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">"Deliveryman"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    michael<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    TimeUnit<span class="token punctuation">.</span>MILLISECONDS<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    green<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    TimeUnit<span class="token punctuation">.</span>MILLISECONDS<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    deliveryman<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     &#25105;&#20204;&#21152;&#20837; Green &#32447;&#31243;&#65292;&#24182;&#19988;&#22312; Michael &#32447;&#31243;&#21551;&#21160;&#21518;&#65292;&#20808;&#21551;&#21160; Green &#32447;&#31243;&#12290;&#36755;&#20986;&#22914;&#19979;&#65306;
    </p>
   </div>
   <div class="cl-preview-section">
    <pre><code>Michael: I'm Michael and want to delivery a phone to my friend
Michael: There is an emergency meeting
Michael: I give the phone to my workmate.
Michael: He will help me to delivery the phone and return the express document to me
Green: I'm green and want to delivery a macbook to my friend
Green: There is an emergency meeting
Green: I give the macbook to my workmate.
Green: He will help me to delivery the macbook and return the express document to me
Green: I got the express document---phone---
Michael: I got the express document---macbook---
Deliveryman: I'm a deliveryman
Deliveryman: I'm going to get Michael's express from his workmate and give the express document to his workmate
</code></pre>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     &#21487;&#35265; Michael &#21644; Green &#36827;&#34892;&#20102;&#25968;&#25454;&#20132;&#25442;&#65292;&#21452;&#26041;&#37117;&#27809;&#26377;&#21644; Deliveryman &#20570;&#25968;&#25454;&#20132;&#25442;&#12290;&#32467;&#26524;&#26159;&#21452;&#26041;&#30340;&#24555;&#36882;&#37117;&#27809;&#36865;&#21040;&#24555;&#36882;&#21592;&#25163;&#20013;&#65292;&#32780;&#24555;&#36882;&#21592;&#30001;&#20110;&#27809;&#26377;&#25910;&#21040;&#24555;&#36882;&#65292;&#25152;&#20197;&#19968;&#30452;&#34987;&#38459;&#22622;&#20303;&#20102;&#12290;
    </p>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     &#26681;&#25454;&#20197;&#19978;&#23454;&#39564;&#32467;&#26524;&#25105;&#20204;&#24635;&#32467;&#19968;&#19979;&#65306;
    </p>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     1&#12289;Exchanger &#25903;&#25345;&#22810;&#20010;&#32447;&#31243;&#20570;&#25968;&#25454;&#20132;&#25442;&#65307;
    </p>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     2&#12289;&#22810;&#20010;&#32447;&#31243;&#20351;&#29992;&#21516;&#19968;&#20010; Exchanger &#20570;&#25968;&#25454;&#20132;&#25442;&#26102;&#65292;&#32467;&#26524;&#38543;&#26426;&#65292;&#21482;&#35201;&#20945;&#28385;&#19968;&#23545;&#65292;&#23601;&#20250;&#36827;&#34892;&#20132;&#25442;&#12290;
    </p>
   </div>
   <div class="cl-preview-section">
    <h2 id="&#12289;exchanger&#23454;&#29616;&#20998;&#26512;" style="font-size: 30px;">
     3&#12289;Exchanger&#23454;&#29616;&#20998;&#26512;
    </h2>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     Exchanger &#34429;&#28982;&#20351;&#29992;&#36215;&#26469;&#24456;&#31616;&#21333;&#65292;&#20294;&#26159;&#20854;&#28304;&#30721;&#36824;&#26159;&#27604;&#36739;&#22797;&#26434;&#30340;&#12290;&#19979;&#38754;&#25105;&#20204;&#26469;&#20998;&#26512;&#23427;&#23454;&#29616;&#30340;&#21407;&#29702;&#12290;
    </p>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     Exchanger &#31867;&#20013;&#30340;&#27880;&#35299;&#24456;&#35814;&#32454;&#22320;&#38416;&#36848;&#20102;&#20854;&#23454;&#29616;&#21407;&#29702;&#65292;&#24182;&#19988;&#29992;&#19968;&#27573;&#20266;&#20195;&#30721;&#25551;&#36848;&#20102;&#23427;&#30340;&#21407;&#29702;&#65306;
    </p>
   </div>
   <div class="cl-preview-section">
    <pre class="language-java"><code class="prism language-java"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span>slot is empty<span class="token punctuation">)</span> <span class="token punctuation">{</span>                       <span class="token comment">// offer</span>
     place item in a Node<span class="token punctuation">;</span>
     <span class="token keyword">if</span> <span class="token punctuation">(</span>can CAS slot from empty to node<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       wait <span class="token keyword">for</span> release<span class="token punctuation">;</span>
       <span class="token keyword">return</span> matching item in node<span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>can CAS slot from node to empty<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// release</span>
     get the item in node<span class="token punctuation">;</span>
     set matching item in node<span class="token punctuation">;</span>
     release waiting thread<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token comment">// else retry on CAS failure</span>
 <span class="token punctuation">}</span>
</code></pre>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     &#21487;&#20197;&#30475;&#21040; Exhcanger &#20351;&#29992; slot &#20316;&#20026;&#23481;&#22120;&#65292;&#20445;&#23384;&#25968;&#25454; item&#12290;&#24403; A &#32447;&#31243;&#36827;&#20837;&#26102;&#65292;&#22914;&#26524;&#21457;&#29616; slot &#26159;&#31354;&#30340;&#65292;&#21017;&#25226; item &#25918;&#20837; node&#65292;&#28982;&#21518;&#25918;&#20837; slot&#12290;A &#32447;&#31243;&#27492;&#26102;&#24320;&#22987;&#38459;&#22622;&#12290;B &#32447;&#31243;&#36827;&#20837;&#21518;&#21457;&#29616; slot &#19981;&#20026;&#31354;&#65292;&#21017;&#20174; slot &#20013;&#21462;&#20986;node&#65292;&#25226; slot &#32622;&#31354;&#12290;&#27492;&#32447;&#31243;&#20174; node &#20013;&#21462;&#20986;&#25968;&#25454;&#65292;&#24182;&#19988;&#25226;&#33258;&#24049;&#30340;&#25968;&#25454;&#25918;&#20837; node &#20013;&#65292;&#28982;&#21518;&#36890;&#30693;&#38459;&#22622;&#30340;&#32447;&#31243;&#24674;&#22797;&#65292;&#38459;&#22622;&#32447;&#31243;&#24674;&#22797;&#21518;&#20174; node &#20013;&#21462;&#20986;&#25968;&#25454;&#12290;&#20174;&#32780;&#23454;&#29616;&#20102;&#25968;&#25454;&#30340;&#20132;&#25442;&#12290;
    </p>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     Java5 &#30340;&#26102;&#20505;&#65292;&#37319;&#29992;&#30340;&#23601;&#26159;&#36825;&#31181;&#31639;&#27861;&#12290;&#19968;&#33324;&#26469;&#35828;&#27809;&#26377;&#20160;&#20040;&#38382;&#39064;&#12290;&#20294;&#26159;&#24403;&#22823;&#37327;&#24182;&#21457;&#26102;&#65292;&#20250;&#23384;&#22312;&#28608;&#28872;&#30340;&#31454;&#20105;&#12290;&#20110;&#26159;&#22312;Java6 &#24320;&#22987;&#65292;&#21152;&#20837; slot &#25968;&#32452;&#65292;&#35753;&#19981;&#21516;&#32447;&#31243;&#20351;&#29992;&#19981;&#21516;&#30340; slot&#65292;&#25552;&#21319;&#24182;&#21457;&#30340;&#24615;&#33021;&#12290;&#19981;&#36807;&#22312;&#27809;&#26377;&#24182;&#21457;&#30340;&#26102;&#20505;&#36824;&#26159;&#20351;&#29992;&#19968;&#20010; slot &#26469;&#20570;&#20132;&#25442;&#12290;
    </p>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     &#25105;&#20204;&#30475;&#19979;&#26680;&#24515;&#30340; exchange &#26041;&#27861;&#20195;&#30721;&#65306;
    </p>
   </div>
   <div class="cl-preview-section">
    <pre class="language-java"><code class="prism language-java"><span class="token keyword">public</span> V <span class="token function">exchange</span><span class="token punctuation">(</span>V x<span class="token punctuation">)</span> <span class="token keyword">throws</span> InterruptedException <span class="token punctuation">{</span>
    Object v<span class="token punctuation">;</span>
    Object item <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token operator">?</span> NULL_ITEM <span class="token operator">:</span> x<span class="token punctuation">;</span> <span class="token comment">// translate null args</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>arena <span class="token operator">!=</span> null <span class="token operator">||</span>
         <span class="token punctuation">(</span>v <span class="token operator">=</span> <span class="token function">slotExchange</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> 0L<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
        <span class="token punctuation">(</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">interrupted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token comment">// disambiguates null return</span>
          <span class="token punctuation">(</span>v <span class="token operator">=</span> <span class="token function">arenaExchange</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> 0L<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> null<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">InterruptedException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>v <span class="token operator">==</span> NULL_ITEM<span class="token punctuation">)</span> <span class="token operator">?</span> null <span class="token operator">:</span> <span class="token punctuation">(</span>V<span class="token punctuation">)</span>v<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     arena &#20026; slot &#25968;&#32452;&#12290;&#21487;&#20197;&#30475;&#21040; arena &#20026; null &#26102;&#65292;&#36824;&#26159;&#20351;&#29992;&#30340; slot &#20132;&#25442;&#31639;&#27861; slotExchange&#12290;&#22914;&#26524; arena &#19981;&#20026; null&#36827;&#20837; if &#30340; &amp;&amp; &#30340;&#31532;&#20108;&#20010;&#26465;&#20214;&#21028;&#26029;&#12290;&#22312;&#21028;&#26029;&#20013;&#25191;&#34892;&#20102; arenaExchange&#65292;&#27492;&#26102;&#36890;&#36807; arena &#20063;&#23601;&#26159; slot &#25968;&#32452;&#23436;&#25104;&#20132;&#25442;&#12290;
    </p>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     &#20855;&#20307;&#30340;&#31639;&#27861;&#19981;&#20877;&#35814;&#36848;&#65292;&#21644;&#19978;&#38754;&#20266;&#20195;&#30721;&#30340;&#24605;&#24819;&#26159;&#19968;&#33268;&#30340;&#12290;
    </p>
   </div>
   <div class="cl-preview-section">
    <h2 id="&#12289;&#24635;&#32467;" style="font-size: 30px;">
     4&#12289;&#24635;&#32467;
    </h2>
   </div>
   <div class="cl-preview-section">
    <p style="font-size: 20px; line-height: 38px;">
     Exchanger &#22312;&#25105;&#20204;&#23454;&#38469;&#24320;&#21457;&#20013;&#20351;&#29992;&#19981;&#22810;&#65292;&#20294;&#26159;&#25105;&#20204;&#20063;&#24212;&#35813;&#20102;&#35299;&#20854;&#29992;&#27861;&#21644;&#21407;&#29702;&#65292;&#20197;&#20415;&#22312;&#21512;&#36866;&#22330;&#26223;&#20986;&#29616;&#26102;&#65292;&#25105;&#20204;&#33021;&#35782;&#21035;&#20986;&#24212;&#35813;&#37319;&#29992; Exchanger&#12290;&#22312; Exchanger &#31867;&#30340;&#27880;&#35299;&#20013;&#65292;&#21487;&#20197;&#30475;&#21040;&#23427;&#36866;&#29992;&#20110;&#22522;&#22240;&#31639;&#27861;&#12290;&#22240;&#20026;&#19981;&#21516;&#22522;&#22240;&#30340;&#25645;&#37197;&#27979;&#35797;&#23601;&#24212;&#35813;&#26159;&#38543;&#26426;&#36827;&#34892;&#20132;&#25442;&#30340;&#12290;&#27492;&#22806;&#36824;&#36866;&#29992;&#20110;&#31649;&#36947;&#30340;&#35774;&#35745;&#65288;pipeline design&#65289;&#65292;&#35753;&#25968;&#25454;&#22312;&#31649;&#36947;&#20013;&#20570;&#20132;&#25442;&#12290;
    </p>
   </div>
   }
  </div>
 </div>
 <!-- &#20080;&#36807;&#30340;&#38405;&#35835; -->
 <div class="art-next-prev clearfix">
  <!-- &#24050;&#20080;&#19988;&#24320;&#25918; &#25110;&#32773;&#21487;&#20197;&#35797;&#35835; -->
  <a href="/read/49/article/962">
   <div class="prev l clearfix">
    <div class="icon l">
     <i class="imv2-arrow3_l">
     </i>
    </div>
    <p>
     28 &#20154;&#40784;&#20102;&#65292;&#19968;&#36215;&#34892;&#21160;&#8212;CyclicBarrier&#35814;&#35299;
    </p>
   </div>
  </a>
  <!-- &#24050;&#20080;&#19988;&#24320;&#25918; &#25110;&#32773;&#21487;&#20197;&#35797;&#35835; -->
  <a href="/read/49/article/964">
   <div class="next r clearfix">
    <p>
     30 &#38480;&#37327;&#20379;&#24212;&#65292;&#19981;&#22909;&#24847;&#24605;&#24744;&#26469;&#26202;&#20102;&#8212;Semaphore&#35814;&#35299;
    </p>
    <div class="icon r">
     <i class="imv2-arrow3_r">
     </i>
    </div>
   </div>
  </a>
 </div>
</div>

</div>

</div>
</div>

        </body>
        
        