<div><div class="markdown-body">
    <h1>&#19987;&#39064;&#24335;&#35762;&#35299; &#8212;&#8212; XA&#20107;&#21153;&#19982;&#20004;&#38454;&#27573;&#25552;&#20132;</h1>

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" href="style/style.css" type="text/css">

<div class="markdown-body">
    <h1>
 XA&#20107;&#21153;&#19982;&#20004;&#38454;&#27573;&#25552;&#20132;
</h1>
<p>
 &#26631;&#31614;&#65306; MySQL&#26159;&#24590;&#26679;&#36816;&#34892;&#30340;
</p>
<hr>
<h2>
 &#20160;&#20040;&#26159;&#20998;&#24067;&#24335;&#20107;&#21153;
</h2>
<p>
 &#25105;&#20204;&#24179;&#24120;&#20351;&#29992;&#20107;&#21153;&#30340;&#26102;&#20505;&#65292;&#22522;&#26412;&#27969;&#31243;&#26159;&#36825;&#26679;&#30340;&#65306;
</p>
<ul>
 <li>
  &#20351;&#29992;
  <code>
   BEGIN/START TRANSACTION
  </code>
  &#26469;&#24320;&#21551;&#19968;&#20010;&#20107;&#21153;&#12290;
 </li>
 <li>
  &#28982;&#21518;&#21487;&#20197;&#32487;&#32493;&#21521;&#26381;&#21153;&#22120;&#21457;&#36865;&#19968;&#20123;&#22686;&#21024;&#25913;&#26597;&#35821;&#21477;&#65292;&#36825;&#20123;&#35821;&#21477;&#37117;&#23646;&#20110;&#36825;&#20010;&#20107;&#21153;&#30340;&#19968;&#37096;&#20998;&#12290;
 </li>
 <li>
  &#20043;&#21518;&#21487;&#20197;&#21521;&#26381;&#21153;&#22120;&#21457;&#36865;
  <code>
   COMMIT
  </code>
  &#35821;&#21477;&#26469;&#34920;&#26126;&#36825;&#20010;&#20107;&#21153;&#30340;&#25152;&#26377;&#35821;&#21477;&#37117;&#24050;&#32463;&#21457;&#36865;&#23436;&#20102;&#65292;&#26381;&#21153;&#22120;&#21487;&#20197;&#25552;&#20132;&#36825;&#20010;&#20107;&#21153;&#20102;&#12290;
 </li>
</ul>
<blockquote>
 <p>
  &#23567;&#36148;&#22763;&#65306;
  <br>
  <br>
  &#22914;&#26524;auto_commit&#31995;&#32479;&#21464;&#37327;&#20540;&#20026;1&#65292;&#24182;&#19988;&#25105;&#20204;&#26410;&#26174;&#24335;&#20351;&#29992;BEGIN/START TRANSACTION&#24320;&#21551;&#20107;&#21153;&#65292;&#37027;MySQL&#20063;&#20250;&#23558;&#21333;&#26465;&#35821;&#21477;&#24403;&#20316;&#26159;&#19968;&#20010;&#20107;&#21153;&#26469;&#25191;&#34892;&#12290;
 </p>
</blockquote>
<p>
 &#25105;&#20204;&#30693;&#36947;MySQL&#20998;&#20026;server&#23618;&#21644;&#23384;&#20648;&#24341;&#25806;&#23618;&#65292;&#32780;
 <strong>
  &#20107;&#21153;&#20855;&#20307;&#26159;&#22312;&#23384;&#20648;&#24341;&#25806;&#23618;&#23454;&#29616;&#30340;
 </strong>
 &#12290;&#26377;&#30340;&#23384;&#20648;&#24341;&#25806;&#25903;&#25345;&#20107;&#21153;&#65292;&#26377;&#30340;&#19981;&#25903;&#25345;&#12290;
</p>
<p>
 &#23545;&#20110;&#25903;&#25345;&#20107;&#21153;&#30340;&#23384;&#20648;&#24341;&#25806;&#26469;&#35828;&#65292;&#23427;&#20204;&#25552;&#20379;&#20102;&#30456;&#24212;&#30340;&#24320;&#21551;&#20107;&#21153;&#12289;&#25552;&#20132;&#20107;&#21153;&#30340;&#25509;&#21475;&#12290;server&#23618;&#21482;&#38656;&#35201;&#35843;&#29992;&#36825;&#20123;&#25509;&#21475;&#65292;&#26469;&#35753;&#23384;&#20648;&#24341;&#25806;&#25191;&#34892;&#20107;&#21153;&#12290;
</p>
<p>
 &#38500;&#20102;MySQL&#33258;&#24102;&#30340;&#25903;&#25345;&#20107;&#21153;&#30340;&#23384;&#20648;&#24341;&#25806;InnoDB&#22806;&#65292;&#20854;&#20182;&#19968;&#20123;&#20844;&#21496;&#20063;&#20026;MySQL&#24320;&#21457;&#20102;&#19968;&#20123;&#25903;&#25345;&#20107;&#21153;&#30340;&#23384;&#20648;&#24341;&#25806;&#65292;&#27604;&#26041;&#35828;&#38463;&#37324;&#30340;XEngine&#65292;Facebook&#30340;Rocksdb&#31561;&#12290;
</p>
<p>
 &#22312;&#20070;&#20889;&#21253;&#21547;&#22312;&#19968;&#20010;&#20107;&#21153;&#20013;&#30340;&#35821;&#21477;&#26102;&#65292;&#19981;&#21516;&#35821;&#21477;&#21487;&#33021;&#20250;&#28041;&#21450;&#19981;&#21516;&#23384;&#20648;&#24341;&#25806;&#30340;&#34920;&#65292;&#36825;&#26102;&#22914;&#26524;&#25105;&#20204;&#24819;&#20445;&#25345;&#25972;&#20010;&#20107;&#21153;&#35201;&#20040;&#20840;&#37096;&#25191;&#34892;&#65292;&#35201;&#20040;&#20840;&#37096;&#19981;&#25191;&#34892;&#30340;&#35805;&#65292;&#26412;&#36136;&#19978;&#23601;&#38656;&#35201;&#20445;&#35777;&#21508;&#20010;&#23384;&#20648;&#24341;&#25806;&#30340;&#20107;&#21153;&#20840;&#37096;&#25552;&#20132;&#65292;&#25110;&#32773;&#20840;&#37096;&#22238;&#28378;&#12290;&#19981;&#33021;&#23384;&#22312;&#26576;&#20123;&#23384;&#20648;&#24341;&#25806;&#20107;&#21153;&#25552;&#20132;&#20102;&#65292;&#26576;&#20123;&#23384;&#20648;&#24341;&#25806;&#20107;&#21153;&#22238;&#28378;&#20102;&#30340;&#24773;&#20917;&#12290;
</p>
<p>
 &#31245;&#24494;&#24635;&#32467;&#19968;&#19979;&#23601;&#26159;&#65306;&#25105;&#20204;&#26377;&#19968;&#20010;&#22823;&#30340;&#20107;&#21153;&#65292;&#25105;&#20204;&#21487;&#20197;&#31216;&#20854;&#20026;
 <code>
  &#20840;&#23616;&#20107;&#21153;
 </code>
 &#65292;&#36825;&#20010;&#20840;&#23616;&#20107;&#21153;&#30001;&#33509;&#24178;&#30340;&#23567;&#30340;&#20107;&#21153;&#32452;&#25104;&#12290;&#35201;&#23454;&#29616;&#36825;&#20010;&#22823;&#30340;&#20107;&#21153;&#65292;&#23601;&#24517;&#39035;&#35753;&#23427;&#23545;&#24212;&#30340;&#33509;&#24178;&#20010;&#23567;&#30340;&#20107;&#21153;&#20840;&#37096;&#23436;&#25104;&#65292;&#25110;&#32773;&#20840;&#37096;&#22238;&#28378;&#12290;&#25105;&#20204;&#20063;&#21487;&#20197;&#25226;&#36825;&#20010;&#22823;&#30340;&#20840;&#23616;&#20107;&#21153;&#31216;&#20316;
 <code>
  &#20998;&#24067;&#24335;&#20107;&#21153;
 </code>
 &#12290;
</p>
<p>
 &#38500;&#20102;&#19978;&#36848;&#28041;&#21450;&#22810;&#20010;&#23384;&#20648;&#24341;&#25806;&#30340;&#20840;&#23616;&#20107;&#21153;&#20043;&#22806;&#65292;
 <code>
  &#20998;&#24067;&#24335;&#20107;&#21153;
 </code>
 &#36824;&#26377;&#26356;&#22810;&#30340;&#24212;&#29992;&#22330;&#26223;&#12290;&#27604;&#26041;&#35828;&#25105;&#20204;&#30340;&#25968;&#25454;&#20998;&#24067;&#22312;&#22810;&#20010;MySQL&#26381;&#21153;&#22120;&#20013;&#65307;&#29978;&#33267;&#26377;&#30340;&#25968;&#25454;&#20998;&#24067;&#22312;MySQL&#26381;&#21153;&#22120;&#20013;&#65292;&#26377;&#30340;&#25968;&#25454;&#20998;&#24067;&#22312;Oracle&#26381;&#21153;&#22120;&#20013;&#65307;&#29978;&#33267;&#26377;&#20123;&#26381;&#21153;&#22120;&#22312;&#20013;&#22269;&#65292;&#26377;&#20123;&#26381;&#21153;&#22120;&#22312;&#32654;&#22269;&#12290;&#25105;&#20204;&#24819;&#23436;&#25104;&#19968;&#20010;&#25805;&#20316;&#65292;&#36825;&#20010;&#25805;&#20316;&#20250;&#26356;&#26032;&#22810;&#20010;&#31995;&#32479;&#37324;&#30340;&#25968;&#25454;&#65292;&#27492;&#26102;&#22914;&#26524;&#25105;&#20204;&#24819;&#35753;&#36825;&#20010;&#25805;&#20316;&#20855;&#26377;&#21407;&#23376;&#24615;&#65292;&#23601;&#38656;&#35201;&#20445;&#35777;&#35753;&#21508;&#20010;&#31995;&#32479;&#20013;&#30340;&#23567;&#20107;&#21153;&#35201;&#20040;&#20840;&#37096;&#25552;&#20132;&#65292;&#35201;&#20040;&#20840;&#37096;&#22238;&#28378;&#12290;&#36825;&#26102;&#30340;&#36825;&#20010;&#36328;&#22810;&#20010;&#31995;&#32479;&#30340;&#25805;&#20316;&#20063;&#21487;&#20197;&#34987;&#31216;&#20316;
 <code>
  &#20998;&#24067;&#24335;&#20107;&#21153;
 </code>
 &#12290;
</p>
<p>
 &#36328;&#34892;&#36716;&#36134;&#26159;&#19968;&#20010;&#20856;&#22411;&#30340;&#20998;&#24067;&#24335;&#20107;&#21153;&#30340;&#23454;&#20363;&#12290;&#21508;&#20010;&#38134;&#34892;&#37117;&#26377;&#33258;&#24049;&#30340;&#26381;&#21153;&#65292;&#22914;&#26524;&#29399;&#21733;&#22312;&#25307;&#21830;&#38134;&#34892;&#23384;&#20102;10&#22359;&#38065;&#65292;&#20182;&#24819;&#25226;&#36825;10&#22359;&#38065;&#36716;&#32473;&#29483;&#29239;&#22312;&#24314;&#35774;&#38134;&#34892;&#30340;&#36134;&#25143;&#65292;&#37027;&#20040;&#25307;&#21830;&#38134;&#34892;&#20808;&#24471;&#32473;&#29399;&#21733;&#36134;&#25143;&#25187;10&#22359;&#65292;&#28982;&#21518;&#24314;&#35774;&#38134;&#34892;&#32473;&#29483;&#29239;&#36134;&#25143;&#22686;10&#22359;&#12290;&#32780;&#25307;&#21830;&#38134;&#34892;&#21644;&#24314;&#35774;&#38134;&#34892;&#26681;&#26412;&#23601;&#19981;&#26159;&#19968;&#20010;&#31995;&#32479;&#65292;&#25307;&#21830;&#38134;&#34892;&#32473;&#29399;&#21733;&#25187;&#38065;&#30340;&#19994;&#21153;&#25918;&#21040;&#20102;&#33258;&#24049;&#30340;&#19968;&#20010;&#20107;&#21153;&#37324;&#65292;&#24314;&#35774;&#38134;&#34892;&#32473;&#29483;&#29239;&#21152;&#38065;&#30340;&#19994;&#21153;&#25918;&#21040;&#20102;&#33258;&#24049;&#30340;&#19968;&#20010;&#20107;&#21153;&#37324;&#65292;&#36825;&#20004;&#20010;&#20107;&#21153;&#20854;&#23454;&#22312;&#21508;&#33258;&#30340;&#31995;&#32479;&#20013;&#24182;&#27809;&#26377;&#20160;&#20040;&#20851;&#31995;&#65292;&#23436;&#20840;&#26377;&#21487;&#33021;&#25307;&#21830;&#38134;&#34892;&#30340;&#20107;&#21153;&#25552;&#20132;&#20102;&#65292;&#32780;&#24314;&#35774;&#38134;&#34892;&#30340;&#20107;&#21153;&#30001;&#20110;&#31995;&#32479;&#23445;&#26426;&#32780;&#22833;&#36133;&#20102;&#65292;&#36825;&#23601;&#23548;&#33268;&#29399;&#21733;&#25187;&#20102;&#38065;&#65292;&#21364;&#27809;&#26377;&#36716;&#32473;&#29483;&#29239;&#30340;&#24808;&#21095;&#21457;&#29983;&#12290;&#25152;&#20197;&#25105;&#20204;&#24517;&#39035;&#24341;&#20837;&#19968;&#20123;&#26426;&#21046;&#65292;&#26469;&#23454;&#29616;
 <code>
  &#20998;&#24067;&#24335;&#20107;&#21153;
 </code>
 &#12290;
</p>
<h2>
 XA&#35268;&#33539;
</h2>
<p>
 &#26377;&#19968;&#20010;&#21517;&#21483;
 <code>
  X/Open
 </code>
 &#65288;&#36825;&#21517;&#20799;&#21548;&#30528;&#23601;&#25402;&#38712;&#27668;&#65289;&#30340;&#32452;&#32455;&#25552;&#20986;&#20102;&#19968;&#20010;&#21517;&#20026;
 <code>
  XA
 </code>
 &#30340;&#35268;&#33539;&#12290;
</p>
<blockquote>
 <p>
  &#23567;&#36148;&#22763;&#65306;
  <br>
  <br>
  &#20026;&#33410;&#30465;&#21516;&#24535;&#20204;&#21435;&#25628;&#32034;&#36825;&#20221;&#35268;&#33539;&#30340;&#23453;&#36149;&#26102;&#38388;&#65292;&#22823;&#23478;&#22312;&#8220;&#25105;&#20204;&#37117;&#26159;&#23567;&#38738;&#34521;&#8221;&#20844;&#20247;&#21495;&#36755;&#20837;&#8220;XA&#8221;&#21363;&#21487;&#19979;&#36733;&#35813;&#35268;&#33539;&#12290;
 </p>
</blockquote>
<p>
 &#26377;&#20154;&#35828;
 <code>
  XA
 </code>
 &#30340;&#21547;&#20041;&#26159;
 <code>
  Extended Architecture
 </code>
 &#12290;&#20196;&#20154;&#36855;&#24785;&#30340;&#26159;&#65292;&#25105;&#31455;&#28982;&#27809;&#22312;&#19978;&#36848;&#35268;&#33539;&#20013;&#25214;&#21040;
 <code>
  XA
 </code>
 &#21040;&#24213;&#26159;&#20010;&#21861;&#24847;&#24605;&#65288;&#24456;&#23604;&#23596;&#65289;&#65292;&#22823;&#23478;&#25226;&#23427;&#29702;&#35299;&#25104;&#19968;&#20010;&#21517;&#23383;&#23601;&#22909;&#20102;&#65292;&#20854;&#23454;&#21483;&#25104;
 <code>
  &#29579;&#23612;&#29595;
 </code>
 &#20063;&#27809;&#21861;&#38382;&#39064;&#12290;
</p>
<p>
 &#36825;&#20010;XA&#35268;&#33539;&#25552;&#20986;&#20102;2&#20010;&#35282;&#33394;&#65306;
</p>
<ul>
 <li>
  &#19968;&#20010;&#20840;&#23616;&#20107;&#21153;&#30001;&#22810;&#20010;&#23567;&#30340;&#20107;&#21153;&#32452;&#25104;&#65292;&#25152;&#20197;&#25105;&#20204;&#24471;&#22312;&#26576;&#20010;&#22320;&#26041;&#25214;&#19968;&#20010;&#24635;&#25597;&#20840;&#23616;&#30340;&#23478;&#20249;&#65292;&#36825;&#20010;&#23478;&#20249;&#29992;&#20110;&#21644;&#21508;&#20010;&#23567;&#20107;&#21153;&#36827;&#34892;&#27807;&#36890;&#65292;&#25351;&#23548;&#23427;&#20204;&#26159;&#25552;&#20132;&#36824;&#26159;&#22238;&#28378;&#12290;&#36825;&#20010;&#23478;&#20249;&#34987;&#31216;&#20316;&#20107;&#21153;&#21327;&#35843;&#22120;&#65288;Transaction Coordinator&#65289;&#25110;&#32773;&#36164;&#28304;&#31649;&#29702;&#22120;&#65288;Resource Manager&#65289;&#12290;
 </li>
</ul>
<p>
 &#19981;&#35770;&#26159;
 <code>
  &#20107;&#21153;&#21327;&#35843;&#22120;
 </code>
 &#65292;&#36824;&#26159;
 <code>
  &#36164;&#28304;&#31649;&#29702;&#22120;
 </code>
 &#36825;&#26679;&#30340;&#21517;&#23383;&#24565;&#36215;&#26469;&#37117;&#27604;&#36739;&#25303;&#21475;&#65292;&#26377;&#20652;&#30496;&#21151;&#25928;&#65292;&#25105;&#20204;&#21518;&#32493;&#23601;&#25226;
 <code>
  &#20107;&#21153;&#21327;&#35843;&#22120;
 </code>
 &#25110;&#32773;
 <code>
  &#36164;&#28304;&#31649;&#29702;&#22120;
 </code>
 &#31216;&#20316;
 <code>
  &#22823;&#21733;
 </code>
 &#20102;&#21704;&#12290;
</p>
<ul>
 <li>
  &#31649;&#29702;&#19968;&#20010;&#23567;&#20107;&#21153;&#30340;&#23478;&#20249;&#34987;&#31216;&#20316;&#20107;&#21153;&#31649;&#29702;&#22120;&#65288;Transaction Manager&#65289;&#12290;
 </li>
</ul>
<p>
 <code>
  &#20107;&#21153;&#31649;&#29702;&#22120;
 </code>
 &#24565;&#36215;&#26469;&#20063;&#27604;&#36739;&#25303;&#21475;&#65292;&#25105;&#20204;&#23601;&#25226;&#23427;&#31216;&#20316;
 <code>
  &#23567;&#24351;
 </code>
 &#20102;&#21704;&#12290;
</p>
<p>
 &#35201;&#25552;&#20132;&#19968;&#20010;&#20840;&#23616;&#20107;&#21153;&#65292;&#37027;&#20040;&#23646;&#20110;&#35813;&#20840;&#23616;&#20107;&#21153;&#30340;&#33509;&#24178;&#20010;&#23567;&#20107;&#21153;&#23601;&#24212;&#35813;&#20840;&#37096;&#25552;&#20132;&#65292;&#21482;&#35201;&#26377;&#20219;&#20309;&#19968;&#20010;&#23567;&#20107;&#21153;&#26080;&#27861;&#25552;&#20132;&#65292;&#37027;&#20040;&#25972;&#20010;&#20840;&#23616;&#20107;&#21153;&#23601;&#24212;&#35813;&#20840;&#37096;&#22238;&#28378;&#12290;&#25152;&#20197;&#27492;&#26102;
 <code>
  &#22823;&#21733;
 </code>
 &#19981;&#33021;&#35753;&#21508;&#20010;
 <code>
  &#23567;&#24351;
 </code>
 &#36880;&#20010;&#25552;&#20132;&#65292;&#22240;&#20026;&#19981;&#33021;&#20445;&#35777;&#21518;&#38754;&#25552;&#20132;&#30340;
 <code>
  &#23567;&#24351;
 </code>
 &#26159;&#21542;&#21487;&#33021;&#21457;&#29983;&#38169;&#35823;&#12290;&#27492;&#26102;XA&#35268;&#33539;&#20013;&#25351;&#20986;&#65292;&#35201;&#25552;&#20132;&#19968;&#20010;&#20840;&#23616;&#20107;&#21153;&#65292;&#24517;&#39035;&#20998;&#20026;2&#27493;&#65306;
</p>
<ul>
 <li>
  <p>
   Prepare&#38454;&#27573;&#65306;&#24403;
   <code>
    &#22823;&#21733;
   </code>
   &#20934;&#22791;&#25552;&#20132;&#19968;&#20010;&#20840;&#23616;&#20107;&#21153;&#26102;&#65292;&#20250;&#20381;&#27425;&#36890;&#30693;&#21508;&#20010;
   <code>
    &#23567;&#24351;
   </code>
   &#35828;&#65306;&#8220;&#29616;&#22312;&#20107;&#21153;&#20013;&#30340;&#35821;&#21477;&#37117;&#24050;&#32463;&#25191;&#34892;&#23436;&#20102;&#65292;&#25105;&#20204;&#20934;&#22791;&#25552;&#20132;&#20102;&#65292;&#20320;&#36825;&#37324;&#26377;&#27809;&#26377;&#20160;&#20040;&#38382;&#39064;&#65311;&#8221;&#12290;&#22914;&#26524;
   <code>
    &#23567;&#24351;
   </code>
   &#35273;&#24471;&#33258;&#24049;&#27809;&#26377;&#38382;&#39064;&#65292;&#23601;&#25226;&#22312;&#20107;&#21153;&#25191;&#34892;&#36807;&#31243;&#20013;&#25152;&#20135;&#29983;&#30340;redo&#26085;&#24535;&#37117;&#21047;&#26032;&#21040;&#30828;&#30424;&#65292;&#28982;&#21518;&#23545;
   <code>
    &#22823;&#21733;
   </code>
   &#35828;&#65306;&#8220;&#27809;&#26377;&#38382;&#39064;&#8221;&#12290;&#22914;&#26524;
   <code>
    &#23567;&#24351;
   </code>
   &#36935;&#21040;&#20102;&#21861;&#31361;&#21457;&#24773;&#20917;&#19981;&#33021;&#25552;&#20132;&#65288;&#27604;&#26041;&#35828;&#30913;&#30424;&#28385;&#20102;&#65292;&#19981;&#33021;&#20889;redo&#20102;&#65289;&#65292;&#23601;&#23545;&#22823;&#21733;&#35828;&#65306;&#8220;&#19981;&#34892;&#65292;&#25552;&#20132;&#19981;&#20102;&#20102;&#8221;&#12290;
  </p>
 </li>
 <li>
  <p>
   Commit&#38454;&#27573;&#65306;&#22914;&#26524;&#22312;Prepare&#38454;&#27573;&#21508;&#20010;
   <code>
    &#23567;&#24351;
   </code>
   &#32473;
   <code>
    &#22823;&#21733;
   </code>
   &#30340;&#31572;&#22797;&#37117;&#26159;:&#8220;OK&#65292;&#26408;&#26377;&#38382;&#39064;&#8221;&#65292;&#37027;
   <code>
    &#22823;&#21733;
   </code>
   &#23601;&#35201;&#30495;&#27491;&#36890;&#30693;&#21508;&#20010;&#23567;&#24351;&#21435;&#25552;&#20132;&#20107;&#21153;&#20102;&#12290;&#22914;&#26524;&#22312;Prepare&#38454;&#27573;&#26576;&#20010;
   <code>
    &#23567;&#24351;
   </code>
   &#32473;
   <code>
    &#22823;&#21733;
   </code>
   &#30340;&#22238;&#22797;&#26159;&#65306;&#8220;NO&#65292;&#20570;&#19981;&#20102;&#8221;&#65292;&#37027;
   <code>
    &#22823;&#21733;
   </code>
   &#23601;&#24471;&#36890;&#30693;&#25152;&#26377;
   <code>
    &#23567;&#24351;
   </code>
   &#65306;&#8220;&#36935;&#21040;&#31361;&#21457;&#24773;&#20917;&#65292;&#25152;&#26377;&#20154;&#31435;&#21363;&#22238;&#28378;&#8221;&#12290;
   <code>
    &#23567;&#24351;
   </code>
   &#25910;&#21040;&#36890;&#30693;&#20415;&#37117;&#22238;&#28378;&#20102;&#12290;
   <strong>
    &#19981;&#36807;&#22312;
    <code>
     &#22823;&#21733;
    </code>
    &#36890;&#30693;&#21508;&#20010;
    <code>
     &#23567;&#24351;
    </code>
    &#26159;&#35201;&#25552;&#20132;&#20043;&#21069;&#65292;&#37117;&#38656;&#22312;&#26576;&#20010;&#22320;&#26041;&#35760;&#24405;&#19968;&#19979;&#36825;&#20010;&#20840;&#23616;&#20107;&#21153;&#24050;&#32463;&#25552;&#20132;&#65292;&#20197;&#21450;&#21508;&#20010;&#23567;&#24351;&#37117;&#26159;&#20160;&#20040;&#30340;&#20449;&#24687;&#12290;
   </strong>
  </p>
 </li>
</ul>
<p>
 XA&#35268;&#33539;&#25226;&#19978;&#36848;&#20840;&#23616;&#20107;&#21153;&#25552;&#20132;&#26102;&#25152;&#32463;&#21382;&#30340;&#20004;&#20010;&#38454;&#27573;&#31216;&#20316;
 <code>
  &#20004;&#38454;&#27573;&#25552;&#20132;
 </code>
 &#12290;
</p>
<blockquote>
 <p>
  &#23567;&#36148;&#22763;&#65306;
  <br>
  <br>
  &#22914;&#26524;&#19968;&#20010;&#20840;&#23616;&#20107;&#21153;&#20165;&#21253;&#21547;&#19968;&#20010;
  <code>
   &#23567;&#24351;
  </code>
  &#30340;&#35805;&#65292;&#37027;&#20004;&#38454;&#27573;&#25552;&#20132;&#21487;&#20197;&#36864;&#21270;&#25104;1&#38454;&#27573;&#25552;&#20132;&#12290;
 </p>
</blockquote>
<p>
 &#22823;&#23478;&#21487;&#20197;&#30475;&#21040;&#65292;XA&#35268;&#33539;&#24341;&#20837;&#20102;&#19968;&#20010;&#22312;&#20107;&#21153;&#25552;&#20132;&#26102;&#30340;
 <code>
  Prepare&#38454;&#27573;
 </code>
 &#65292;&#36825;&#20010;&#38454;&#27573;&#23601;&#26159;&#35753;&#21508;&#20010;&#20107;&#21153;&#20570;&#22909;&#25552;&#20132;&#21069;&#30340;&#20934;&#22791;&#65292;&#20855;&#20307;&#23601;&#26159;&#25226;&#35821;&#21477;&#25191;&#34892;&#36807;&#31243;&#20013;&#20135;&#29983;&#30340;redo&#26085;&#24535;&#37117;&#21047;&#30424;&#12290;&#22914;&#26524;&#35821;&#21477;&#25191;&#34892;&#36807;&#31243;&#20013;&#30340;redo&#26085;&#24535;&#37117;&#21047;&#30424;&#20102;&#65292;&#37027;&#20040;&#21363;&#20351;&#20043;&#21518;&#31995;&#32479;&#23849;&#28291;&#65292;&#37027;&#20040;&#22312;&#37325;&#21551;&#30340;&#26102;&#20505;&#36824;&#26159;&#21487;&#20197;&#24674;&#22797;&#21040;&#35813;&#20107;&#21153;&#21508;&#20010;&#35821;&#21477;&#37117;&#25191;&#34892;&#23436;&#30340;&#26679;&#23376;&#12290;
</p>
<p>
 &#36825;&#26679;&#30340;&#35805;&#65292;&#22312;Prepare&#38454;&#27573;&#32467;&#26463;&#21518;&#65292;&#21363;&#20351;&#26576;&#20010;&#23567;&#24351;&#22240;&#20026;&#26576;&#20123;&#21407;&#22240;&#32780;&#23849;&#28291;&#65292;&#22312;&#20043;&#21518;&#37325;&#21551;&#24674;&#22797;&#26102;&#65292;&#20063;&#21487;&#20197;&#25226;&#33258;&#24049;&#20877;&#27425;&#24674;&#22797;&#25104;
 <code>
  Prepare
 </code>
 &#29366;&#24577;&#12290;
 <strong>
  &#22312;&#23849;&#28291;&#24674;&#22797;&#32467;&#26463;&#21518;&#65292;&#22823;&#21733;&#21487;&#20197;&#32487;&#32493;&#35753;&#23567;&#24351;&#25552;&#20132;&#25110;&#32773;&#22238;&#28378;&#12290;
 </strong>
</p>
<p>
 &#20197;&#19978;&#23601;&#26159;XA&#35268;&#33539;&#30340;&#26680;&#24515;&#20869;&#23481;&#65292;&#19979;&#36793;&#21487;&#20197;&#26469;&#21792;&#21480;&#19968;&#19979;MySQL&#23545;&#19978;&#36848;XA&#35268;&#33539;&#30340;&#23454;&#29616;&#20102;&#12290;
</p>
<h2>
 MySQL&#20013;&#30340;XA&#20107;&#21153;
</h2>
<p>
 MySQL&#20013;&#30340;XA&#20107;&#21153;&#20998;&#20026;
 <code>
  &#22806;&#37096;XA
 </code>
 &#21644;
 <code>
  &#20869;&#37096;XA
 </code>
 &#65292;&#25105;&#20204;&#20998;&#21035;&#26469;&#30475;&#19968;&#19979;&#12290;
</p>
<h3>
 &#22806;&#37096;XA
</h3>
<p>
 &#22312;MySQL&#30340;
 <code>
  &#22806;&#37096;XA
 </code>
 &#23454;&#29616;&#20013;&#65292;MySQL&#26381;&#21153;&#22120;&#20805;&#24403;
 <code>
  &#23567;&#24351;
 </code>
 &#65292;&#32780;&#36830;&#25509;&#26381;&#21153;&#22120;&#30340;&#23458;&#25143;&#31471;&#31243;&#24207;&#20805;&#24403;
 <code>
  &#22823;&#21733;
 </code>
 &#12290;
</p>
<p>
 &#19982;&#20351;&#29992;
 <code>
  BEGIN
 </code>
 &#35821;&#21477;&#24320;&#21551;&#65292;&#20351;&#29992;
 <code>
  COMMIT
 </code>
 &#25552;&#20132;&#30340;&#24120;&#35268;&#20107;&#21153;&#19981;&#21516;&#65292;&#22914;&#26524;&#25105;&#20204;&#24819;&#22312;MySQL&#20013;&#20351;&#29992;XA&#20107;&#21153;&#65292;&#38656;&#35201;&#19968;&#20123;&#29305;&#27530;&#30340;&#35821;&#21477;&#65306;
</p>
<ul>
 <li>
  <code>
   XA {START|BEGIN} xid
  </code>
  &#65306;&#35813;&#35821;&#21477;&#29992;&#20110;&#24320;&#21551;&#19968;&#20010;XA&#20107;&#21153;&#65292;&#27492;&#26102;&#35813;XA&#20107;&#21153;&#22788;&#20110;
  <code>
   ACTIVE
  </code>
  &#29366;&#24577;&#12290;
 </li>
</ul>
<p>
 &#22312;&#19968;&#21488;MySQL&#26381;&#21153;&#22120;&#19978;&#65292;&#27599;&#20010;XA&#20107;&#21153;&#37117;&#24517;&#39035;&#26377;&#19968;&#20010;&#21807;&#19968;&#30340;id&#65292;&#34987;&#31216;&#20316;
 <code>
  xid
 </code>
 &#12290;&#36825;&#20010;xid&#26159;&#30001;&#21457;&#36215;XA&#20107;&#21153;&#30340;&#24212;&#29992;&#31243;&#24207;&#65288;&#23458;&#25143;&#31471;&#65289;&#33258;&#24049;&#25351;&#23450;&#30340;&#65292;&#21482;&#35201;&#25105;&#20204;&#33258;&#24049;&#20445;&#35777;&#23427;&#21807;&#19968;&#23601;&#22909;&#20102;&#12290;
</p>
<p>
 &#36825;&#20010;
 <code>
  xid
 </code>
 &#20854;&#23454;&#26159;&#30001;
 <code>
  gtrid
 </code>
 &#12289;
 <code>
  bqual
 </code>
 &#12289;
 <code>
  formatID
 </code>
 &#19977;&#20010;&#37096;&#20998;&#32452;&#25104;&#30340;&#65306;
</p>
<pre><code>xid: gtrid [, bqual [, formatID ]]
</code></pre>
<p>
 &#20854;&#20013;
 <code>
  gtrid
 </code>
 &#65288;global transaction id&#65289;&#26159;&#25351;&#20840;&#23616;&#20107;&#21153;id&#65292;&#26159;&#19968;&#20010;
 <strong>
  &#23383;&#31526;&#20018;
 </strong>
 &#65292;
 <code>
  bqual
 </code>
 &#26159;&#25351;&#20998;&#25903;&#38480;&#23450;&#31526;&#65292;
 <code>
  formatID
 </code>
 &#26159;&#25351;gtrid&#21644;bqual&#25152;&#20351;&#29992;&#30340;&#26684;&#24335;&#12290;
</p>
<p>
 &#19981;&#36807;&#25105;&#20204;&#36825;&#37324;&#24182;&#19981;&#25171;&#31639;&#35814;&#32416;&#21861;&#26159;&#20010;&#20998;&#25903;&#65292;&#36824;&#38480;&#23450;&#31526;&#65292;&#20197;&#21450;&#21861;&#26684;&#24335;&#20043;&#31867;&#30340;&#65292;&#25105;&#20204;&#21487;&#20197;&#22312;&#25351;&#23450;
 <code>
  xid
 </code>
 &#30340;&#26102;&#20505;&#30465;&#30053;
 <code>
  bqual
 </code>
 &#21644;
 <code>
  formatID
 </code>
 &#30340;&#20540;&#65292;MySQL&#20250;&#20351;&#29992;&#40664;&#35748;&#30340;&#20540;&#65288;
 <code>
  bqual
 </code>
 &#40664;&#35748;&#26159;&#31354;&#23383;&#31526;&#20018;''&#65292;
 <code>
  formatID
 </code>
 &#40664;&#35748;&#26159;1&#65289;&#12290;&#20063;&#23601;&#26159;&#35828;&#25105;&#20204;&#25991;&#31456;&#21518;&#32493;&#20869;&#23481;&#25351;&#23450;
 <code>
  xid
 </code>
 &#26102;&#20165;&#25351;&#23450;
 <code>
  gtrid
 </code>
 &#23601;&#22909;&#20102;&#65292;&#20063;&#23601;&#26159;&#25351;&#23450;&#19968;&#20010;
 <strong>
  &#23383;&#31526;&#20018;
 </strong>
 &#21363;&#21487;&#12290;
</p>
<ul>
 <li>
  <p>
   <code>
    XA END xid
   </code>
   &#65306;&#22312;&#20351;&#29992;
   <code>
    XA START xid
   </code>
   &#24320;&#21551;&#20102;&#19968;&#20010;XA&#20107;&#21153;&#21518;&#65292;&#23458;&#25143;&#31471;&#23601;&#21487;&#20197;&#25509;&#30528;&#21457;&#36865;&#23646;&#20110;&#36825;&#20010;XA&#20107;&#21153;&#30340;&#21508;&#26465;&#35821;&#21477;&#65292;&#31561;&#25152;&#26377;&#35821;&#21477;&#37117;&#21457;&#36865;&#23436;&#27605;&#21518;&#65292;&#23601;&#21487;&#20197;&#25509;&#30528;&#21457;&#36865;
   <code>
    XA END xid
   </code>
   &#26469;&#21578;&#30693;&#26381;&#21153;&#22120;&#30001;
   <code>
    xid
   </code>
   &#26631;&#35782;&#30340;XA&#20107;&#21153;&#30340;&#25152;&#26377;&#35821;&#21477;&#37117;&#36755;&#20837;&#23436;&#20102;&#12290;&#27492;&#26102;&#35813;XA&#20107;&#21153;&#22788;&#20110;
   <code>
    IDLE
   </code>
   &#29366;&#24577;&#12290;
  </p>
 </li>
 <li>
  <p>
   <code>
    XA PREPARE xid
   </code>
   &#65306;&#23545;&#20110;&#22788;&#20110;
   <code>
    IDLE
   </code>
   &#29366;&#24577;&#30340;XA&#20107;&#21153;&#65292;&#24212;&#29992;&#31243;&#24207;&#23601;&#21487;&#20197;&#35810;&#38382;MySQL&#26381;&#21153;&#22120;&#26159;&#21542;&#20934;&#22791;&#22909;&#25552;&#20132;&#36825;&#20010;XA&#20107;&#21153;&#20102;&#65292;&#27492;&#26102;&#23601;&#21487;&#20197;&#32473;&#26381;&#21153;&#22120;&#21457;&#36865;
   <code>
    XA PREPARE xid
   </code>
   &#35821;&#21477;&#12290;&#24403;MySQL&#26381;&#21153;&#22120;&#25910;&#21040;&#27492;&#35821;&#21477;&#21518;&#65292;&#23601;&#38656;&#35201;&#20570;&#20934;&#22791;&#25552;&#20132;&#21069;&#30340;&#24037;&#20316;&#20102;&#65292;&#27604;&#22914;&#25226;&#35813;&#20107;&#21153;&#25191;&#34892;&#36807;&#31243;&#20013;&#25152;&#20135;&#29983;&#30340;redo&#26085;&#24535;&#21047;&#26032;&#21040;&#30913;&#30424;&#31561;&#12290;&#27492;&#26102;XA&#20107;&#21153;&#22788;&#20110;
   <code>
    PREPARE
   </code>
   &#29366;&#24577;&#12290;
  </p>
 </li>
 <li>
  <p>
   <code>
    XA COMMIT xid [ONE PHASE]
   </code>
   &#65306;&#23545;&#20110;&#22788;&#20110;
   <code>
    PREPARE
   </code>
   &#29366;&#24577;&#30340;XA&#20107;&#21153;&#65292;&#24212;&#29992;&#31243;&#24207;&#21487;&#20197;&#21457;&#36865;
   <code>
    XA COMMIT xid
   </code>
   &#26469;&#35753;MySQL&#26381;&#21153;&#22120;&#25552;&#20132;XA&#20107;&#21153;&#12290;&#22914;&#26524;&#27492;XA&#20107;&#21153;&#23578;&#22788;&#20110;
   <code>
    IDEL
   </code>
   &#29366;&#24577;&#65292;&#37027;&#24212;&#29992;&#31243;&#24207;&#21487;&#20197;&#19981;&#21457;&#36865;
   <code>
    XA PREPARE xid
   </code>
   &#65292;&#32780;&#30452;&#25509;&#21457;&#36865;
   <code>
    XA COMMIT xid ONE PHASE
   </code>
   &#26469;&#35753;MySQL&#26381;&#21153;&#22120;&#30452;&#25509;&#25552;&#20132;&#20107;&#21153;&#21363;&#21487;&#12290;&#27492;XA&#20107;&#21153;&#22788;&#20110;
   <code>
    COMMITE
   </code>
   &#29366;&#24577;&#12290;
  </p>
 </li>
 <li>
  <p>
   <code>
    XA ROLLBACK xid
   </code>
   &#65306;&#24212;&#29992;&#31243;&#24207;&#36890;&#36807;&#21457;&#36865;&#27492;&#35821;&#21477;&#26469;&#35753;MySQL&#26381;&#21153;&#22120;&#22238;&#28378;xid&#25152;&#26631;&#35782;&#30340;&#20107;&#21153;&#12290;&#27492;&#26102;XA&#20107;&#21153;&#22788;&#20110;
   <code>
    ABORT
   </code>
   &#29366;&#24577;&#12290;
  </p>
 </li>
 <li>
  <p>
   <code>
    XA RECOVER
   </code>
   &#65306;&#24212;&#29992;&#31243;&#24207;&#24819;&#30475;&#19968;&#19979;&#24403;&#21069;MySQL&#26381;&#21153;&#22120;&#19978;&#24050;&#32463;&#22788;&#20110;Prepare&#29366;&#24577;&#30340;XA&#20107;&#21153;&#26377;&#21738;&#20123;&#65292;&#23601;&#21487;&#20197;&#21457;&#36865;&#35813;&#35821;&#21477;&#12290;
  </p>
 </li>
</ul>
<p>
 &#20171;&#32461;&#20102;&#22312;MySQL&#20013;&#20351;&#29992;
 <code>
  &#22806;&#37096;XA
 </code>
 &#30340;&#19968;&#20123;&#35821;&#21477;&#65292;&#25509;&#19979;&#26469;&#21487;&#20197;&#30011;&#19968;&#20010;XA&#20107;&#21153;&#30340;&#29366;&#24577;&#36716;&#25442;&#22270;&#20102;&#65306;
</p>
<p>
 <img alt="" src="EPUB/526bdb60-13d6-11ed-838d-acde48001122">
</p>
<p>
 &#21716;&#21716;&#20102;&#24456;&#22810;&#65292;&#36214;&#32039;&#26469;&#20570;&#20010;&#23454;&#39564;&#65306;
</p>
<pre><code>mysql&gt; XA START 'a';    //XA&#20107;&#21153;&#36827;&#20837;ACTIVE&#29366;&#24577;
Query OK, 0 rows affected (0.00 sec)

mysql&gt; DELETE FROM x WHERE id = 1;  //XA&#20107;&#21153;&#20013;&#21253;&#21547;&#30340;&#35821;&#21477;
Query OK, 1 row affected (0.00 sec)

mysql&gt; XA END 'a';      //XA&#20107;&#21153;&#36827;&#20837;IDEL&#29366;&#24577;
Query OK, 0 rows affected (0.00 sec)

mysql&gt; XA PREPARE 'a';  //XA&#20107;&#21153;&#36827;&#20837;PREPARE&#29366;&#24577;
Query OK, 0 rows affected (0.01 sec)

mysql&gt; XA COMMIT 'a';   //XA&#20107;&#21153;&#36827;&#20837;COMMIT&#29366;&#24577;
Query OK, 0 rows affected (0.01 sec)
</code></pre>
<p>
 MySQL&#30340;&#22806;&#37096;XA&#38500;&#20102;&#34987;&#29992;&#20110;&#36328;&#34892;&#36716;&#36134;&#36825;&#31181;&#32463;&#20856;&#30340;&#20998;&#24067;&#24335;&#20107;&#21153;&#24212;&#29992;&#22330;&#26223;&#65292;&#36824;&#34987;&#24191;&#27867;&#24212;&#29992;&#20110;&#25152;&#35859;&#30340;
 <code>
  &#25968;&#25454;&#24211;&#20013;&#38388;&#20214;
 </code>
 &#12290;
</p>
<p>
 &#29616;&#22312;&#21508;&#20010;&#20844;&#21496;&#30001;&#20110;&#34920;&#20013;&#25968;&#25454;&#22826;&#22810;&#65292;&#36825;&#20123;&#25968;&#25454;&#20250;&#34987;&#20998;&#25955;&#22312;&#19981;&#36890;&#26381;&#21153;&#22120;&#20013;&#23384;&#20648;&#12290;&#30001;&#24212;&#29992;&#31243;&#24207;&#21592;&#20998;&#21035;&#21644;&#19981;&#21516;&#30340;MySQL&#26381;&#21153;&#22120;&#25171;&#20132;&#36947;&#23454;&#22312;&#36153;&#21170;&#65292;&#25152;&#20197;&#26377;&#19968;&#31181;&#31216;&#20316;
 <code>
  &#25968;&#25454;&#24211;&#20013;&#38388;&#20214;
 </code>
 &#30340;&#19996;&#35199;&#24320;&#22987;&#38382;&#19990;&#12290;&#21363;&#24212;&#29992;&#31243;&#24207;&#21482;&#23558;SQL&#35821;&#21477;&#21457;&#36865;&#32473;&#25968;&#25454;&#24211;&#20013;&#38388;&#20214;&#65292;&#20013;&#38388;&#20214;&#20998;&#26512;&#19968;&#19979;&#35813;SQL&#35775;&#38382;&#30340;&#25968;&#25454;&#37117;&#22312;&#21738;&#20123;&#19981;&#21516;&#30340;&#26381;&#21153;&#22120;&#20013;&#23384;&#20648;&#30528;&#65292;&#24182;&#19988;&#35745;&#31639;&#20986;&#19981;&#36890;&#26381;&#21153;&#22120;&#24212;&#35813;&#25191;&#34892;&#21738;&#20123;SQL&#35821;&#21477;&#12290;&#28982;&#21518;&#23601;&#21487;&#20197;&#23545;&#19981;&#21516;&#30340;&#26381;&#21153;&#22120;&#20998;&#21035;&#24320;&#21551;XA&#20107;&#21153;&#65292;&#24182;&#19988;&#35753;&#25226;&#19981;&#21516;&#26381;&#21153;&#22120;&#38656;&#35201;&#25191;&#34892;&#30340;&#35821;&#21477;&#20998;&#21035;&#21457;&#36865;&#21040;&#19981;&#21516;&#30340;&#26381;&#21153;&#22120;&#20013;&#12290;&#31561;&#24212;&#29992;&#31243;&#24207;&#21592;&#21578;&#30693;&#20013;&#38388;&#20214;&#20934;&#22791;&#25552;&#20132;&#20107;&#21153;&#26102;&#65292;&#20013;&#38388;&#20214;&#20808;&#32473;&#21508;&#20010;&#26381;&#21153;&#22120;&#21457;&#36865;
 <code>
  XA PREPARE
 </code>
 &#35821;&#21477;&#65292;&#22914;&#26524;&#21508;&#20010;&#26381;&#21153;&#22120;&#37117;&#36820;&#22238;OK&#30340;&#35805;&#65292;&#25509;&#30528;&#23601;&#32473;&#21508;&#20010;&#26381;&#21153;&#22120;&#21457;&#36865;
 <code>
  XA COMMIT
 </code>
 &#35821;&#21477;&#26469;&#25552;&#20132;XA&#20107;&#21153;&#65292;&#31561;&#21508;&#20010;&#26381;&#21153;&#22120;&#25226;&#25552;&#20132;&#25104;&#21151;&#30340;&#28040;&#24687;&#36820;&#22238;&#32473;&#20013;&#38388;&#20214;&#65292;&#20013;&#38388;&#20214;&#23601;&#21487;&#20197;&#36890;&#30693;&#24212;&#29992;&#31243;&#24207;&#20107;&#21153;&#25552;&#20132;&#25104;&#21151;&#20102;&#12290;
</p>
<h3>
 &#20869;&#37096;XA
</h3>
<p>
 &#23545;&#20110;&#19968;&#21488;&#26381;&#21153;&#22120;&#26469;&#35828;&#65292;&#21363;&#20351;&#23458;&#25143;&#31471;&#20351;&#29992;
 <code>
  BEGIN/START TRANSACTION
 </code>
 &#35821;&#21477;&#24320;&#21551;&#30340;&#26222;&#36890;&#20107;&#21153;&#65292;&#35813;&#20107;&#21153;&#25152;&#21253;&#21547;&#30340;&#35821;&#21477;&#20063;&#26377;&#21487;&#33021;&#28041;&#21450;&#22810;&#20010;&#23384;&#20648;&#24341;&#25806;&#12290;&#27492;&#26102;MySQL&#20869;&#37096;&#37319;&#29992;XA&#35268;&#33539;&#26469;&#20445;&#35777;&#25152;&#26377;&#25903;&#25345;&#20107;&#21153;&#30340;&#23384;&#20648;&#24341;&#25806;&#35201;&#20040;&#20840;&#37096;&#25552;&#20132;&#65292;&#35201;&#20040;&#20840;&#37096;&#22238;&#28378;&#65292;&#36825;&#20063;&#34987;&#31216;&#20316;MySQL&#30340;
 <code>
  &#20869;&#37096;XA
 </code>
 &#12290;
</p>
<p>
 &#21478;&#22806;&#26377;&#19968;&#28857;&#20540;&#24471;&#27880;&#24847;&#30340;&#26159;&#65292;
 <code>
  &#20869;&#37096;XA
 </code>
 &#38500;&#20102;&#35299;&#20915;&#36825;&#31181;&#35774;&#35745;&#22810;&#20010;&#23384;&#20648;&#24341;&#25806;&#30340;&#20107;&#21153;&#20043;&#22806;&#65292;&#36824;&#35299;&#20915;&#20445;&#35777;binlog&#21644;&#23384;&#20648;&#24341;&#25806;&#25152;&#20570;&#30340;&#20462;&#25913;&#26159;&#19968;&#33268;&#30340;&#38382;&#39064;&#12290;&#25105;&#20204;&#31245;&#21518;&#37325;&#28857;&#23637;&#24320;&#19968;&#19979;&#36825;&#20010;&#38382;&#39064;&#12290;
</p>
<p>
 &#22312;MySQL&#20869;&#37096;&#25191;&#34892;&#19968;&#20010;&#20107;&#21153;&#26102;&#65292;&#23384;&#20648;&#24341;&#25806;&#20250;&#20462;&#25913;&#30456;&#24212;&#30340;&#25968;&#25454;&#65292;server&#23618;&#20250;&#35760;&#24405;&#35821;&#21477;&#23545;&#24212;&#30340;binlog&#12290;&#36825;&#26159;&#20004;&#20010;&#35201;&#20040;&#37117;&#23436;&#25104;&#65292;&#35201;&#20040;&#37117;&#27493;&#23436;&#25104;&#30340;&#20107;&#24773;&#12290;&#21542;&#21017;&#30340;&#35805;&#65306;
</p>
<ul>
 <li>
  <p>
   &#22914;&#26524;&#23384;&#20648;&#24341;&#25806;&#20462;&#25913;&#20102;&#30456;&#24212;&#25968;&#25454;&#24182;&#19988;&#25552;&#20132;&#20102;&#20107;&#21153;&#65292;&#32780;server&#23618;&#21364;&#26410;&#20889;&#20837;binlog&#12290;&#22312;&#26377;&#20027;&#20174;&#22797;&#21046;&#30340;&#22330;&#26223;&#20013;&#65292;&#24847;&#21619;&#30528;&#36825;&#20010;&#20107;&#21153;&#19981;&#20250;&#22312;&#20174;&#24211;&#20013;&#24471;&#24050;&#25191;&#34892;&#65292;&#20174;&#32780;&#36896;&#25104;&#20027;&#20174;&#20043;&#38388;&#30340;&#25968;&#25454;&#19981;&#19968;&#33268;&#12290;
  </p>
 </li>
 <li>
  <p>
   &#22914;&#26524;server&#23618;&#20889;&#20837;&#20102;binlog&#65292;&#20294;&#23384;&#20648;&#24341;&#25806;&#21364;&#22238;&#28378;&#20102;&#20107;&#21153;&#12290;&#22312;&#26377;&#20027;&#20174;&#22797;&#21046;&#30340;&#22330;&#26223;&#20013;&#65292;&#24847;&#21619;&#30528;&#36825;&#20010;&#20107;&#21153;&#20250;&#22312;&#20174;&#24211;&#20013;&#24471;&#24050;&#25191;&#34892;&#65292;&#20174;&#32780;&#36896;&#25104;&#20027;&#20174;&#20043;&#38388;&#30340;&#25968;&#25454;&#19981;&#19968;&#33268;&#12290;
  </p>
 </li>
</ul>
<p>
 &#37027;&#25105;&#20204;&#38656;&#35201;&#20445;&#35777;&#65306;
 <strong>
  &#22914;&#26524;&#23384;&#20648;&#24341;&#25806;&#25552;&#20132;&#20102;&#20107;&#21153;&#65292;server&#23618;&#30340;binlog&#26085;&#24535;&#24517;&#39035;&#20063;&#34987;&#20889;&#20837;&#21040;&#30828;&#30424;&#19978;&#65307;&#22914;&#26524;&#23384;&#20648;&#24341;&#25806;&#22238;&#28378;&#20102;&#20107;&#21153;&#65292;server&#23618;&#30340;binlog&#26085;&#24535;&#24517;&#39035;&#19981;&#33021;&#34987;&#20889;&#20837;&#21040;&#30828;&#30424;&#19978;
 </strong>
 &#12290;
</p>
<p>
 MySQL&#37319;&#29992;
 <code>
  &#20869;&#37096;XA
 </code>
 &#26469;&#23454;&#29616;&#19978;&#36848;&#20869;&#23481;&#65292;&#19979;&#36793;&#20197;Innodb&#23384;&#20648;&#24341;&#25806;&#20026;&#20363;&#65292;&#20855;&#20307;&#35752;&#35770;&#19968;&#19979;Innodb&#20107;&#21153;&#30340;&#25552;&#20132;&#21644;binlog&#26085;&#24535;&#20889;&#20837;&#30340;&#36807;&#31243;&#12290;
</p>
<h2>
 &#26377;binlog&#21442;&#19982;&#30340;&#20869;&#37096;XA&#20107;&#21153;
</h2>
<blockquote>
 <p>
  &#23567;&#36148;&#22763;&#65306;
  <br>
  <br>
  &#21518;&#32493;&#20250;&#29992;&#21040;&#24456;&#22810;undo&#26085;&#24535;&#32467;&#26500;&#30340;&#20869;&#23481;&#65292;&#36825;&#20123;&#20869;&#23481;&#37117;&#22312;&#12298;MySQL&#26159;&#24590;&#26679;&#36816;&#34892;&#30340;&#65306;&#20174;&#26681;&#20799;&#19978;&#29702;&#35299;MySQL&#12299;&#20070;&#31821;&#20013;&#26377;&#35814;&#32454;&#21465;&#36848;&#65292;&#22914;&#26524;&#19981;&#20102;&#35299;&#30340;&#35805;&#65292;&#30475;&#36215;&#26469;&#21487;&#33021;&#20250;&#26377;&#28857;&#20799;&#22256;&#38590;&#65292;&#24314;&#35758;&#20808;&#23558;undo&#26085;&#24535;&#31456;&#33410;&#20869;&#23481;&#30475;&#29087;&#12290;
 </p>
</blockquote>
<p>
 &#24403;&#23458;&#25143;&#31471;&#25191;&#34892;
 <code>
  COMMIT
 </code>
 &#35821;&#21477;&#25110;&#32773;&#22312;&#33258;&#21160;&#25552;&#20132;&#30340;&#24773;&#20917;&#19979;&#65292;MySQL&#20869;&#37096;&#24320;&#21551;&#19968;&#20010;XA&#20107;&#21153;&#65292;&#20998;&#20004;&#38454;&#27573;&#26469;&#23436;&#25104;XA&#20107;&#21153;&#30340;&#25552;&#20132;&#65306;
</p>
<ul>
 <li>
  Prepare&#38454;&#27573;&#65306;&#23384;&#20648;&#24341;&#25806;&#23558;&#35813;&#20107;&#21153;&#25191;&#34892;&#36807;&#31243;&#20013;&#20135;&#29983;&#30340;redo&#26085;&#24535;&#21047;&#30424;&#65292;&#24182;&#19988;&#23558;&#26412;&#20107;&#21153;&#30340;&#29366;&#24577;&#35774;&#32622;&#20026;
  <code>
   PREPARE
  </code>
  &#12290;binlog&#21861;&#20063;&#19981;&#24178;&#12290;&#19979;&#36793;&#30475;&#19968;&#19979;&#20855;&#20307;&#30340;&#20195;&#30721;&#12290;
 </li>
</ul>
<p>
 <code>
  binlog_prepare
 </code>
 &#26159;&#22312;PREPARE&#38454;&#27573;&#23545;binlog&#25152;&#20570;&#30340;&#19968;&#20123;&#25805;&#20316;&#65306;
</p>
<p>
 <img alt="" src="EPUB/527766e2-13d6-11ed-838d-acde48001122">
</p>
<p>
 <code>
  binlog_prepare
 </code>
 &#20989;&#25968;&#22522;&#26412;&#21861;&#20063;&#27809;&#24178;&#65292;&#25105;&#20204;&#23601;&#19981;&#23637;&#24320;&#35828;&#20102;&#12290;
</p>
<p>
 <code>
  innobase_xa_prepare
 </code>
 &#26159;InnoDB&#23384;&#20648;&#24341;&#25806;&#23454;&#29616;&#30340;XA&#35268;&#33539;&#30340;prepare&#25509;&#21475;&#65306;
</p>
<p>
 <img alt="" src="EPUB/52851026-13d6-11ed-838d-acde48001122">
</p>
<p>
 &#36825;&#20010;&#20989;&#25968;&#20570;&#20102;&#24456;&#22810;&#20107;&#24773;&#65292;&#25105;&#20204;&#24471;&#22909;&#22909;&#21792;&#21480;&#19968;&#19979;&#12290;
</p>
<p>
 &#39318;&#20808;&#25105;&#20204;&#30693;&#36947;&#20107;&#21153;&#25191;&#34892;&#36807;&#31243;&#20013;&#38656;&#35201;&#20889;undo&#26085;&#24535;&#65292;&#36825;&#20123;undo&#26085;&#24535;&#34987;&#20889;&#21040;&#33509;&#24178;&#20010;&#39029;&#38754;&#20013;&#65292;&#36825;&#20123;&#39029;&#38754;&#20063;&#34987;&#31216;&#20316;
 <code>
  Undo&#39029;&#38754;
 </code>
 &#65292;&#36825;&#20123;&#39029;&#38754;&#20250;&#20018;&#25104;&#19968;&#20010;&#38142;&#34920;&#65292;&#31216;&#20316;
 <code>
  Undo&#39029;&#38754;
 </code>
 &#38142;&#34920;&#12290;&#22312;&#19968;&#20010;&#20107;&#21153;&#23545;&#24212;&#30340;Undo&#39029;&#38754;&#38142;&#34920;&#30340;&#39318;&#20010;&#39029;&#38754;&#20013;&#65292;&#35760;&#24405;&#20102;&#19968;&#20123;&#20851;&#20110;&#36825;&#20010;&#20107;&#21153;&#30340;&#19968;&#20123;&#23646;&#24615;&#65292;&#25105;&#20204;&#36148;&#20010;&#22270;&#30475;&#19968;&#19979;&#65306;
</p>
<p>
 <img alt="" src="EPUB/5293b7c0-13d6-11ed-838d-acde48001122">
</p>
<p>
 &#25105;&#20204;&#20808;&#30475;&#19968;&#19979;&#20854;&#20013;&#30340;
 <code>
  Undo Log Segment Header
 </code>
 &#37096;&#20998;&#65306;
</p>
<p>
 <img alt="" src="EPUB/529f5de6-13d6-11ed-838d-acde48001122">
</p>
<p>
 &#20854;&#20013;&#30340;
 <code>
  TRX_UNDO_STATE
 </code>
 &#23383;&#27573;&#23601;&#34920;&#26126;&#35813;&#20107;&#21153;&#30446;&#21069;&#22788;&#20110;&#20160;&#20040;&#29366;&#24577;&#12290;&#24403;&#22788;&#20110;Prepare&#38454;&#27573;&#26102;&#65292;&#35843;&#29992;
 <code>
  innobase_xa_prepare
 </code>
 &#20989;&#25968;&#20250;&#23558;
 <code>
  TRX_UNDO_STATE
 </code>
 &#23383;&#27573;&#30340;&#20540;&#35774;&#32622;&#20026;
 <code>
  TRX_UNDO_PREPARED
 </code>
 &#65288;&#25972;&#25968;5&#65289;&#65292;&#34920;&#26126;&#24403;&#21069;&#20107;&#21153;&#22788;&#22312;Prepare&#38454;&#27573;&#12290;
</p>
<p>
 &#25105;&#20204;&#20877;&#30475;&#19968;&#19979;
 <code>
  Undo Log Header
 </code>
 &#37096;&#20998;&#65306;
</p>
<p>
 <img alt="" src="EPUB/52ab55ce-13d6-11ed-838d-acde48001122">
</p>
<p>
 &#36825;&#20010;&#37096;&#20998;&#20307;&#29616;&#30528;&#36825;&#20010;
 <code>
  Undo&#39029;&#38754;&#38142;&#34920;
 </code>
 &#25152;&#23646;&#30340;&#20107;&#21153;&#30340;&#21508;&#31181;&#20449;&#24687;&#65292;&#21253;&#25324;&#20107;&#21153;id&#12290;&#20854;&#20013;&#20004;&#20010;&#23646;&#24615;&#21644;&#25105;&#20204;&#20170;&#22825;&#20027;&#39064;&#29305;&#21035;&#25645;&#65306;
</p>
<ul>
 <li>
  <code>
   TRX_UNDO_XID_EXISTS
  </code>
  &#65306;&#34920;&#31034;&#26377;&#27809;&#26377;xid&#20449;&#24687;&#12290;
 </li>
 <li>
  <code>
   XID&#20449;&#24687;
  </code>
  &#65306;&#34920;&#31034;&#20855;&#20307;&#30340;xid&#26159;&#20160;&#20040;&#12290;
 </li>
</ul>
<p>
 &#24403;&#22788;&#20110;Prepare&#38454;&#27573;&#26102;&#65292;&#35843;&#29992;
 <code>
  innobase_xa_prepare
 </code>
 &#20989;&#25968;&#20250;&#23558;
 <code>
  TRX_UNDO_XID_EXISTS
 </code>
 &#35774;&#32622;&#20026;TRUE&#65292;&#24182;&#23558;&#26412;&#27425;&#20869;&#37096;XA&#20107;&#21153;&#30340;
 <code>
  xid
 </code>
 &#65288;&#36825;&#20010;xid&#26159;MySQL&#33258;&#24049;&#29983;&#25104;&#30340;&#65289;&#20889;&#20837;
 <code>
  XID&#20449;&#24687;
 </code>
 &#22788;&#12290;
</p>
<blockquote>
 <p>
  &#23567;&#36148;&#22763;&#65306;
  <br>
  <br>
  &#20877;&#19968;&#27425;&#24378;&#35843;&#65292;&#20462;&#25913;Undo&#39029;&#38754;&#20063;&#26159;&#22312;&#20462;&#25913;&#39029;&#38754;&#65292;&#20107;&#21153;&#20961;&#26159;&#20462;&#25913;&#39029;&#38754;&#23601;&#38656;&#35201;&#20808;&#35760;&#24405;&#30456;&#24212;&#30340;redo&#26085;&#24535;&#12290;
 </p>
</blockquote>
<p>
 &#35760;&#24405;&#20102;&#20851;&#20110;&#35813;&#20107;&#21153;&#30340;&#21508;&#31181;&#23646;&#24615;&#20043;&#21518;&#65292;&#25509;&#19979;&#26469;&#35813;&#23558;&#21040;&#29616;&#22312;&#20026;&#27490;&#25152;&#20135;&#29983;&#30340;&#25152;&#26377;redo&#26085;&#24535;&#36827;&#34892;&#21047;&#30424;&#65292;&#21047;&#30424;&#30340;&#20989;&#25968;&#22914;&#19979;&#25152;&#31034;&#65306;
</p>
<p>
 <img alt="" src="EPUB/52b82d26-13d6-11ed-838d-acde48001122">
</p>
<p>
 &#22312;&#23558;redo&#26085;&#24535;&#21047;&#30424;&#20043;&#21518;&#65292;&#21363;&#20351;&#20043;&#21518;&#31995;&#32479;&#23849;&#28291;&#65292;&#22312;&#37325;&#21551;&#24674;&#22797;&#30340;&#26102;&#20505;&#20063;&#21487;&#20197;&#23558;&#22788;&#20110;Prepare&#29366;&#24577;&#30340;&#20107;&#21153;&#23436;&#20840;&#24674;&#22797;&#12290;
</p>
<blockquote>
 <p>
  &#23567;&#36148;&#22763;&#65306;
  <br>
  <br>
  &#22312;MySQL 5.7&#20013;&#65292;&#26377;&#19968;&#20010;&#31216;&#20043;&#20026;
  <code>
   &#32452;&#25552;&#20132;
  </code>
  &#65288;group commit&#65289;&#30340;&#20248;&#21270;&#12290;&#21363;&#35774;&#35745;InnoDB&#30340;&#22823;&#21460;&#35273;&#24471;&#21508;&#20010;&#20107;&#21153;&#20998;&#21035;&#21047;&#33258;&#24049;&#30340;redo&#26085;&#24535;&#21644;binlog&#25928;&#29575;&#22826;&#20302;&#65292;&#20182;&#20204;&#25226;&#24182;&#21457;&#25191;&#34892;&#30340;&#22810;&#20010;&#20107;&#21153;&#25152;&#20135;&#29983;&#30340;redo&#26085;&#24535;&#21644;binlog&#22312;&#21518;&#32493;&#30340;Commit&#38454;&#27573;&#38598;&#20013;&#36215;&#26469;&#32479;&#19968;&#21047;&#26032;&#65292;&#36825;&#26679;&#21487;&#33021;&#25552;&#21319;&#25928;&#29575;&#65292;&#25152;&#20197;&#22312;MySQL 5.7&#20197;&#21450;&#20043;&#21518;&#30340;&#29256;&#26412;&#20013;&#65292;&#19978;&#36848;&#22312;Prepare&#38454;&#27573;&#21047;&#26032;redo&#26085;&#24535;&#30340;&#25805;&#20316;&#20250;&#34987;&#25512;&#36831;&#21040;Commit&#38454;&#27573;&#25165;&#30495;&#27491;&#25191;&#34892;&#12290;&#20851;&#20110;
  <code>
   &#32452;&#25552;&#20132;
  </code>
  &#30340;&#20248;&#21270;&#25514;&#26045;&#25105;&#20204;&#24182;&#19981;&#24819;&#36807;&#22810;&#23637;&#24320;&#65292;&#22823;&#23478;&#24573;&#30053;&#36825;&#20010;&#20248;&#21270;&#23601;&#22909;&#20102;&#65292;&#36825;&#37324;&#23601;&#35748;&#20026;&#22312;Prepare&#38454;&#27573;&#20107;&#21153;&#23601;&#24050;&#32463;&#23558;&#25191;&#34892;&#36807;&#31243;&#20013;&#20135;&#29983;&#30340;redo&#26085;&#24535;&#21047;&#30424;&#23601;OK&#12290;
 </p>
</blockquote>
<ul>
 <li>
  Commit&#38454;&#27573;&#65306;&#20808;&#23558;&#20107;&#21153;&#25191;&#34892;&#36807;&#31243;&#20013;&#20135;&#29983;&#30340;binlog&#21047;&#26032;&#21040;&#30828;&#30424;&#65292;&#20877;&#25191;&#34892;&#23384;&#20648;&#24341;&#25806;&#30340;&#25552;&#20132;&#24037;&#20316;&#12290;
 </li>
</ul>
<p>
 &#23558;binlog&#21047;&#30424;&#30340;&#20989;&#25968;&#22914;&#19979;&#65306;
</p>
<p>
 <img alt="" src="EPUB/52c86696-13d6-11ed-838d-acde48001122">
</p>
<p>
 InnoDB&#23384;&#20648;&#24341;&#25806;&#25552;&#20132;&#20107;&#21153;&#20351;&#29992;
 <code>
  innobase_commit
 </code>
 &#20989;&#25968;&#23436;&#25104;&#23384;&#20648;&#24341;&#25806;&#23618;&#38754;&#30340;&#20107;&#21153;&#25552;&#20132;&#65306;
</p>
<p>
 <img alt="" src="EPUB/52d3d468-13d6-11ed-838d-acde48001122">
</p>
<p>
 <code>
  innobase_commit
 </code>
 &#20989;&#25968;&#20570;&#20102;&#24456;&#22810;&#20107;&#24773;&#65292;&#25105;&#20204;&#25361;&#19968;&#20123;&#37325;&#35201;&#30340;&#26469;&#35828;&#12290;
</p>
<p>
 &#39318;&#20808;&#26159;&#26356;&#26032;
 <code>
  Undo&#39029;&#38754;&#38142;&#34920;
 </code>
 &#30340;&#29366;&#24577;&#65292;&#23558;&#25105;&#20204;&#19978;&#36793;&#35828;&#30340;
 <code>
  Undo Log Segment Header
 </code>
 &#37096;&#20998;&#30340;STATE&#23383;&#27573;&#26356;&#26032;&#19968;&#19979;&#12290;&#26356;&#26032;&#35268;&#21017;&#22914;&#19979;&#65306;
</p>
<p>
 <img alt="" src="EPUB/52deeb32-13d6-11ed-838d-acde48001122">
</p>
<p>
 &#20063;&#23601;&#26159;&#35828;&#22914;&#26524;&#24403;&#21069;&#20107;&#21153;&#20135;&#29983;&#30340;undo&#26085;&#24535;&#27604;&#36739;&#23569;&#65292;&#37027;&#20040;&#23601;&#32487;&#32493;&#35753;&#21035;&#30340;&#20107;&#21153;&#22797;&#29992;&#35813;
 <code>
  Undo&#39029;&#38754;&#38142;&#34920;
 </code>
 &#65292;&#23558;STATE&#35774;&#32622;&#20026;
 <code>
  TRX_UNDO_CACHED
 </code>
 &#65307;&#22914;&#26524;
 <code>
  Undo&#39029;&#38754;&#38142;&#34920;
 </code>
 &#29992;&#20110;&#23384;&#20648;INSERT&#25805;&#20316;&#20135;&#29983;&#30340;undo&#26085;&#24535;&#65292;&#37027;&#20040;&#23601;&#23558;STATE&#35774;&#32622;&#20026;
 <code>
  TRX_UNDO_TO_FREE
 </code>
 &#65292;&#31245;&#21518;&#20250;&#37322;&#25918;
 <code>
  Undo&#39029;&#38754;&#38142;&#34920;
 </code>
 &#21344;&#29992;&#30340;&#39029;&#38754;&#65307;&#22914;&#26524;
 <code>
  Undo&#39029;&#38754;&#38142;&#34920;
 </code>
 &#29992;&#20110;&#23384;&#20648;&#20854;&#20182;&#25805;&#20316;&#20135;&#29983;&#30340;undo&#26085;&#24535;&#65292;&#37027;&#20040;&#23601;&#23558;STATE&#35774;&#32622;&#20026;
 <code>
  TRX_UNDO_TO_PURGE
 </code>
 &#65292;&#31561;&#24453;purge&#32447;&#31243;&#21518;&#21488;&#22238;&#25910;&#35813;
 <code>
  Undo&#39029;&#38754;&#38142;&#34920;
 </code>
 &#12290;
</p>
<blockquote>
 <p>
  &#23567;&#36148;&#22763;&#65306;
  <br>
  <br>
  UPDATE&#12289;DELETE&#25805;&#20316;&#20135;&#29983;&#30340;undo&#26085;&#24535;&#21487;&#33021;&#20250;&#29992;&#20110;&#20854;&#20182;&#20107;&#21153;&#30340;MVCC&#25805;&#20316;&#65292;&#25152;&#20197;&#19981;&#33021;&#31435;&#21363;&#21024;&#38500;&#12290;
 </p>
</blockquote>
<p>
 &#23545;&#20110;&#23384;&#20648;UPDATE&#12289;DELETE&#25805;&#20316;&#20135;&#29983;&#30340;undo&#26085;&#24535;&#30340;
 <code>
  Undo&#39029;&#38754;&#38142;&#34920;
 </code>
 &#65292;&#36824;&#35201;&#23558;&#20854;&#21152;&#20837;&#25152;&#35859;&#30340;History&#38142;&#34920;&#65292;&#20851;&#20110;&#36825;&#20010;History&#38142;&#34920;&#26159;&#21861;&#65292;&#25105;&#20204;&#36825;&#37324;&#23601;&#19981;&#23637;&#24320;&#20102;&#12290;
</p>
<p>
 &#27599;&#20010;
 <code>
  Undo&#39029;&#38754;&#38142;&#34920;
 </code>
 &#30340;&#39318;&#20010;&#39029;&#38754;&#30340;&#39029;&#21495;&#20250;&#34987;&#23384;&#20648;&#22312;&#34920;&#31354;&#38388;&#30340;&#26576;&#20010;&#22320;&#26041;&#65292;&#20197;&#20415;&#23849;&#28291;&#24674;&#22797;&#30340;&#26102;&#20505;&#21487;&#20197;&#26681;&#25454;&#35813;&#39029;&#26469;&#36827;&#34892;&#24674;&#22797;&#12290;&#22914;&#26524;&#27492;&#26102;&#22312;&#20107;&#21153;&#25552;&#20132;&#26102;&#65292;
 <code>
  Undo&#39029;&#38754;&#38142;&#34920;
 </code>
 &#30340;&#29366;&#24577;&#34987;&#35774;&#32622;&#20026;
 <code>
  TRX_UNDO_CACHED
 </code>
 &#65292;&#37027;&#23384;&#20648;
 <code>
  Undo&#39029;&#38754;&#38142;&#34920;
 </code>
 &#30340;&#39318;&#20010;&#39029;&#38754;&#30340;&#39029;&#21495;&#30340;&#22320;&#26041;&#20063;&#23601;&#19981;&#38656;&#35201;&#20570;&#25913;&#21160;&#65307;&#22914;&#26524;&#27492;&#26102;&#22312;&#20107;&#21153;&#25552;&#20132;&#26102;&#65292;
 <code>
  Undo&#39029;&#38754;&#38142;&#34920;
 </code>
 &#30340;&#29366;&#24577;&#34987;&#35774;&#32622;&#20026;
 <code>
  TRX_UNDO_CACHED
 </code>
 &#65292;&#37027;&#23384;&#20648;
 <code>
  Undo&#39029;&#38754;&#38142;&#34920;
 </code>
 &#30340;&#39318;&#20010;&#39029;&#38754;&#30340;&#39029;&#21495;&#30340;&#22320;&#26041;&#23601;&#24471;&#34987;&#35774;&#32622;&#20026;&#31354;&#65292;&#36825;&#26679;&#36825;&#20010;&#22320;&#26041;&#23601;&#21487;&#20197;&#34987;&#20854;&#20182;&#20107;&#21153;&#20351;&#29992;&#20102;&#12290;
</p>
<p>
 &#33267;&#27492;&#65292;&#36825;&#20010;&#20107;&#21153;&#23601;&#31639;&#26159;&#25552;&#20132;&#23436;&#20102;&#12290;
</p>
<h2>
 &#23849;&#28291;&#24674;&#22797;
</h2>
<p>
 &#27599;&#24403;&#31995;&#32479;&#37325;&#21551;&#26102;&#65292;&#37117;&#20250;&#20808;&#36827;&#20837;&#24674;&#22797;&#36807;&#31243;&#12290;
</p>
<p>
 &#27492;&#26102;&#39318;&#20808;&#25353;&#29031;&#24050;&#32463;&#21047;&#26032;&#21040;&#30913;&#30424;&#30340;redo&#26085;&#24535;&#20462;&#25913;&#39029;&#38754;&#65292;&#25226;&#31995;&#32479;&#24674;&#22797;&#21040;&#23849;&#28291;&#21069;&#30340;&#29366;&#24577;&#12290;
</p>
<p>
 &#28982;&#21518;&#22312;&#34920;&#31354;&#38388;&#20013;&#25214;&#19968;&#19979;&#21508;&#20010;
 <code>
  Undo&#39029;&#38754;&#38142;&#34920;
 </code>
 &#30340;&#39318;&#20010;&#39029;&#38754;&#30340;&#39029;&#21495;&#65292;&#28982;&#21518;&#23601;&#21487;&#20197;&#35835;&#21462;&#35813;&#39029;&#38754;&#30340;&#21508;&#31181;&#20449;&#24687;&#12290;&#25105;&#20204;&#20877;&#25226;&#36825;&#20010;&#39029;&#38754;&#30340;&#20869;&#23481;&#32473;&#22823;&#23478;&#30475;&#19968;&#19979;&#65306;
</p>
<p>
 <img alt="" src="EPUB/52ebf91c-13d6-11ed-838d-acde48001122">
</p>
<p>
 &#36890;&#36807;&#36825;&#20010;&#39029;&#38754;&#65292;&#25105;&#20204;&#21487;&#20197;&#30693;&#36947;&#35813;
 <code>
  Undo&#39029;&#38754;&#38142;&#34920;
 </code>
 &#23545;&#24212;&#30340;&#20107;&#21153;&#29366;&#24577;&#26159;&#20160;&#20040;&#65306;
</p>
<ul>
 <li>
  <p>
   &#22914;&#26524;&#26159;
   <code>
    TRX_UNDO_ACTIVE
   </code>
   &#29366;&#24577;&#65292;&#20063;&#23601;&#26159;&#27963;&#36291;&#29366;&#24577;&#65292;&#30452;&#25509;&#25353;&#29031;undo&#26085;&#24535;&#37324;&#35760;&#36733;&#30340;&#20869;&#23481;&#23558;&#20854;&#22238;&#28378;&#23601;&#22909;&#20102;&#12290;
  </p>
 </li>
 <li>
  <p>
   &#22914;&#26524;&#26159;
   <code>
    TRX_UNDO_PREPARE
   </code>
   &#29366;&#24577;&#65292;&#37027;&#20040;&#26159;&#25552;&#20132;&#36824;&#26159;&#22238;&#28378;&#23601;&#21462;&#20915;&#20110;binlog&#30340;&#29366;&#24577;&#20102;&#65292;&#25105;&#20204;&#31245;&#21518;&#20877;&#35828;&#12290;
  </p>
 </li>
 <li>
  <p>
   &#22914;&#26524;&#26159;&#20854;&#20182;&#29366;&#24577;&#65292;&#23601;&#23558;&#35813;&#20107;&#21153;&#25552;&#20132;&#21363;&#21487;&#12290;
  </p>
 </li>
</ul>
<p>
 &#23545;&#20110;&#22788;&#20110;PREPARE&#29366;&#24577;&#30340;&#20107;&#21153;&#65292;&#23384;&#20648;&#24341;&#25806;&#26082;&#21487;&#20197;&#25552;&#20132;&#65292;&#20063;&#21487;&#20197;&#22238;&#28378;&#65292;&#36825;&#21462;&#20915;&#20110;&#30446;&#21069;&#35813;&#20107;&#21153;&#23545;&#24212;&#30340;binlog&#26159;&#21542;&#24050;&#32463;&#20889;&#20837;&#30828;&#30424;&#12290;&#36825;&#26102;&#23601;&#20250;&#35835;&#21462;&#26368;&#21518;&#19968;&#20010;binlog&#26085;&#24535;&#25991;&#20214;&#65292;&#20174;&#26085;&#24535;&#25991;&#20214;&#20013;&#25214;&#19968;&#19979;&#26377;&#27809;&#26377;&#35813;PREPARE&#20107;&#21153;&#23545;&#24212;&#30340;xid&#35760;&#24405;&#65292;&#22914;&#26524;&#26377;&#30340;&#35805;&#65292;&#23601;&#23558;&#35813;&#20107;&#21153;&#25552;&#20132;&#65292;&#21542;&#21017;&#23601;&#22238;&#28378;&#22909;&#20102;&#12290;
</p>
<h2>
 &#26368;&#21518;
</h2>
<p>
 &#36825;&#19968;&#31687;&#25991;&#31456;&#26377;&#28857;&#20799;&#38271;&#65292;&#19981;&#28857;&#36190;/&#22312;&#30475;/&#20998;&#20139;&#65292;&#30495;&#30340;&#22909;&#20040;&#65374;
</p>
</div>

</div>
</div>
