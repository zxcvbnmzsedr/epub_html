<div><div class="markdown-body">
    <h1>&#19987;&#39064;&#24335;&#35762;&#35299; &#8212;&#8212; MySQL&#30340;COUNT&#35821;&#21477;&#26159;&#24590;&#20040;&#25191;&#34892;&#30340;</h1>

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" href="style/style.css" type="text/css">

<div class="markdown-body">
    <h1>
 MySQL&#30340;COUNT&#35821;&#21477;&#26159;&#24590;&#20040;&#25191;&#34892;&#30340;
</h1>
<p>
 &#26631;&#31614;&#65306; MySQL&#26159;&#24590;&#26679;&#36816;&#34892;&#30340;
</p>
<hr>
<p>
 &#20247;&#22810;&#24320;&#21457;&#23567;&#20249;&#20276;&#22312;&#20889;&#19994;&#21153;&#36923;&#36753;&#30340;&#26102;&#20505;&#37117;&#20250;&#26377;&#19968;&#20010;&#32479;&#35745;&#34892;&#25968;&#30340;&#38656;&#27714;&#65292;&#27492;&#26102;COUNT&#20989;&#25968;&#20415;&#25104;&#20026;&#20102;&#39318;&#36873;&#12290;&#20294;&#26159;&#22823;&#23478;&#21457;&#29616;&#65292;&#38543;&#30528;&#25968;&#25454;&#37327;&#30340;&#22686;&#38271;&#65292;COUNT&#25191;&#34892;&#30340;&#36234;&#26469;&#36234;&#24930;&#65292;&#26412;&#25991;&#20174;&#28304;&#30721;&#30340;&#35282;&#24230;&#26469;&#24110;&#21161;&#23567;&#20249;&#20276;&#20204;&#20998;&#26512;&#19968;&#19979;MySQL&#20013;&#30340;COUNT&#20989;&#25968;&#26159;&#22914;&#20309;&#25191;&#34892;&#30340;&#12290;
</p>
<p>
 &#38656;&#35201;&#22768;&#26126;&#19968;&#28857;&#65292;&#26412;&#25991;&#25152;&#20351;&#29992;&#30340;MySQL&#28304;&#30721;&#29256;&#26412;&#26159;5.7.22&#65292;&#24182;&#19988;&#21482;&#38024;&#23545;InnoDB&#23384;&#20648;&#24341;&#25806;&#12290;&#22312;&#28145;&#20837;&#20171;&#32461;&#20043;&#21069;&#38656;&#35201;&#22823;&#23478;&#20855;&#26377;&#19968;&#20123;&#21069;&#32622;&#30693;&#35782;&#65292;&#25165;&#21487;&#20197;&#39034;&#21033;&#35752;&#35770;&#12290;
</p>
<h2>
 &#21069;&#32622;&#30693;&#35782;1&#8212;&#8212;InnoDB&#30340;B+&#26641;&#32034;&#24341;
</h2>
<p>
 &#20026;&#20102;&#25925;&#20107;&#30340;&#39034;&#21033;&#21457;&#23637;&#65292;&#25105;&#20204;&#24341;&#20837;&#19968;&#20010;&#34920;&#65306;
</p>
<pre><code>CREATE TABLE t (
    id INT UNSIGNED NOT NULL AUTO_INCREMENT,
    key1 INT,
    common_field VARCHAR(100),
    PRIMARY KEY (id),
    KEY idx_key1 (key1)
) Engine=InnoDB CHARSET=utf8;
</code></pre>
<p>
 &#36825;&#20010;&#34920;&#23601;&#21253;&#21547;2&#20010;&#32034;&#24341;&#65288;&#20063;&#23601;&#26159;2&#26869;B+&#26641;&#65289;&#65306;
</p>
<ul>
 <li>
  <p>
   &#20197;
   <code>
    id
   </code>
   &#21015;&#20026;&#20027;&#38190;&#23545;&#24212;&#30340;&#32858;&#31751;&#32034;&#24341;&#12290;
  </p>
 </li>
 <li>
  <p>
   &#20026;
   <code>
    key1
   </code>
   &#21015;&#24314;&#31435;&#30340;&#20108;&#32423;&#32034;&#24341;
   <code>
    idx_key1
   </code>
   &#12290;
  </p>
 </li>
</ul>
<p>
 &#25105;&#20204;&#21521;&#34920;&#20013;&#25554;&#20837;&#19968;&#20123;&#35760;&#24405;&#65306;
</p>
<pre><code>INSERT INTO t VALUES
    (1, 30, 'b'),
    (2, 80, 'b'),
    (3, 23, 'b'),
    (4, NULL, 'b'),
    (5, 11, 'b'),
    (6, 53, 'b'),
    (7, 63, 'b'),
    (8, NULL, 'b'),
    (9, 99, 'b'),
    (10, 12, 'b'),
    (11, 66, 'b'),
    (12, NULL, 'b'),
    (13, 66, 'b'),
    (14, 30, 'b'),
    (15, 11, 'b'),
    (16, 90, 'b');
</code></pre>
<p>
 &#25152;&#20197;&#29616;&#22312;
 <code>
  t
 </code>
 &#34920;&#30340;&#32858;&#31751;&#32034;&#24341;&#31034;&#24847;&#22270;&#23601;&#26159;&#36825;&#26679;&#65306;
</p>
<p>
 <img alt="" src="EPUB/44645b8c-13d6-11ed-838d-acde48001122">
</p>
<p>
 <code>
  t
 </code>
 &#34920;&#30340;&#20108;&#32423;&#32034;&#24341;&#31034;&#24847;&#22270;&#23601;&#26159;&#36825;&#26679;&#65306;
</p>
<p>
 <img alt="" src="EPUB/44718866-13d6-11ed-838d-acde48001122">
</p>
<blockquote>
 <p>
  &#23567;&#36148;&#22763;&#65306;
  <br>
  <br>
  &#21407;&#35845;&#25105;&#20204;&#30011;&#20102;&#19968;&#20010;&#26497;&#24230;&#31616;&#21270;&#29256;&#30340;B+&#26641;&#65306;&#25105;&#20204;&#30465;&#30053;&#20102;B+&#26641;&#20013;&#30340;&#39029;&#38754;&#33410;&#28857;&#65292;&#30465;&#30053;&#20102;&#27599;&#23618;&#39029;&#38754;&#33410;&#28857;&#20043;&#38388;&#30340;&#21452;&#21521;&#38142;&#34920;&#65292;&#30465;&#30053;&#20102;&#39029;&#38754;&#20013;&#35760;&#24405;&#30340;&#21333;&#21521;&#38142;&#34920;&#65292;&#30465;&#30053;&#20102;&#39029;&#38754;&#20013;&#30340;&#39029;&#30446;&#24405;&#32467;&#26500;&#65292;&#36824;&#26377;&#30465;&#30053;&#20102;&#22909;&#22810;&#19996;&#35199;&#12290;&#20294;&#26159;&#25105;&#20204;&#20445;&#30041;B+&#26641;&#26368;&#20026;&#26680;&#24515;&#30340;&#19968;&#20010;&#29305;&#28857;&#65306;&#35760;&#24405;&#26159;&#25353;&#29031;&#38190;&#20540;&#22823;&#23567;&#36827;&#34892;&#25490;&#24207;&#30340;&#12290;&#21363;&#23545;&#20110;&#32858;&#31751;&#32034;&#24341;&#26469;&#35828;&#65292;&#35760;&#24405;&#26159;&#25353;&#29031;id&#21015;&#36827;&#34892;&#25490;&#24207;&#30340;&#65307;&#23545;&#20110;&#20108;&#32423;&#32034;&#24341;idx_key1&#26469;&#35828;&#65292;&#35760;&#24405;&#26159;&#25353;&#29031;key1&#21015;&#36827;&#34892;&#25490;&#24207;&#30340;&#65292;&#22312;key1&#21015;&#30456;&#21516;&#26102;&#20877;&#25353;&#29031;id&#21015;&#36827;&#34892;&#25490;&#24207;&#12290;
 </p>
</blockquote>
<p>
 &#20174;&#19978;&#36793;&#32858;&#31751;&#32034;&#24341;&#21644;&#20108;&#32423;&#32034;&#24341;&#30340;&#32467;&#26500;&#20013;&#22823;&#23478;&#21487;&#20197;&#21457;&#29616;&#65306;
 <strong>
  &#27599;&#19968;&#26465;&#32858;&#31751;&#32034;&#24341;&#35760;&#24405;&#37117;&#21487;&#20197;&#22312;&#20108;&#32423;&#32034;&#24341;&#20013;&#25214;&#21040;&#21807;&#19968;&#30340;&#19968;&#26465;&#20108;&#32423;&#32034;&#24341;&#35760;&#24405;&#19982;&#20854;&#30456;&#23545;&#24212;&#12290;
 </strong>
</p>
<h2>
 &#21069;&#32622;&#30693;&#35782;2&#8212;&#8212;server&#23618;&#21644;&#23384;&#20648;&#24341;&#25806;&#30340;&#20132;&#20114;
</h2>
<p>
 &#20197;&#19979;&#36793;&#36825;&#20010;&#26597;&#35810;&#20026;&#20363;&#65306;
</p>
<pre><code>SELECT * FROM t WHERE key1 &gt; 70 AND common_field != 'a';
</code></pre>
<p>
 &#20551;&#35774;&#20248;&#21270;&#22120;&#35748;&#20026;&#36890;&#36807;&#25195;&#25551;&#20108;&#32423;&#32034;&#24341;idx_key1&#20013;key1&#20540;&#22312;(70, +&#8734;)&#36825;&#20010;&#21306;&#38388;&#20013;&#30340;&#20108;&#32423;&#32034;&#24341;&#35760;&#24405;&#30340;&#25104;&#26412;&#26356;&#23567;&#65292;&#37027;&#20040;&#26597;&#35810;&#23558;&#20197;&#19979;&#36848;&#26041;&#24335;&#25191;&#34892;&#65306;
</p>
<ul>
 <li>
  <p>
   server&#23618;&#20808;&#35753;InnoDB&#21435;&#26597;&#22312;key1&#20540;&#22312;(70, +&#26080;&#31351;)&#21306;&#38388;&#20013;&#30340;&#31532;&#19968;&#26465;&#35760;&#24405;&#12290;
  </p>
 </li>
 <li>
  <p>
   InnoDB&#36890;&#36807;&#20108;&#32423;&#32034;&#24341;idx_key1&#23545;&#24212;&#30340;B+&#26641;&#65292;&#20174;B+&#26641;&#26681;&#39029;&#38754;&#19968;&#23618;&#19968;&#23618;&#21521;&#19979;&#23450;&#20301;&#65292;&#24555;&#36895;&#25214;&#21040;(70, +&#26080;&#31351;)&#21306;&#38388;&#30340;&#31532;&#19968;&#26465;&#20108;&#32423;&#32034;&#24341;&#35760;&#24405;&#65292;&#28982;&#21518;&#26681;&#25454;&#35813;&#20108;&#32423;&#32034;&#24341;&#35760;&#24405;&#36827;&#34892;&#22238;&#34920;&#25805;&#20316;&#65292;&#25214;&#21040;&#23436;&#25972;&#30340;&#32858;&#31751;&#32034;&#24341;&#35760;&#24405;&#65292;&#28982;&#21518;&#36820;&#22238;&#32473;server&#23618;&#12290;
  </p>
 </li>
 <li>
  <p>
   server&#23618;&#21028;&#26029;InnoDB&#36820;&#22238;&#30340;&#35760;&#24405;&#31526;&#19981;&#31526;&#21512;&#25628;&#32034;&#26465;&#20214;
   <code>
    key1 &gt; 70 AND common_field != 'a'
   </code>
   &#65292;&#22914;&#26524;&#19981;&#31526;&#21512;&#30340;&#35805;&#23601;&#36339;&#36807;&#35813;&#35760;&#24405;&#65292;&#21542;&#21017;&#23558;&#20854;&#21457;&#36865;&#21040;&#23458;&#25143;&#31471;&#12290;
  </p>
 </li>
</ul>
<blockquote>
 <p>
  &#23567;&#36148;&#22763;&#65306;
  <br>
  <br>
  &#27492;&#22788;&#23558;&#35760;&#24405;&#21457;&#36865;&#32473;&#23458;&#25143;&#31471;&#20854;&#23454;&#26159;&#21457;&#36865;&#21040;&#26412;&#22320;&#30340;&#32593;&#32476;&#32531;&#20914;&#21306;&#65292;&#32531;&#20914;&#21306;&#22823;&#23567;&#30001;net_buffer_length&#25511;&#21046;&#65292;&#40664;&#35748;&#26159;16KB&#22823;&#23567;&#12290;&#31561;&#32531;&#20914;&#21306;&#28385;&#20102;&#25165;&#30495;&#27491;&#21457;&#36865;&#32593;&#32476;&#21253;&#21040;&#23458;&#25143;&#31471;&#12290;
 </p>
</blockquote>
<ul>
 <li>
  <p>
   &#28982;&#21518;server&#23618;&#21521;InnoDB&#35201;&#19979;&#19968;&#26465;&#35760;&#24405;&#12290;
  </p>
 </li>
 <li>
  <p>
   InnoDB&#26681;&#25454;&#19978;&#19968;&#27425;&#25214;&#21040;&#30340;&#20108;&#32423;&#32034;&#24341;&#35760;&#24405;&#30340;next_record&#23646;&#24615;&#65292;&#33719;&#21462;&#21040;&#19979;&#19968;&#26465;&#20108;&#32423;&#32034;&#24341;&#35760;&#24405;&#65292;&#22238;&#34920;&#21518;&#23558;&#23436;&#25972;&#30340;&#32858;&#31751;&#32034;&#24341;&#35760;&#24405;&#36820;&#22238;&#32473;server&#23618;&#12290;
  </p>
 </li>
 <li>
  <p>
   server&#32487;&#32493;&#21028;&#26029;&#65292;&#19981;&#31526;&#21512;&#25628;&#32034;&#26465;&#20214;&#21363;&#36339;&#36807;&#35813;&#35760;&#24405;&#65292;&#21542;&#21017;&#21457;&#36865;&#21040;&#23458;&#25143;&#31471;&#12290;
  </p>
 </li>
 <li>
  <p>
   ... &#19968;&#30452;&#24490;&#29615;&#19978;&#36848;&#36807;&#31243;&#65292;&#30452;&#21040;InnoDB&#25214;&#19981;&#21040;&#19979;&#19968;&#26465;&#35760;&#24405;&#65292;&#21017;&#21521;server&#23618;&#25253;&#21578;&#26597;&#35810;&#23436;&#27605;&#12290;
  </p>
 </li>
 <li>
  <p>
   server&#23618;&#25910;&#21040;InnoDB&#25253;&#21578;&#30340;&#26597;&#35810;&#23436;&#27605;&#35831;&#27714;&#65292;&#20572;&#27490;&#26597;&#35810;&#12290;
  </p>
 </li>
</ul>
<p>
 &#21487;&#35265;&#65292;&#19968;&#33324;&#24773;&#20917;&#19979;server&#23618;&#21644;&#23384;&#20648;&#24341;&#25806;&#23618;&#26159;&#20197;&#35760;&#24405;&#20026;&#21333;&#20301;&#36827;&#34892;&#20132;&#20114;&#30340;&#12290;
</p>
<p>
 &#25105;&#20204;&#30475;&#19968;&#19979;&#28304;&#30721;&#20013;&#35835;&#21462;&#19968;&#26465;&#35760;&#24405;&#30340;&#20989;&#25968;&#35843;&#29992;&#26632;&#65306;
</p>
<p>
 <img alt="" src="EPUB/447b4428-13d6-11ed-838d-acde48001122">
</p>
<p>
 &#20854;&#20013;&#30340;
 <code>
  handler::ha_index_next
 </code>
 &#20415;&#26159;server&#23618;&#21521;&#23384;&#20648;&#24341;&#25806;&#35201;&#19979;&#19968;&#26465;&#35760;&#24405;&#30340;&#25509;&#21475;&#12290;
</p>
<p>
 &#20854;&#20013;&#30340;
 <code>
  row_search_mvcc
 </code>
 &#26159;&#35835;&#21462;&#19968;&#26465;&#35760;&#24405;&#26368;&#37325;&#35201;&#30340;&#20989;&#25968;&#65292;&#36825;&#20010;&#20989;&#25968;&#38271;&#30340;&#21523;&#20154;&#65292;&#26377;&#19968;&#21315;&#22810;&#34892;&#65306;
</p>
<p>
 <img alt="" src="EPUB/44863ea0-13d6-11ed-838d-acde48001122">
</p>
<p>
 &#27599;&#35835;&#21462;&#19968;&#26465;&#35760;&#24405;&#65292;&#37117;&#35201;&#20570;&#38750;&#24120;&#22810;&#30340;&#24037;&#20316;&#65292;
 <strong>
  &#35832;&#22914;&#36827;&#34892;&#22810;&#29256;&#26412;&#30340;&#21487;&#35265;&#24615;&#21028;&#26029;&#65292;&#35201;&#19981;&#35201;&#23545;&#35760;&#24405;&#36827;&#34892;&#21152;&#38145;&#30340;&#21028;&#26029;&#65292;&#35201;&#26159;&#21152;&#38145;&#30340;&#35805;&#21152;&#20160;&#20040;&#38145;&#30340;&#36873;&#25321;&#65292;&#23436;&#25104;&#35760;&#24405;&#20174;InnoDB&#30340;&#23384;&#20648;&#26684;&#24335;&#21040;server&#23618;&#23384;&#20648;&#26684;&#24335;&#30340;&#36716;&#25442;
 </strong>
 &#31561;&#31561;&#31561;&#31561;&#21313;&#20998;&#32321;&#26434;&#30340;&#24037;&#20316;&#12290;
</p>
<blockquote>
 <p>
  &#23567;&#36148;&#22763;&#65306;
  <br>
  <br>
  &#19981;&#30693;&#36947;&#20320;&#20204;&#20844;&#21496;&#26377;&#27809;&#26377;&#20889;&#36825;&#20040;&#38271;&#20989;&#25968;&#30340;&#21516;&#23398;&#65292;&#22914;&#26524;&#26377;&#30340;&#35805;&#20320;&#24819;&#19981;&#24819;&#25171;&#20182;&#12290;
 </p>
</blockquote>
<h2>
 &#21069;&#32622;&#30693;&#35782;3&#8212;&#8212;COUNT&#26159;&#20010;&#21861;
</h2>
<p>
 COUNT&#26159;&#19968;&#20010;&#27719;&#24635;&#20989;&#25968;&#65288;&#32858;&#38598;&#20989;&#25968;&#65289;&#65292;&#23427;&#25509;&#25910;1&#20010;&#34920;&#36798;&#24335;&#20316;&#20026;&#21442;&#25968;&#65306;
</p>
<pre><code>COUNT(expr)
</code></pre>
<p>
 COUNT&#20989;&#25968;&#29992;&#20110;&#32479;&#35745;&#22312;&#31526;&#21512;&#25628;&#32034;&#26465;&#20214;&#30340;&#35760;&#24405;&#20013;&#65292;&#25351;&#23450;&#30340;&#34920;&#36798;&#24335;
 <code>
  expr
 </code>
 &#19981;&#20026;NULL&#30340;&#34892;&#25968;&#26377;&#22810;&#23569;&#12290;&#36825;&#37324;&#38656;&#35201;&#29305;&#21035;&#27880;&#24847;&#30340;&#26159;&#65292;
 <code>
  expr
 </code>
 &#19981;&#20165;&#20165;&#21487;&#20197;&#26159;&#21015;&#21517;&#65292;&#20854;&#20182;&#20219;&#24847;&#34920;&#36798;&#24335;&#37117;&#26159;&#21487;&#20197;&#30340;&#12290;
</p>
<p>
 &#27604;&#26041;&#35828;&#65306;
</p>
<pre><code>SELECT COUNT(key1) FROM t;
</code></pre>
<p>
 &#36825;&#20010;&#35821;&#21477;&#26159;&#29992;&#20110;&#32479;&#35745;&#22312;single_table&#34920;&#30340;&#25152;&#26377;&#35760;&#24405;&#20013;&#65292;key1&#21015;&#19981;&#20026;NULL&#30340;&#34892;&#25968;&#26159;&#22810;&#23569;&#12290;
</p>
<p>
 &#20877;&#30475;&#36825;&#20010;&#65306;
</p>
<pre><code>SELECT COUNT('abc') FROM t;
</code></pre>
<p>
 &#36825;&#20010;&#35821;&#21477;&#26159;&#29992;&#20110;&#32479;&#35745;&#22312;single_table&#34920;&#30340;&#25152;&#26377;&#35760;&#24405;&#20013;&#65292;'abc'&#36825;&#20010;&#34920;&#36798;&#24335;&#19981;&#20026;NULL&#30340;&#34892;&#25968;&#26159;&#22810;&#23569;&#12290;&#24456;&#26174;&#28982;&#65292;'abc'&#36825;&#20010;&#34920;&#36798;&#24335;&#27704;&#36828;&#19981;&#26159;NULL&#65292;&#25152;&#20197;&#19978;&#36848;&#35821;&#21477;&#20854;&#23454;&#23601;&#26159;&#32479;&#35745;single_table&#34920;&#37324;&#26377;&#22810;&#23569;&#26465;&#35760;&#24405;&#12290;
</p>
<p>
 &#20877;&#30475;&#36825;&#20010;&#65306;
</p>
<pre><code>SELECT COUNT(*) FROM t;
</code></pre>
<p>
 &#36825;&#20010;&#35821;&#21477;&#23601;&#26159;&#30452;&#25509;&#32479;&#35745;single_table&#34920;&#26377;&#22810;&#23569;&#26465;&#35760;&#24405;&#12290;
</p>
<p>
 &#24635;&#32467;+&#27880;&#24847;&#65306;
 <strong>
  COUNT&#20989;&#25968;&#30340;&#21442;&#25968;&#21487;&#20197;&#26159;&#20219;&#24847;&#34920;&#36798;&#24335;&#65292;&#35813;&#20989;&#25968;&#29992;&#20110;&#32479;&#35745;&#22312;&#31526;&#21512;&#25628;&#32034;&#26465;&#20214;&#30340;&#35760;&#24405;&#20013;&#65292;&#25351;&#23450;&#30340;&#34920;&#36798;&#24335;&#19981;&#20026;NULL&#30340;&#34892;&#25968;&#26377;&#22810;&#23569;
 </strong>
 &#12290;
</p>
<h2>
 MySQL&#20013;COUNT&#26159;&#24590;&#26679;&#25191;&#34892;&#30340;
</h2>
<p>
 &#20570;&#20102;&#37027;&#20040;&#22810;&#38138;&#22443;&#65292;&#32456;&#20110;&#21040;&#20102;MySQL&#20013;COUNT&#26159;&#24590;&#26679;&#25191;&#34892;&#30340;&#20102;&#12290;
</p>
<p>
 &#20197;&#19979;&#36793;&#36825;&#20010;&#35821;&#21477;&#20026;&#20363;&#65306;
</p>
<pre><code>SELECT COUNT(*) FROM t;
</code></pre>
<p>
 &#36825;&#20010;&#35821;&#21477;&#26159;&#35201;&#21435;&#26597;&#35810;&#34920;t&#20013;&#20849;&#21253;&#21547;&#22810;&#23569;&#26465;&#35760;&#24405;&#12290;&#30001;&#20110;&#32858;&#31751;&#32034;&#24341;&#21644;&#20108;&#32423;&#32034;&#24341;&#20013;&#30340;&#35760;&#24405;&#26159;&#19968;&#19968;&#23545;&#24212;&#30340;&#65292;&#32780;&#20108;&#32423;&#32034;&#24341;&#35760;&#24405;&#20013;&#21253;&#21547;&#30340;&#21015;&#26159;&#23569;&#20110;&#32858;&#31751;&#32034;&#24341;&#35760;&#24405;&#30340;&#65292;&#25152;&#20197;&#21516;&#26679;&#25968;&#37327;&#30340;&#20108;&#32423;&#32034;&#24341;&#35760;&#24405;&#21487;&#20197;&#27604;&#32858;&#31751;&#32034;&#24341;&#35760;&#24405;&#21344;&#29992;&#26356;&#23569;&#30340;&#23384;&#20648;&#31354;&#38388;&#12290;&#22914;&#26524;&#25105;&#20204;&#20351;&#29992;&#20108;&#32423;&#32034;&#24341;&#25191;&#34892;&#19978;&#36848;&#26597;&#35810;&#65292;&#21363;&#25968;&#19968;&#19979;idx_key1&#20013;&#20849;&#26377;&#22810;&#23569;&#26465;&#20108;&#32423;&#32034;&#24341;&#35760;&#24405;&#65292;&#26159;&#27604;&#30452;&#25509;&#25968;&#32858;&#31751;&#32034;&#24341;&#20013;&#20849;&#26377;&#22810;&#23569;&#32858;&#31751;&#32034;&#24341;&#35760;&#24405;&#21487;&#20197;&#33410;&#30465;&#24456;&#22810;I/O&#25104;&#26412;&#12290;&#25152;&#20197;&#20248;&#21270;&#22120;&#20250;&#20915;&#23450;&#20351;&#29992;idx_key1&#25191;&#34892;&#19978;&#36848;&#26597;&#35810;&#65306;
</p>
<pre><code>mysql&gt; EXPLAIN SELECT COUNT(*) FROM t;
+----+-------------+-------+------------+-------+---------------+----------+---------+------+------+----------+-------------+
| id | select_type | table | partitions | type  | possible_keys | key      | key_len | ref  | rows | filtered | Extra       |
+----+-------------+-------+------------+-------+---------------+----------+---------+------+------+----------+-------------+
|  1 | SIMPLE      | t     | NULL       | index | NULL          | idx_key1 | 5       | NULL |   16 |   100.00 | Using index |
+----+-------------+-------+------------+-------+---------------+----------+---------+------+------+----------+-------------+
1 row in set, 1 warning (0.02 sec)
</code></pre>
<p>
 &#22312;&#25191;&#34892;&#19978;&#36848;&#26597;&#35810;&#26102;&#65292;server&#23618;&#20250;&#32500;&#25252;&#19968;&#20010;&#21517;&#21483;count&#30340;&#21464;&#37327;&#65292;&#28982;&#21518;&#65306;
</p>
<ul>
 <li>
  <p>
   server&#23618;&#21521;InnoDB&#35201;&#31532;&#19968;&#26465;&#35760;&#24405;&#12290;
  </p>
 </li>
 <li>
  <p>
   InnoDB&#25214;&#21040;idx_key1&#30340;&#31532;&#19968;&#26465;&#20108;&#32423;&#32034;&#24341;&#35760;&#24405;&#65292;&#24182;&#36820;&#22238;&#32473;server&#23618;&#65288;
   <strong>
    &#27880;&#24847;&#65306;&#30001;&#20110;&#27492;&#26102;&#21482;&#26159;&#32479;&#35745;&#35760;&#24405;&#25968;&#37327;&#65292;&#25152;&#20197;&#24182;&#19981;&#38656;&#35201;&#22238;&#34920;
   </strong>
   &#65289;&#12290;
  </p>
 </li>
 <li>
  <p>
   &#30001;&#20110;COUNT&#20989;&#25968;&#30340;&#21442;&#25968;&#26159;
   <code>
    *
   </code>
   &#65292;MySQL&#20250;&#23558;
   <code>
    *
   </code>
   &#24403;&#20316;&#24120;&#25968;0&#22788;&#29702;&#12290;&#30001;&#20110;0&#24182;&#19981;&#26159;NULL&#65292;server&#23618;&#32473;count&#21464;&#37327;&#21152;1&#12290;
  </p>
 </li>
 <li>
  <p>
   server&#23618;&#21521;InnoDB&#35201;&#19979;&#19968;&#26465;&#35760;&#24405;&#12290;
  </p>
 </li>
 <li>
  <p>
   InnoDB&#36890;&#36807;&#20108;&#32423;&#32034;&#24341;&#35760;&#24405;&#30340;next_record&#23646;&#24615;&#25214;&#21040;&#19979;&#19968;&#26465;&#20108;&#32423;&#32034;&#24341;&#35760;&#24405;&#65292;&#24182;&#36820;&#22238;&#32473;server&#23618;&#12290;
  </p>
 </li>
 <li>
  <p>
   server&#23618;&#32487;&#32493;&#32473;count&#21464;&#37327;&#21152;1&#12290;
  </p>
 </li>
 <li>
  <p>
   ... &#37325;&#22797;&#19978;&#36848;&#36807;&#31243;&#65292;&#30452;&#21040;InnoDB&#21521;server&#23618;&#36820;&#22238;&#27809;&#35760;&#24405;&#21487;&#26597;&#30340;&#28040;&#24687;&#12290;
  </p>
 </li>
 <li>
  <p>
   server&#23618;&#23558;&#26368;&#32456;&#30340;count&#21464;&#37327;&#30340;&#20540;&#21457;&#36865;&#21040;&#23458;&#25143;&#31471;&#12290;
  </p>
 </li>
</ul>
<p>
 &#25105;&#20204;&#30475;&#19968;&#19979;&#28304;&#30721;&#37324;&#32473;count&#21464;&#37327;&#21152;1&#30340;&#20195;&#30721;&#26159;&#24590;&#20040;&#20889;&#30340;&#65306;
</p>
<p>
 <img alt="" src="EPUB/4497fe7e-13d6-11ed-838d-acde48001122">
</p>
<p>
 &#20854;&#22823;&#24847;&#23601;&#26159;&#21028;&#26029;&#19968;&#19979;COUNT&#37324;&#30340;&#34920;&#36798;&#24335;&#26159;&#19981;&#26159;NULL&#65292;&#22914;&#26524;&#19981;&#26159;NULL&#30340;&#35805;&#23601;&#32473;count&#21464;&#37327;&#21152;1&#12290;
</p>
<p>
 &#25105;&#20204;&#20877;&#26469;&#30475;&#19968;&#19979;arg_is_null&#30340;&#23454;&#29616;&#65306;
</p>
<p>
 <img alt="" src="EPUB/44a1abd6-13d6-11ed-838d-acde48001122">
</p>
<p>
 &#20854;&#20013;&#26368;&#37325;&#35201;&#30340;&#26159;&#25105;&#20204;&#26631;&#34013;&#30340;&#37027;&#19968;&#34892;&#65292;item[i]&#34920;&#31034;&#30340;&#23601;&#26159;COUNT&#20989;&#25968;&#20013;&#30340;&#21442;&#25968;&#65292;&#25105;&#20204;&#35843;&#35797;&#19968;&#19979;&#23545;&#20110;
 <code>
  COUNT(*)
 </code>
 &#26469;&#35828;&#65292;&#34920;&#36798;&#24335;
 <code>
  *
 </code>
 &#30340;&#20540;&#26159;&#20160;&#20040;&#65306;
</p>
<p>
 <img alt="" src="EPUB/44abadca-13d6-11ed-838d-acde48001122">
</p>
<p>
 &#21487;&#20197;&#30475;&#21040;&#65292;
 <code>
  *
 </code>
 &#34920;&#36798;&#24335;&#30340;&#31867;&#22411;&#20854;&#23454;&#26159;
 <code>
  Item_int
 </code>
 &#65292;&#36825;&#34920;&#31034;MySQL&#20854;&#23454;&#20250;&#25226;
 <code>
  *
 </code>
 &#24403;&#20316;&#19968;&#20010;&#25972;&#25968;&#22788;&#29702;&#65292;&#23427;&#30340;&#20540;&#26159;0&#65288;&#35265;&#22270;&#20013;&#31661;&#22836;&#65289;&#12290;&#20063;&#23601;&#26159;&#35828;&#25105;&#20204;&#22312;&#21028;&#26029;&#34920;&#36798;&#24335;
 <code>
  *
 </code>
 &#26159;&#19981;&#26159;&#20026;NULL&#65292;&#20063;&#23601;&#26159;&#22312;&#21028;&#26029;&#25972;&#25968;
 <code>
  0
 </code>
 &#26159;&#19981;&#26159;&#20026;NULL&#65292;&#24456;&#26174;&#28982;&#19981;&#20026;NULL&#12290;
</p>
<h2>
 &#37027;COUNT(1)&#65292;COUNT(id)&#65292;COUNT(&#38750;&#20027;&#38190;&#21015;)&#21602;&#65311;
</h2>
<p>
 &#37027;&#22312;&#25191;&#34892;COUNT(1)&#21602;&#65311;&#27604;&#26041;&#35828;&#19979;&#36793;&#36825;&#20010;&#35821;&#21477;&#65306;
</p>
<pre><code>SELECT COUNT(1) FROM t;
</code></pre>
<p>
 &#25105;&#20204;&#30475;&#19968;&#19979;&#65306;
</p>
<p>
 <img alt="" src="EPUB/44b3578c-13d6-11ed-838d-acde48001122">
</p>
<p>
 &#21487;&#20197;&#30475;&#21040;&#65292;&#24120;&#25968;
 <code>
  1
 </code>
 &#23545;&#24212;&#30340;&#31867;&#22411;&#20854;&#23454;&#26159;
 <code>
  PTI_num_literal_num
 </code>
 &#65292;&#23427;&#20854;&#23454;&#26159;
 <code>
  Item_int
 </code>
 &#30340;&#19968;&#20010;&#21253;&#35013;&#31867;&#22411;&#65292;&#26412;&#36136;&#19978;&#36824;&#26159;&#20195;&#34920;&#19968;&#20010;&#25972;&#25968;&#65292;&#23427;&#30340;&#20540;&#26159;
 <code>
  1
 </code>
 &#65288;&#35265;&#22270;&#20013;&#31661;&#22836;&#65289;&#12290;&#20063;&#23601;&#26159;&#35828;&#25105;&#20204;&#20854;&#23454;&#26159;&#22312;&#21028;&#26029;&#34920;&#36798;&#24335;
 <code>
  1
 </code>
 &#26159;&#19981;&#26159;&#20026;NULL&#65292;&#24456;&#26174;&#28982;&#19981;&#20026;NULL&#12290;
</p>
<p>
 &#20877;&#30475;&#19968;&#19979;COUNT(id)&#65306;
</p>
<pre><code>SELECT COUNT(id) FROM t;
</code></pre>
<p>
 &#25105;&#20204;&#30475;&#19968;&#19979;&#65306;
</p>
<p>
 <img alt="" src="EPUB/44bb35ba-13d6-11ed-838d-acde48001122">
</p>
<p>
 &#21487;&#20197;&#30475;&#21040;&#65292;
 <code>
  id
 </code>
 &#23545;&#24212;&#30340;&#31867;&#22411;&#26159;
 <code>
  Item_field
 </code>
 &#65292;&#20195;&#34920;&#19968;&#20010;&#23383;&#27573;&#12290;
</p>
<p>
 &#23545;&#20110;
 <code>
  COUNT(*)
 </code>
 &#12289;
 <code>
  COUNT(1)
 </code>
 &#25110;&#32773;&#20219;&#24847;&#30340;
 <code>
  COUNT(&#24120;&#25968;)
 </code>
 &#26469;&#35828;&#65292;&#35835;&#21462;&#21738;&#20010;&#32034;&#24341;&#30340;&#35760;&#24405;&#20854;&#23454;&#24182;&#19981;&#37325;&#35201;&#65292;&#22240;&#20026;server&#23618;&#21482;&#20851;&#24515;&#23384;&#20648;&#24341;&#25806;&#26159;&#21542;&#35835;&#21040;&#20102;&#35760;&#24405;&#65292;&#32780;&#24182;&#19981;&#38656;&#35201;&#20174;&#35760;&#24405;&#20013;&#25552;&#21462;&#25351;&#23450;&#30340;&#23383;&#27573;&#26469;&#21028;&#26029;&#26159;&#21542;&#20026;NULL&#12290;&#25152;&#20197;&#20248;&#21270;&#22120;&#20250;&#20351;&#29992;&#21344;&#29992;&#23384;&#20648;&#31354;&#38388;&#26368;&#23567;&#30340;&#37027;&#20010;&#32034;&#24341;&#26469;&#25191;&#34892;&#26597;&#35810;&#12290;
</p>
<p>
 &#23545;&#20110;
 <code>
  COUNT(id)
 </code>
 &#26469;&#35828;&#65292;&#30001;&#20110;id&#26159;&#20027;&#38190;&#65292;&#19981;&#35770;&#26159;&#32858;&#31751;&#32034;&#24341;&#35760;&#24405;&#65292;&#36824;&#26159;&#20219;&#24847;&#19968;&#20010;&#20108;&#32423;&#32034;&#24341;&#35760;&#24405;&#20013;&#37117;&#20250;&#21253;&#21547;&#20027;&#38190;&#23383;&#27573;&#65292;&#25152;&#20197;&#20854;&#23454;&#35835;&#21462;&#20219;&#24847;&#19968;&#20010;&#32034;&#24341;&#20013;&#30340;&#35760;&#24405;&#37117;&#21487;&#20197;&#33719;&#21462;&#21040;id&#23383;&#27573;&#65292;&#27492;&#26102;&#20248;&#21270;&#22120;&#20063;&#20250;&#36873;&#25321;&#21344;&#29992;&#23384;&#20648;&#31354;&#38388;&#26368;&#23567;&#30340;&#37027;&#20010;&#32034;&#24341;&#26469;&#25191;&#34892;&#26597;&#35810;&#12290;
</p>
<p>
 &#32780;&#23545;&#20110;
 <code>
  COUNT(&#38750;&#20027;&#38190;&#21015;)
 </code>
 &#26469;&#35828;&#65292;&#25105;&#20204;&#25351;&#23450;&#30340;&#21015;&#21487;&#33021;&#24182;&#19981;&#20250;&#21253;&#21547;&#22312;&#27599;&#19968;&#20010;&#32034;&#24341;&#20013;&#12290;&#36825;&#26679;&#20248;&#21270;&#22120;&#21482;&#33021;&#36873;&#25321;&#21253;&#21547;&#25105;&#20204;&#25351;&#23450;&#30340;&#21015;&#30340;&#32034;&#24341;&#21435;&#25191;&#34892;&#26597;&#35810;&#65292;&#36825;&#23601;
 <strong>
  &#21487;&#33021;
 </strong>
 &#23548;&#33268;&#20248;&#21270;&#22120;&#36873;&#25321;&#30340;&#32034;&#24341;&#24182;&#19981;&#26159;&#26368;&#23567;&#30340;&#37027;&#20010;&#12290;
</p>
<h2>
 &#24635;&#32467;&#19968;&#19979;
</h2>
<p>
 &#23545;&#20110;
 <code>
  COUNT(*)
 </code>
 &#12289;
 <code>
  COUNT(&#24120;&#25968;)
 </code>
 &#12289;
 <code>
  COUNT(&#20027;&#38190;)
 </code>
 &#24418;&#24335;&#30340;COUNT&#20989;&#25968;&#26469;&#35828;&#65292;&#20248;&#21270;&#22120;&#21487;&#20197;&#36873;&#25321;&#26368;&#23567;&#30340;&#32034;&#24341;&#25191;&#34892;&#26597;&#35810;&#65292;&#20174;&#32780;&#25552;&#21319;&#25928;&#29575;&#65292;&#23427;&#20204;&#30340;&#25191;&#34892;&#36807;&#31243;&#26159;&#19968;&#26679;&#30340;&#65292;&#21482;&#19981;&#36807;&#22312;&#21028;&#26029;&#34920;&#36798;&#24335;&#26159;&#21542;&#20026;NULL&#26102;&#36873;&#25321;&#19981;&#21516;&#30340;&#21028;&#26029;&#26041;&#24335;&#65292;&#36825;&#20010;&#21028;&#26029;&#20026;NULL&#30340;&#36807;&#31243;&#30340;&#20195;&#20215;&#21487;&#20197;&#24573;&#30053;&#19981;&#35745;&#65292;&#25152;&#20197;&#25105;&#20204;&#21487;&#20197;&#35748;&#20026;
 <code>
  COUNT(*)
 </code>
 &#12289;
 <code>
  COUNT(&#24120;&#25968;)
 </code>
 &#12289;
 <code>
  COUNT(&#20027;&#38190;)
 </code>
 &#25152;&#38656;&#35201;&#30340;&#20195;&#20215;&#26159;&#30456;&#21516;&#30340;&#12290;
</p>
<p>
 &#32780;&#23545;&#20110;
 <code>
  COUNT(&#38750;&#20027;&#38190;&#21015;)
 </code>
 &#26469;&#35828;&#65292;server&#23618;&#24517;&#39035;&#35201;&#20174;InnoDB&#20013;&#35835;&#21040;&#21253;&#21547;
 <code>
  &#38750;&#20027;&#38190;&#21015;
 </code>
 &#30340;&#35760;&#24405;&#65292;&#25152;&#20197;&#20248;&#21270;&#22120;&#24182;&#19981;&#33021;&#38543;&#24515;&#25152;&#27442;&#30340;&#36873;&#25321;&#26368;&#23567;&#30340;&#32034;&#24341;&#21435;&#25191;&#34892;&#12290;
</p>
<h2>
 &#25105;&#24819;&#25913;&#36827;&#19968;&#19979;&#65311;
</h2>
<p>
 &#25105;&#20204;&#30693;&#36947;&#65292;InnoDB&#30340;&#35760;&#24405;&#37117;&#26159;&#23384;&#20648;&#22312;&#25968;&#25454;&#39029;&#20013;&#30340;&#65288;&#39029;&#38754;&#22823;&#23567;&#40664;&#35748;&#20026;16KB&#65289;&#65292;&#32780;&#27599;&#20010;&#25968;&#25454;&#39029;&#30340;
 <code>
  Page Header
 </code>
 &#37096;&#20998;&#37117;&#26377;&#19968;&#20010;&#32479;&#35745;&#24403;&#21069;&#39029;&#38754;&#20013;&#35760;&#24405;&#25968;&#37327;&#30340;&#23646;&#24615;
 <code>
  PAGE_N_RECS
 </code>
 &#12290;&#37027;&#26377;&#30340;&#21516;&#23398;&#35828;&#20102;&#65306;&#22312;&#25191;&#34892;COUNT&#20989;&#25968;&#30340;&#26102;&#20505;&#30452;&#25509;&#21435;&#25226;&#21508;&#20010;&#39029;&#38754;&#30340;&#36825;&#20010;
 <code>
  PAGE_N_RECS
 </code>
 &#23646;&#24615;&#21152;&#36215;&#26469;&#19981;&#23601;&#22909;&#20102;&#20040;&#65311;
</p>
<p>
 &#31572;&#26696;&#26159;&#65306;&#34892;&#19981;&#36890;&#30340;&#65281;
 <strong>
  &#23545;&#20110;&#26222;&#36890;&#30340;SELECT&#35821;&#21477;&#26469;&#35828;&#65292;&#27599;&#27425;&#26597;&#35810;&#37117;&#35201;&#20174;&#35760;&#24405;&#30340;&#29256;&#26412;&#38142;&#19978;&#25214;&#21040;&#21487;&#35265;&#30340;&#29256;&#26412;&#25165;&#31639;&#26159;&#35835;&#21040;&#20102;&#35760;&#24405;&#65307;&#23545;&#20110;&#21152;&#20102;FOR UPDATE&#25110;LOCK IN SHARE MODE&#21518;&#32512;&#30340;SELECT&#35821;&#21477;&#26469;&#35828;&#65292;&#27599;&#27425;&#26597;&#35810;&#37117;&#35201;&#32473;&#35760;&#24405;&#28155;&#21152;&#21512;&#36866;&#30340;&#38145;
 </strong>
 &#12290;&#25152;&#20197;&#36825;&#20010;&#35835;&#21462;&#27599;&#19968;&#26465;&#35760;&#24405;&#30340;&#36807;&#31243;&#65288;&#23601;&#26159;&#19978;&#36793;&#32473;&#20986;&#30340;row_search_mvcc&#20989;&#25968;&#65289;&#22312;InnoDB&#30340;&#30446;&#21069;&#23454;&#29616;&#20013;&#26159;&#26080;&#27861;&#36339;&#36807;&#30340;&#65292;InnoDB&#36824;&#26159;&#24471;&#32769;&#32769;&#23454;&#23454;&#30340;&#35835;&#19968;&#26465;&#35760;&#24405;&#65292;&#36820;&#32473;server&#23618;&#19968;&#26465;&#35760;&#24405;&#12290;
</p>
<p>
 &#37027;&#22914;&#26524;&#25105;&#30340;&#19994;&#21153;&#20013;&#26377;COUNT&#38656;&#27714;&#65292;&#20294;&#26159;&#30001;&#20110;&#25968;&#25454;&#37327;&#22826;&#22823;&#23548;&#33268;&#21363;&#20351;&#20248;&#21270;&#22120;&#21363;&#20351;&#36890;&#36807;&#25195;&#25551;&#20108;&#32423;&#32034;&#24341;&#35760;&#24405;&#30340;&#26041;&#24335;&#20063;&#36824;&#26159;&#22826;&#24930;&#24590;&#20040;&#21150;&#65311;&#26082;&#28982;&#19994;&#21153;&#19978;&#26377;&#38656;&#27714;&#65292;&#24403;&#28982;&#36824;&#26159;&#19994;&#21153;&#31532;&#19968;&#21949;&#65292;&#25105;&#20204;&#21487;&#20197;&#22312;&#21478;&#19968;&#20010;&#22320;&#26041;&#23384;&#20648;&#19968;&#20221;&#24453;&#32479;&#35745;&#25968;&#25454;&#30340;&#34892;&#25968;&#65292;&#27599;&#27425;&#22686;&#21024;&#25913;&#35760;&#24405;&#37117;&#32500;&#25252;&#19968;&#19979;&#12290;
</p>
<p>
 &#36825;&#26679;&#30340;&#35299;&#20915;&#26041;&#26696;&#26174;&#33879;&#22686;&#21152;&#20102;&#24320;&#21457;&#23567;&#20249;&#20276;&#30340;&#24037;&#20316;&#37327;&#65292;&#37096;&#20998;&#24320;&#21457;&#23567;&#20249;&#20276;&#32943;&#23450;&#19981;&#22826;&#20048;&#24847;&#65292;&#37027;&#23601;&#21435;&#24636;&#20320;&#30340;&#20135;&#21697;&#32463;&#29702;&#21543;&#65306;&#36825;&#20040;&#22823;&#25968;&#25454;&#37327;&#35201;TM&#20160;&#20040;&#31934;&#30830;&#20540;&#65292;&#20320;&#26469;&#21578;&#35785;&#25105;&#36825;&#20040;&#22823;&#25968;&#25454;&#37327;&#35201;TM&#20160;&#20040;&#30340;TM&#30340;&#31934;&#30830;&#20540;&#65311;
</p>
</div>

</div>
</div>
